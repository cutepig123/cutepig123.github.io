<div class="postTitle"><a id="viewpost1_TitleUrl" class="postTitle2" href="http://www.cppblog.com/cxiaojia/archive/2011/09/20/kmp.html">KMP算法中关于next数组的探究</a></div>
<p style="margin: 5px auto; padding: 0px; text-indent: 0px; font-size: 14px; line-height: 21px;"><span style="margin: 0px; padding: 0px; font-family: 宋体;">从《严书》上看到了</span><span style="margin: 0px; padding: 0px;">KMP</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">算法，看了一遍没懂，但觉得挺神奇的，就花费了几天时间深入的理解。</span></p>
<p style="margin: 5px auto; padding: 0px; text-indent: 0px; font-size: 14px; line-height: 21px;"><span style="margin: 0px; padding: 0px; font-family: 宋体;">算法的原理其实不难，难的就是那个巧妙的</span><span style="margin: 0px; padding: 0px;">next</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">数组，这个</span><span style="margin: 0px; padding: 0px;">next</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">数组很吸引我，我的大部分时间也都是花费在这个数组上面的。这个</span><span style="margin: 0px; padding: 0px;">next</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">数组是</span><span style="margin: 0px; padding: 0px;">KMP</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">里面一个很关键的地方，对于在数据结构书上看过一遍整个算法流程的人，能够把</span><span style="margin: 0px; padding: 0px;">next</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">数组搞明白，整个</span><span style="margin: 0px; padding: 0px;">KMP</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">算法的整体思想就差不多理解了。然后在一些细节上面深入思考一下，就可以理解和领会改进的</span><span style="margin: 0px; padding: 0px;">KMP</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">算法。</span></p>
<p style="margin: 5px auto; padding: 0px; text-indent: 0px; font-size: 14px; line-height: 21px;">&nbsp;</p>
<p style="margin: 5px auto; padding: 0px; text-indent: 0px; font-size: 14px; line-height: 21px;"><strong style="margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px; font-size: 14pt; font-family: 宋体;">一、</span></strong><strong style="margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px; font-size: 14pt;">KMP</span></strong><strong style="margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px; font-size: 14pt; font-family: 宋体;">算法简单介绍</span></strong><strong style="margin: 0px; padding: 0px;"></strong></p>
<p style="margin: 5px auto; padding: 0px; text-indent: 0px; font-size: 14px; line-height: 21px;"><span style="margin: 0px; padding: 0px;">KMP</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">算法是字符串匹配算法的一种，相对于朴素的字符串匹配算法而言，可以大大避免重复遍历的情况。此算法可以在</span><span style="margin: 0px; padding: 0px;">O</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">（</span><span style="margin: 0px; padding: 0px;">n+m</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">）的时间数量级上完成字符串匹配操作。</span></p>
<p style="margin: 5px auto; padding: 0px; text-indent: 0px; font-size: 14px; line-height: 21px;"><strong style="margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px; font-size: 16pt; font-family: 宋体;">二、神奇的</span></strong><strong style="margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px; font-size: 16pt;">next</span></strong><strong style="margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px; font-size: 16pt; font-family: 宋体;">数组</span></strong><strong style="margin: 0px; padding: 0px;"></strong></p>
<p style="margin: 5px auto; padding: 0px; text-indent: 0px; font-size: 14px; line-height: 21px;"><span style="margin: 0px; padding: 0px; font-family: 宋体;">关于</span><span style="margin: 0px; padding: 0px;">KMP</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">算法的原理和实现，书上或者百度一下都可以找到，我在这里就不罗嗦那么多了，直接切入主题（</span><span style="margin: 0px; padding: 0px;">next</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">数组）。</span></p>
<p style="margin: 5px auto; padding: 0px; text-indent: 0px; font-size: 14px; line-height: 21px;"><span style="margin: 0px; padding: 0px; font-family: 宋体;">我们设主串</span><span style="margin: 0px; padding: 0px;">S=abcabcabca</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">，模式串</span><span style="margin: 0px; padding: 0px;">p=abcabx</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">。</span></p>
<p style="margin: 5px auto; padding: 0px; text-indent: 0px; font-size: 14px; line-height: 21px;"><span style="margin: 0px; padding: 0px;">KMP</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">第一趟匹配：</span></p>
<p style="margin: 5px auto; padding: 0px; text-indent: 0px; font-size: 14px; line-height: 21px;"><span style="margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="margin: 0px; padding: 0px; font-family: 宋体;">　</span><span style="margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px;">&nbsp; &nbsp; &nbsp;&nbsp;</span>i=6<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></p>
<p style="margin: 5px auto; padding: 0px; text-indent: 0px; font-size: 14px; line-height: 21px;"><span style="margin: 0px; padding: 0px;">S<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;</span>: &nbsp;&nbsp;<span style="margin: 0px; padding: 0px; color: #00b050;">a<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>b<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>c<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>a<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>b</span><span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span><span style="margin: 0px; padding: 0px; color: red;">c</span><span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>a<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>&nbsp;b<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>c<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>a</span></p>
<p style="margin: 5px auto; padding: 0px; text-indent: 0px; font-size: 14px; line-height: 21px;"><span style="margin: 0px; padding: 0px; font-family: 宋体;">位置</span><span style="margin: 0px; padding: 0px;">&nbsp;:<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>1<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>2<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>3<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>4<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>5<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>6<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>7<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>8<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>9<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>10</span></p>
<p style="margin: 5px auto; padding: 0px; text-indent: 0px; font-size: 14px; line-height: 21px;"><span style="margin: 0px; padding: 0px;">P<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;</span>:<span style="margin: 0px; padding: 0px;">&nbsp; &nbsp;</span><span style="margin: 0px; padding: 0px; color: #00b050;">a<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>b<span style="margin: 0px; padding: 0px;">&nbsp; &nbsp;</span>c<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>a<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>b</span><span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span><span style="margin: 0px; padding: 0px; color: red;">x</span></span></p>
<p style="margin: 5px auto; padding: 0px; text-indent: 0px; font-size: 14px; line-height: 21px;"><span style="margin: 0px; padding: 0px; font-family: 宋体;">位置</span><span style="margin: 0px; padding: 0px;">&nbsp;:<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>1<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>2<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>3<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>4<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>5<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>6</span></p>
<p style="margin: 5px auto; padding: 0px; text-indent: 0px; font-size: 14px; line-height: 21px;"><span style="margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span>j=6<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></p>
<p style="margin: 5px auto; padding: 0px; text-indent: 0px; font-size: 14px; line-height: 21px;"><span style="margin: 0px; padding: 0px; font-family: 宋体;">第一次匹配到第</span><span style="margin: 0px; padding: 0px;">6</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">个位置的时候失败了，按照朴素的算法，</span><span style="margin: 0px; padding: 0px;">i</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">要回溯到第</span><span style="margin: 0px; padding: 0px;">2</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">个位置，</span><span style="margin: 0px; padding: 0px;">j</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">要回溯到第</span><span style="margin: 0px; padding: 0px;">1</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">个位置重新匹配。</span><span style="margin: 0px; padding: 0px;">KMP</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">的话，主串中的</span><span style="margin: 0px; padding: 0px;">i</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">是不会回溯，模式串中的</span><span style="margin: 0px; padding: 0px;">j</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">回溯也不会回溯到第</span><span style="margin: 0px; padding: 0px;">1</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">个位置。注意这里是关键，</span><span style="margin: 0px; padding: 0px;">i</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">不用回溯就可以完成整个字符串的匹配。为什么</span><span style="margin: 0px; padding: 0px;">i</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">不需要回溯呢？我们先留下这个疑问。</span></p>
<p style="margin: 5px auto; padding: 0px; text-indent: 0px; font-size: 14px; line-height: 21px;"><span style="margin: 0px; padding: 0px; font-family: 宋体;">我们把匹配成功的前</span><span style="margin: 0px; padding: 0px;">5</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">个字符研究一下。</span></p>
<p style="margin: 5px auto; padding: 0px; text-indent: 0px; font-size: 14px; line-height: 21px;"><span style="margin: 0px; padding: 0px;">1</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">位置的前缀子串为：</span><span style="margin: 0px; padding: 0px;">a ,&nbsp;<span style="margin: 0px; padding: 0px; color: red;">ab</span>&nbsp;, abc , abca</span></p>
<p style="margin: 5px auto; padding: 0px; text-indent: 0px; font-size: 14px; line-height: 21px;"><span style="margin: 0px; padding: 0px;">5</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">位置的后缀子串为：</span><span style="margin: 0px; padding: 0px;">bcab , cab ,<span style="margin: 0px; padding: 0px; color: red;">&nbsp;ab</span>&nbsp;, b</span></p>
<p style="margin: 5px auto; padding: 0px; text-indent: 0px; font-size: 14px; line-height: 21px;"><span style="margin: 0px; padding: 0px; font-family: 宋体;">我们观察发现两组里面都有一个</span><span style="margin: 0px; padding: 0px;">ab</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">，你能看出点什么东西么，好的，先不管这个。</span></p>
<p style="margin: 5px auto; padding: 0px; text-indent: 0px; font-size: 14px; line-height: 21px;"><span style="margin: 0px; padding: 0px; font-family: 宋体;">我们就按照朴素的算法来看，</span><span style="margin: 0px; padding: 0px;">i</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">回溯到第</span><span style="margin: 0px; padding: 0px;">2</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">第</span><span style="margin: 0px; padding: 0px;">3</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">位置都会在前</span><span style="margin: 0px; padding: 0px;">5</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">个字符中匹配失败。</span></p>
<p style="margin: 5px auto; padding: 0px; text-indent: 0px; font-size: 14px; line-height: 21px;"><span style="margin: 0px; padding: 0px; font-family: 宋体;">朴素匹配：</span></p>
<p style="margin: 5px auto; padding: 0px; text-indent: 0px; font-size: 14px; line-height: 21px;"><span style="margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span>&nbsp;i=4<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></p>
<p style="margin: 5px auto; padding: 0px; text-indent: 0px; font-size: 14px; line-height: 21px;"><span style="margin: 0px; padding: 0px;">S<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;</span>:<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span><span style="margin: 0px; padding: 0px; color: black;">a<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>b<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>c</span><span style="margin: 0px; padding: 0px; color: #00b050;"><span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>a<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>b</span><span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span><span style="margin: 0px; padding: 0px; color: #00b050;">c</span><span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>a<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;&nbsp;</span>b<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>c<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>a</span></p>
<p style="margin: 5px auto; padding: 0px; text-indent: 0px; font-size: 14px; line-height: 21px;"><span style="margin: 0px; padding: 0px; font-family: 宋体;">位置</span><span style="margin: 0px; padding: 0px;">&nbsp;:&nbsp;<span style="margin: 0px; padding: 0px; color: red;">1<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>2<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>3<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>4<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>5</span><span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>6<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>7<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>8<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>9<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>10</span></p>
<p style="margin: 5px auto; padding: 0px; text-indent: 0px; font-size: 14px; line-height: 21px;"><span style="margin: 0px; padding: 0px;">P<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;</span>:<span style="margin: 0px; padding: 0px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="margin: 0px; padding: 0px; color: #00b050;">a<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>b&nbsp;&nbsp;c</span><span style="margin: 0px; padding: 0px; color: black;"><span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>a<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>b<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>x</span></span></p>
<p style="margin: 5px auto; padding: 0px; text-indent: 0px; font-size: 14px; line-height: 21px;"><span style="margin: 0px; padding: 0px; font-family: 宋体;">位置</span><span style="margin: 0px; padding: 0px;">&nbsp;:<span style="margin: 0px; padding: 0px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="margin: 0px; padding: 0px; color: red;">&nbsp;1<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>2<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>3<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>4<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>5</span><span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>6</span></p>
<p style="margin: 5px auto; padding: 0px; text-indent: 0px; font-size: 14px; line-height: 21px;"><span style="margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span>j=1&nbsp;</span></p>
<p style="margin: 5px auto; padding: 0px; text-indent: 0px; font-size: 14px; line-height: 21px;"><span style="margin: 0px; padding: 0px; font-family: 宋体;">当回溯到第</span><span style="margin: 0px; padding: 0px;">4</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">个位置的时候，成功匹配的字符为</span><span style="margin: 0px; padding: 0px;">ab</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">，<span style="margin: 0px; padding: 0px; color: red;">然后</span>再去判断</span><span style="margin: 0px; padding: 0px;">S</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">串的第</span><span style="margin: 0px; padding: 0px;">6</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">个字符和</span><span style="margin: 0px; padding: 0px;">P</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">串的第</span><span style="margin: 0px; padding: 0px;">3</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">个位置。这个<span style="margin: 0px; padding: 0px; color: red;">然后</span>我们先不管，观察</span><span style="margin: 0px; padding: 0px;">S</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">中和</span><span style="margin: 0px; padding: 0px;">P</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">匹配的</span><span style="margin: 0px; padding: 0px;">ab</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">，在第一趟匹配的时候</span><span style="margin: 0px; padding: 0px;">S</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">中的</span><span style="margin: 0px; padding: 0px;">ab</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">是和</span><span style="margin: 0px; padding: 0px;">P</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">中前</span><span style="margin: 0px; padding: 0px;">5</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">个字符的最后两个匹配的，而这一次匹配则是和</span><span style="margin: 0px; padding: 0px;">P</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">中前两个字符匹配的。能发现点什么东西么？</span></p>
<p style="margin: 5px auto; padding: 0px; text-indent: 0px; font-size: 14px; line-height: 21px;"><strong style="margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px; font-family: 宋体;">不需要让</span><span style="margin: 0px; padding: 0px;">i</span></strong><strong style="margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px; font-family: 宋体;">回溯到之前的位置重新匹配，只需要找到在</span><span style="margin: 0px; padding: 0px;">P</span></strong><strong style="margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px; font-family: 宋体;">串前</span><span style="margin: 0px; padding: 0px;">5</span></strong><strong style="margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px; font-family: 宋体;">个字符中第一个位置的前缀子串和最后一个位置的后缀子串相等并且串长最大的那一对子串，让</span><span style="margin: 0px; padding: 0px;">j</span></strong><strong style="margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px; font-family: 宋体;">指向前缀子串最后一个字符的下一个位置</span><span style="margin: 0px; padding: 0px;">3</span></strong><strong style="margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px; font-family: 宋体;">，和</span><span style="margin: 0px; padding: 0px;">i</span></strong><strong style="margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px; font-family: 宋体;">所指向的</span><span style="margin: 0px; padding: 0px;">6</span></strong><strong style="margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px; font-family: 宋体;">进行比较。往后遇见不匹配的时候采取和这个一样的方法。</span></strong></p>
<p style="margin: 5px auto; padding: 0px; text-indent: 0px; font-size: 14px; line-height: 21px;"><span style="margin: 0px; padding: 0px;">KMP</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">第二趟匹配：</span></p>
<p style="margin: 5px auto; padding: 0px; text-indent: 0px; font-size: 14px; line-height: 21px;"><span style="margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;<span style="margin: 0px; padding: 0px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span>i=6<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></p>
<p style="margin: 5px auto; padding: 0px; text-indent: 0px; font-size: 14px; line-height: 21px;"><span style="margin: 0px; padding: 0px;">S<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;</span>:<span style="margin: 0px; padding: 0px;">&nbsp; &nbsp;</span><span style="margin: 0px; padding: 0px; color: black;">a<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>b<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>c</span><span style="margin: 0px; padding: 0px; color: #00b050;"><span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>a<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>b</span><span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span><span style="margin: 0px; padding: 0px; color: #00b050;">c</span><span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>a<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;&nbsp;</span>b<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>c<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>a</span></p>
<p style="margin: 5px auto; padding: 0px; text-indent: 0px; font-size: 14px; line-height: 21px;"><span style="margin: 0px; padding: 0px; font-family: 宋体;">位置</span><span style="margin: 0px; padding: 0px;">&nbsp;:<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span><span style="margin: 0px; padding: 0px; color: red;">1<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>2<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>3<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>4<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>5</span><span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>6<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>7<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>8<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>9<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>10</span></p>
<p style="margin: 5px auto; padding: 0px; text-indent: 0px; font-size: 14px; line-height: 21px;"><span style="margin: 0px; padding: 0px;">P<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;</span>:<span style="margin: 0px; padding: 0px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="margin: 0px; padding: 0px; color: #00b050;">a<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>b&nbsp;&nbsp;c</span><span style="margin: 0px; padding: 0px; color: black;"><span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>a<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>b<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>x</span></span></p>
<p style="margin: 5px auto; padding: 0px; text-indent: 0px; font-size: 14px; line-height: 21px;"><span style="margin: 0px; padding: 0px; font-family: 宋体;">位置</span><span style="margin: 0px; padding: 0px;">&nbsp;:<span style="margin: 0px; padding: 0px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="margin: 0px; padding: 0px; color: red;">&nbsp;1<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>2<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>3<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>4<span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>5</span><span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;</span>6</span></p>
<p style="margin: 5px auto; padding: 0px; text-indent: 0px; font-size: 14px; line-height: 21px;"><span style="margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="margin: 0px; padding: 0px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span>j=3&nbsp;</span></p>
<p style="margin: 5px auto; padding: 0px; text-indent: 0px; font-size: 14px; line-height: 21px;"><span style="margin: 0px; padding: 0px; font-family: 宋体;">这个时候就需要</span><span style="margin: 0px; padding: 0px;">next</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">数组的建立了，</span><span style="margin: 0px; padding: 0px;">next[6]</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">存储的就是前</span><span style="margin: 0px; padding: 0px;">5</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">个字符组成的字符串中的第一个位置的前缀子串和最后一个位置的后缀子串相等并且串长最大的那一对子串的最后一个字符的下一个位置，也就是</span><span style="margin: 0px; padding: 0px;">3</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">，也就是和</span><span style="margin: 0px; padding: 0px;">P</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">串中第</span><span style="margin: 0px; padding: 0px;">3</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">个位置匹配。</span></p>
<p style="margin: 5px auto; padding: 0px; text-indent: 0px; font-size: 14px; line-height: 21px;"><span style="margin: 0px; padding: 0px; font-family: 宋体;">写到这里，</span><span style="margin: 0px; padding: 0px;">next</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">数组应该可以得出来了。</span></p>
<p style="margin: 5px auto; padding: 0px; text-indent: 0px; font-size: 14px; line-height: 21px;"><span style="margin: 0px; padding: 0px; font-family: 宋体;">具体代码怎么得出来的，书上面都有。。那个应该不难。</span></p>
<p style="margin: 5px auto; padding: 0px; text-indent: 0px; font-size: 14px; line-height: 21px;"><span style="margin: 0px; padding: 0px; font-family: 宋体;">对于</span><span style="margin: 0px; padding: 0px;">next</span><span style="margin: 0px; padding: 0px; font-family: 宋体;">数组还有一个优化，《严书》上讲的很清晰。</span></p>
<p style="margin: 5px auto; padding: 0px; text-indent: 0px; font-size: 14px; line-height: 21px;"><strong style="margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px; font-size: 16pt; font-family: 宋体;">三、</span></strong><strong style="margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px; font-size: 16pt;">next</span></strong><strong style="margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px; font-size: 16pt; font-family: 宋体;">数组在</span></strong><strong style="margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px; font-size: 16pt;">ACM</span></strong><strong style="margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px; font-size: 16pt; font-family: 宋体;">中的应用</span></strong><strong style="margin: 0px; padding: 0px;"></strong></p>
<p style="margin: 5px auto; padding: 0px; text-indent: 0px; font-size: 14px; line-height: 21px;"><span style="margin: 0px; padding: 0px; font-family: 宋体; color: black;">直接用<span style="margin: 0px; padding: 0px;">KMP</span>算法真的去匹配两个字符串其实很少见，除非字符串里的字符集范围很小，或字符重复数量过多，用<span style="margin: 0px; padding: 0px;">KMP</span>可大减少时间，否则一般都是直接朴素匹配。</span><span style="margin: 0px; padding: 0px; font-family: 宋体; color: black;"><br style="margin: 0px; padding: 0px;" />kmp</span><span style="margin: 0px; padding: 0px; font-family: 宋体; color: black;">算法在<span style="margin: 0px; padding: 0px;">ACM</span>中并不大可能用来直接用，主要有用的是对它的理解和它的精华部分<span style="margin: 0px; padding: 0px;">----</span>求<span style="margin: 0px; padding: 0px;">&nbsp;next</span>数组，这个的一个用途就是确定重复子串，具体参见<span style="margin: 0px; padding: 0px;">&nbsp;poj2406,poj1961,poj2752。</span></span></p>