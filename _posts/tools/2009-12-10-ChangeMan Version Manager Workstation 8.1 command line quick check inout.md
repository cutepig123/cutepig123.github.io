---
categories: tools
---
import os,sys,datetime<br /><br />file_in = sys.argv[1]<br />Mode = {}<br />Mode[1] = "Get"<br />Mode[2] = "Check out"<br />Mode[3] = "Check in"<br />mode = raw_input(Mode)<br />mode = int(mode)<br />if mode&lt;1 or mode&gt;3:<br />&nbsp;&nbsp; &nbsp;print "Invalid mode:", mode<br />&nbsp;&nbsp; &nbsp;exit(0)<br />&nbsp;&nbsp; &nbsp;<br />versionLabel = raw_input("\n\nInput version label:[Latest Version for get, and Null for put]")<br />if len(versionLabel)==0:<br />&nbsp;&nbsp; &nbsp;if mode == 1 or mode == 2:<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;versionLabel = "Latest Version"<br />&nbsp;&nbsp; &nbsp;<br />description = "[Enhancement]%s[Compatiblilty]Link"%(raw_input("\n\npls input description:"))<br /><br />print<br />print&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;<br />print "mode:", Mode[mode]<br />print "versionLabel:", versionLabel<br />print "description:", description<br />os.system("pause")<br /><br />dst_folder = "_pvcsGet_"+file_in+"_"+datetime.datetime.now().strftime('%Y_%m_%d_%H_%M_%S')<br /><br />fp = open(file_in,'r')<br />lines = fp.readlines()<br />fp.close()<br /><br /><br />fileNum = 1<br />for line in lines:<br />&nbsp;&nbsp; &nbsp;src=line.replace('\r','').replace('\n','').strip()&nbsp;&nbsp; &nbsp;#delete \r\n<br />&nbsp;&nbsp; &nbsp;if len(src) == 0 : continue&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;#skip empty line<br />&nbsp;&nbsp; &nbsp;if src[0] in ['#', ';']:&nbsp;&nbsp; &nbsp;continue&nbsp;&nbsp; &nbsp;#skip comment<br />&nbsp;&nbsp; &nbsp;<br />&nbsp;&nbsp; &nbsp;dst=src<br />&nbsp;&nbsp; &nbsp;<br />&nbsp;&nbsp; &nbsp;p = src.find(':')&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;#delete x:\<br />&nbsp;&nbsp; &nbsp;if p&gt;=0: <br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;dst=dst[p+2::]<br />&nbsp;&nbsp; &nbsp;else:<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;dst = src<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;while dst[0]=='\\': dst=dst[1::]<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;<br />&nbsp;&nbsp; &nbsp;src = dst.replace('\\','/')<br />&nbsp;&nbsp; &nbsp;dst = dst_folder + '\\' + dst<br />&nbsp;&nbsp; &nbsp;<br />&nbsp;&nbsp; &nbsp;#make folder<br />&nbsp;&nbsp; &nbsp;if False:<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;dstFdr = dst[:dst.rfind('\\'):]<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;if not os.path.isdir(dstFdr):<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;cmd = 'mkdir "%s"' %dstFdr<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;os.system(cmd)<br /><br />&nbsp;&nbsp; &nbsp;#get source<br />&nbsp;&nbsp; &nbsp;exe = r"\\aaants240.aaatest.com\SerenaClnt\vm\win32\bin\pcli "<br />&nbsp;&nbsp; &nbsp;userPwd = r' -pr"\\vis\eagleapp" -id"USR:PWD" '<br />&nbsp;&nbsp; &nbsp;if mode==1:&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;#get<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;cmd= exe + r' Get ' + userPwd + r' -v"%s"&nbsp; -a"%s" -z /Diebond/%s'%(versionLabel,dst, src)<br />&nbsp;&nbsp; &nbsp;elif mode==2:&nbsp;&nbsp; &nbsp;#check out<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;cmd= exe + r' Get ' + userPwd + r' -v"%s" -l -a"%s" -z /Diebond/%s'%(versionLabel,dst, src)<br />&nbsp;&nbsp; &nbsp;elif mode==3:&nbsp;&nbsp; &nbsp;#put, Use default source path<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;if len(versionLabel)&gt;0:<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;cmd= exe + r' Put ' + userPwd + r' -v"%s" -m"%s" -z /Diebond/%s'%(versionLabel, description, src)<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;else:<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;cmd= exe + r' Put ' + userPwd + r' -m"%s" -z /Diebond/%s'%(description, src)<br />&nbsp;&nbsp; &nbsp;status = os.system(cmd)<br />&nbsp;&nbsp; &nbsp;print '****',fileNum , status#, src, dst<br />&nbsp;&nbsp; &nbsp;if status!=0:<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;os.system("pause")<br />&nbsp;&nbsp; &nbsp;fileNum += 1<br />