<div>#include &lt;stdio.h&gt;<br /><br />#define CHECK(x) {if(!(x)) printf("ERROR " #x " @Line %d\n", __LINE__);}<br /><br />struct&nbsp; TypeInfo<br />{<br />&nbsp;&nbsp; &nbsp;char* m_name;<br />&nbsp;&nbsp; &nbsp;const TypeInfo* m_parent;<br />&nbsp;&nbsp; &nbsp;<br />&nbsp;&nbsp; &nbsp;TypeInfo(char* name, const TypeInfo* parent)<br />&nbsp;&nbsp; &nbsp;:m_name(name), m_parent(parent)<br />&nbsp;&nbsp; &nbsp;{<br />&nbsp;&nbsp; &nbsp;}<br />};<br /><br />class A<br />{<br />&nbsp;&nbsp; &nbsp;static TypeInfo typeInfo_a;<br />public:<br />&nbsp;&nbsp; &nbsp;static const TypeInfo* GetType()<br />&nbsp;&nbsp; &nbsp;{<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;return &amp;typeInfo_a;<br />&nbsp;&nbsp; &nbsp;}<br />};<br /><br />TypeInfo A::typeInfo_a("A", NULL);<br /><br />class B:public A<br />{<br />&nbsp;&nbsp; &nbsp;static TypeInfo typeInfo_b;<br />public:<br />&nbsp;&nbsp; &nbsp;static const TypeInfo* GetType()<br />&nbsp;&nbsp; &nbsp;{<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;return &amp;typeInfo_b;<br />&nbsp;&nbsp; &nbsp;}<br />};<br /><br />TypeInfo B::typeInfo_b("A", A::GetType());<br /><br />template &lt;class A, class B&gt;<br />bool IsBaseOf()<br />{<br />&nbsp;&nbsp; &nbsp;for( const TypeInfo* typeinfo = B::GetType(); typeinfo; typeinfo = typeinfo-&gt;m_parent )<br />&nbsp;&nbsp; &nbsp;{<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;if( typeinfo == A::GetType() )<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;return true;<br />&nbsp;&nbsp; &nbsp;}<br />&nbsp;&nbsp; &nbsp;<br />&nbsp;&nbsp; &nbsp;return false;<br />}<br /><br />template &lt;class A, class B&gt;<br />bool IsBaseOf2(const A* pa, const B* pb)<br />{<br />&nbsp;&nbsp; &nbsp;for( const TypeInfo* typeinfo = pb-&gt;GetType(); typeinfo; typeinfo = typeinfo-&gt;m_parent )<br />&nbsp;&nbsp; &nbsp;{<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;if( typeinfo == pa-&gt;GetType() )<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;return true;<br />&nbsp;&nbsp; &nbsp;}<br />&nbsp;&nbsp; &nbsp;<br />&nbsp;&nbsp; &nbsp;return false;<br />}<br /><br />int main( int argc, char **argv ) <br />{ <br />&nbsp;&nbsp; &nbsp;CHECK((IsBaseOf&lt;A,B&gt;()));<br />&nbsp;&nbsp; &nbsp;CHECK((!IsBaseOf&lt;B,A&gt;()));<br />&nbsp;&nbsp; &nbsp;<br />&nbsp;&nbsp; &nbsp;A a;<br />&nbsp;&nbsp; &nbsp;B b;<br />&nbsp;&nbsp; &nbsp;A &amp;pb=b;<br />&nbsp;&nbsp; &nbsp;<br />&nbsp;&nbsp; &nbsp;CHECK(IsBaseOf2(&amp;a,&amp;b));<br />&nbsp;&nbsp; &nbsp;CHECK(!IsBaseOf2(&amp;b,&amp;a));<br />&nbsp;&nbsp; &nbsp;<br />&nbsp;&nbsp; &nbsp;CHECK(IsBaseOf2(&amp;a,&amp;pb));<br />&nbsp;&nbsp; &nbsp;CHECK(!IsBaseOf2(&amp;pb,&amp;a));<br />&nbsp;&nbsp; &nbsp;<br />&nbsp;&nbsp; &nbsp;return 0;<br />}<br /></div>