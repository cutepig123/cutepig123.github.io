---
categories: networking
---
<p>NAT之确定nat类型<br /><br /><strong>下载安装twisted和zope</strong><br />http://twistedmatrix.com/trac/wiki/Downloads<br />http://pypi.python.org/pypi/zope.interface/3.8.0#downloads<br /><br /><strong>下载stunclient</strong><br />http://code.google.com/p/stunclient/<br /><br /><strong>这里面有个stun子目录，说是用于发现NAT类型</strong><br />This code comes from Shtoom: http://divmod.org/projects/shtoom<br /><br /><strong>执行里面的stun.py，就会log一个文件</strong>，在我电脑上如下(很费解啊）<br /><br />01:23:30 [-] Log opened.<br />01:23:30 [-] &lt;class '__main__.TestStunDiscoveryProtocol'&gt; starting on 5061<br />01:23:30 [-] Starting protocol &lt;__main__.TestStunDiscoveryProtocol object at 0x00EDB190&gt;<br />01:23:30 [-] startDiscover--localAddress is 0.0.0.0<br />01:23:30 [-] localAddress is invalid!<br />01:23:30 [-] resolving A.ROOT-SERVERS.NET<br />01:23:30 [-] connecting UDP socket to 198.41.0.4<br />01:23:30 [-] twisted.internet.protocol.DatagramProtocol starting on 57131<br />01:23:30 [-] Starting protocol &lt;twisted.internet.protocol.DatagramProtocol instance at 0x00EE3828&gt;<br />01:23:30 [-] connected UDP socket says 192.168.1.100<br />01:23:30 [-] (Port 57131 Closed)<br />01:23:30 [-] Stopping protocol &lt;twisted.internet.protocol.DatagramProtocol instance at 0x00EE3828&gt;<br />01:23:30 [-] sending request 'bbf2c488eedcba1863238b76fbbdb1a' with 1 avpairs to ('216.146.35.99', 3478) (in state 1)<br />01:23:30 [-] sending request 'bcffaf59142c3cf2575d2fb6f06424' with 1 avpairs to ('213.192.59.75', 3478) (in state 1)<br />01:23:30 [-] sending request '26e9d0804bc12a4037aa59ccbd75e49' with 1 avpairs to ('192.98.81.87', 3478) (in state 1)<br />01:23:30 [-] sending request 'bbf2c488eedcba1863238b76fbbdb1a' with 1 avpairs to ('216.146.35.99', 3478) (in state 1)<br />01:23:30 [-] sending request 'bcffaf59142c3cf2575d2fb6f06424' with 1 avpairs to ('213.192.59.75', 3478) (in state 1)<br />01:23:30 [-] sending request '26e9d0804bc12a4037aa59ccbd75e49' with 1 avpairs to ('192.98.81.87', 3478) (in state 1)<br />01:23:30 [-] sending request 'bbf2c488eedcba1863238b76fbbdb1a' with 1 avpairs to ('216.146.35.99', 3478) (in state 1)<br />01:23:30 [-] sending request 'bcffaf59142c3cf2575d2fb6f06424' with 1 avpairs to ('213.192.59.75', 3478) (in state 1)<br />01:23:30 [-] sending request '26e9d0804bc12a4037aa59ccbd75e49' with 1 avpairs to ('192.98.81.87', 3478) (in state 1)<br />01:23:30 [stun] got STUN response to None from ('213.192.59.75', 3478)<br />01:23:30 [__main__.TestStunDiscoveryProtocol (UDP)] MAPPED-ADDRESS 116.48.48.225 14959<br />01:23:30 [__main__.TestStunDiscoveryProtocol (UDP)] CHANGED-ADDRESS 213.192.59.93 3479<br />01:23:30 [__main__.TestStunDiscoveryProtocol (UDP)] SOURCE-ADDRESS 213.192.59.75 3478<br />01:23:30 [__main__.TestStunDiscoveryProtocol (UDP)] sending request '1fd789b6d02e4be456597e8be1df4a7a' with 1 avpairs to ('213.192.59.75', 3478) (in state 2b)<br />01:23:30 [stun] ignoring belated STUN response to 'bcffaf59142c3cf2575d2fb6f06424' from ('213.192.59.75', 3478)<br />01:23:30 [-] sending request '1fd789b6d02e4be456597e8be1df4a7a' with 1 avpairs to ('213.192.59.75', 3478) (in state 2b)<br />01:23:30 [stun] ignoring belated STUN response to 'bcffaf59142c3cf2575d2fb6f06424' from ('213.192.59.75', 3478)<br />01:23:30 [-] sending request '1fd789b6d02e4be456597e8be1df4a7a' with 1 avpairs to ('213.192.59.75', 3478) (in state 2b)<br />01:23:30 [stun] got STUN response to '1fd789b6d02e4be456597e8be1df4a7a' from ('213.192.59.93', 3479)<br />01:23:30 [__main__.TestStunDiscoveryProtocol (UDP)] MAPPED-ADDRESS 116.48.48.225 14959<br />01:23:30 [__main__.TestStunDiscoveryProtocol (UDP)] CHANGED-ADDRESS 213.192.59.93 3479<br />01:23:30 [__main__.TestStunDiscoveryProtocol (UDP)] SOURCE-ADDRESS 213.192.59.93 3479<br />01:23:30 [__main__.TestStunDiscoveryProtocol (UDP)] calling handleStunState2b<br />01:23:30 [__main__.TestStunDiscoveryProtocol (UDP)] 2b {'externalAddress': ('116.48.48.225', 14959), '_altStunAddress': ('213.192.59.93', 3479)}<br />01:23:30 [__main__.TestStunDiscoveryProtocol (UDP)] STUN finished, results:<br />01:23:30 [__main__.TestStunDiscoveryProtocol (UDP)] You're behind a &lt;NatType FullCone&gt;<br />01:23:30 [__main__.TestStunDiscoveryProtocol (UDP)] and external address is ('116.48.48.225', 14959)<br />01:23:30 [__main__.TestStunDiscoveryProtocol (UDP)] (Port 5061 Closed)<br />01:23:30 [__main__.TestStunDiscoveryProtocol (UDP)] Stopping protocol &lt;__main__.TestStunDiscoveryProtocol object at 0x00EDB190&gt;<br />01:23:30 [-] Main loop terminated.<br /><br /></p>