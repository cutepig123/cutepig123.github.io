技术专栏：IP机顶盒的功能和发展http://www.pjtime.com 来源：世界电信　更新时间：2006-2-6 9:31:00 作者：佚名康佳LC47DT08AC液晶首评长虹50寸等离子9999元14款1080p平板横评TCL L42E9FR液晶评测


    摘要：主要介绍IPTV终端系统――IP机顶盒的功能模块、种类、与IPTV网络的交互方及发展方向。具体介绍了IP机顶盒的构成和功能，基于硬件和软件的分类方式，以及涉及用户业务流程的认证、付费和服务使用的三大类接口。

    关键词：IP机顶盒业务流程　IPTV

    IP机顶盒概述

    IPTV（InternetProtocolTVor Interactive Personal TV）也叫交互式网络电视，是利用宽带网的基础设施，以家用电视机或计算机作为主要终端设备，集互联网、多媒体、通信等多种技术于一体，通过IP协议向家庭用户提供包括数字电视在内的多种交互式数字媒体服务的崭新技术。IPTV业务核心框架主要由内容运营平台、业务运营平台、业务承载传输网络、用户终端网络等四大部分组成。IPTV技术涉及了视频编解码、网络分发、数字版权保护、终端接入等各面的技术。

    IP机顶盒是视频解码终端，相当于一台自带嵌入式操作系统的计算机。从图1可以看出，IP机顶盒一端通过DSL或以太网方式接入IPVT网络，一端将通过网络传输过来的媒体流等信息转换成模拟视音频输出至电视，由此在电视上祥视频点播、网页浏览、游戏等功能，它具备计算机的数据交换等基本功能，可以采用遥控器或PC直接操作。

    IP机顶盒的构成与功能

    机顶盒由软件和硬件两大部分组成，机顶盒的硬件包含了主芯片、内存、调谐解调器、回传通道、CA（ConditionalAccess）接口、外部存储控制器以及视音频输出等几大部分。软件则分成应用层、中间解释层和驱动层三层，每一层都包含了诸多的程序或接口等。

    与传统的数字机顶盒相比，IP机顶盒实现了视频、语音、数据三者的融合，即所谓的三网合一业务（TriplePlayService）。IP机顶盒的系统架构包含三个独立的子系统：TV单元、PC单元和条件存取（即加密系统、CA）单位。TV子系统由调频器和视频解码器组成，它们用来处理数字串流信息；CA子系统让服务商具有控制能力，可以对用户实现临近，能够知道用户在何时收看什么节目；PC子系统大多是模块式的设计，STB的设计者可以依其需求而增加或减少这个系统中的组件，由于IPSTB的目标是要提供互联网的服务功能，故它的PC系统方面就得提供TCP/IP的堆栈协议，并具有更佳的储存方案。

    由此可以看出，IP机顶盒的功能主要包括以下三方面：

    ・支持目前的LAN或DSL网络传输，接收及处理IP数据和视频流；

    ・支持MPEG、WMV和Real等视频解码；

    支持用户认证功能、通过与IPTV系统的交互实现用户的访问控制、计费等管理功能。

    IP机顶盒的分类方式

    根据硬件、软件的不同，IP机顶盒有不同的分类方式

    1.基于硬件的分类方式　

    IP机顶盒按照基中使用的CPU芯片的不同，可以分为以下三种：

    （1）基于专用芯片组（ASIC/SOC编解码芯片）的机顶盒

    专用芯片组除了处理器以外，在芯片内还集成了一些其他的IP（LntelligentProperty）模块，如Videoin，Videoout，Audio in及Audio out等，有的还有图像压缩硬件加速模块等。由于专用视频压缩芯片携带固定压缩模块、固定的处理方式和固定的微码，所以传统的基于ASCI/SOC的机顶盒产品价格比较低廉，但由于全硬件芯片的实现方案使得运营商无法通过软件升级来提升产品性能，另外这种机顶网络适应性也有较大问题。

    （2）基于X86平台

    基于X86架构CPU的嵌入式系统有如下优势：一是它可以对不同格式的文件进行编解码；二是X86架构的CPU有较齐全的应用软件，维护成本低；三是基于X86架构的嵌入式系统可以轻松与PC资源共享。

    （3）基于多媒体处理器技术

    基于X86平台的方式在使用时要占据CPU的绝大部分处理能力。因此，在有些不适合采用这种方式。于是出现了基于多媒体处理器技术的独立机型的机顶盒。这种芯片高速的运算能力完全可以实现适合不同协议的通信终端。采用这些芯片可以很方便地实现MPEG视频和音频处理、H.263视频处理，以及DVD、机顶盒、数字电视等。

    由于使用了实时视频解码功能芯片，视频处理速度明显提高，配合实时编码，全程视频处理时延小，特别适合视频直播系统应用；系统配有USB，IDE，PCMCIA和以太等接口，使IPTV终端功能可扩充性增强、内存占用少、硬件结构紧凑，成本不高。

    2.基于软件的分类方式

    操作系统是机顶盒中的核心软件，机顶盒中的操作系统不大，但却要求可以在实时的环境中工作，并能在较小的内在内存空间中运行，这种操作系统称为实时操作系统（RTOS），目前主要有VxWorks、WindowsCE、嵌入式Linux等三类。

    （1）嵌入式WinCE终端

    WinCE最大特点是其API与Win32兼容，这有利于使用Windows环境开发WinCE应用，此外，WMV播放器还可直接运行于WinCEOS，许多现成的Windows组件稍加改造就能应用于终端上的网络管理以及视频流控制等功能，能够充分分享MMS等的WindowsMedia优秀成果。微软目前推出WinCE5.0，并扩大开放部分程序源代码。在这个开放了源代码计划授权下，微软开放250万行源代码程序作为评估套件，凡是个人、厂商都可以下载这些源代码加以修改使用。未来厂商OEM时，则需依执行时期授权，支付WinCE5.0核心每台机器数美元的授权费用。，作为市场新进入者，微软强调较低的开发成本。微软在WinCE加入了档案系统、IPv4/IPv6、WLAN、蓝牙等联网功能以及WindowsMediaCoder等功能。

    不过此类终端的弊端在于：应用源代码不公开，终端采用WinCE须向微软交纳版税；另外，WinCE代码庞大，占用很多的ROM和RAM，要求有高性能的X86微处理器支持，所有这些都造成了终端成本的居高不下。

    （2）嵌入式LINUX终端

    这种终端往往以专用的多媒体微处理器为核心，辅以以太接口和视频接口构成系统。多媒体微处理器本身不但具有嵌入式RISC（精简指令集CPU）去运行系统软件和应用软件，而且带MPEG2或MPEG4实时解码功能芯片，在引LinuxOS和必要的视频以及各辅助接口驱动程序后，就成为一个完整的IPTV网络终端运用环境。

    使用Linux开发平台优点首先Linux源代码公开，有大量免费优秀开发工具和应用软件可用，无须为每例应用交纳许可证费；其次有庞大的开发群体，技术交流方便，软件开发和维护成本低；最后，Linux本身稳定，内核精焊，运行所需资源少，有优秀的网络功能，支持的硬件数量庞大。总之，性价比高是其最大特色。

    但是，这种系统适应低带宽能力存在一定的局限性。由于采用的是硬件实时解码，解码器性能提高受制于芯片技术发展，于是就省去QPEL和GMC编码工具，这就使得MPEG4ASP高清晰度性能、适合DSL低带宽网络传输的优点得不到充分发挥，某些OS基于μCLinux、解码器甚于不完全MPEG4ASP的终端，线路工作带宽在3Mbit/s，在同样播放分辩率D1下，适合DSL网络低带宽的能力比基于WMVx的Codec终端逊色。这种机顶盒的价格较低，但由于兼容性不好，系统服务器端的建设和媒体文件的采集成本会偏高。

    VxWorks是美国WindRiverSystem公司推出的一个实时操作系统。VxWorks是一个运行在目标机上的高性能、可裁减的嵌入式实时操作系统。它以其良好的可靠性和卓越的实时性被广泛地应用在通信、军事、航空、航天等高精尖技术及实时性要求极高的领域，如卫星通信、军事演习、弹道制导、飞机导航等。

    当然，根据机顶盒的功能高低和价格差异，也可把机顶盒分成基本型、专业型、综合型等。

    机顶盒与IPTV平台的接口

    机顶盒与IPTV平台的接口涉及内容很多，其中涉及用户业务流程的可以分为：认证接口、付费接口和服务使用接口三大类。

    1.认证接口

    认证接口含网络层认证和应用层认证就是实现机顶盒早互联网的过程，即互联网用户接入互联网的过程。按用户与网络设备之间的通信方式，目前使用较多的网络层接入认证方式分为PPPoE和DHCP+WeB两种。

    （1）PPPoE技术

    目前PPPoE认证技术在以太网接入和ADSL接入方式中应用的最为广泛，其组网原理基本相同，都是利用交换机或DSLAM将用户接入网内，在交换机和DSLAM后面设置BRAS设备来终结PPP。终结PPP连接的宽带接入服务器可以对这PPP连接分别进行管理，可对用户上网业务分别进行时长和流量信息的统计，各种计费方式提供必要的用户上网信息。

    PPPoE的实质是在以太网上跑PPP协议，在用户端和宽带接入服务器之间建立了PPP的点对点通道。也就是说，如果在用户主机和BRAS之间启用组播业务，则组播数据必须以BRAS作为接收端复制点，这样会使大量的组播数据穿越网络和DSLAM设备，违背组播的初衷。因此PPPoE接入方式限制了组播协议的存在，影响视频业务的开展。

    （2）DHCP+Web技术

    DHCP+Web认证需要与DHCP服务器和Web认证服务器配合使用，Host首先通过DHCP得到一个IP地址，与Web认证服务器通信，也可以使用户只访问一些内部服务器，然后，接入服务器将用户强制连接到Web认证服务器上，并在浏览器中弹认证页面。在该页面中输入赂和密码，WebServer作为Radius的Client端把认证信息传送到RadiusServer，对用户进行认证。认证通过后，用户获得新的合法的IP地址，可以访问因特网或特定的网络。

    在DHCP+Web认证方式中，用户主机和接入服务器之间并没有任何类似PPP的第3层通道，也不存在对组播协议的限制。如果用户主要到接入服务器之间的交换机或DSLAM能支持IGMPSnooping，组播业务很容易开展。但是DHCP本身存在很多缺点，特别是安全性问题，如何能够保证用户信息的合法性、真实性是DHCP需要解决的关键问题。

    （3）改进方案

    由此可以看到，网络层认证根据STB终端支持的程度可采用PPPoE认证或DHCP方式。但是这两种认证方式，都不能够满足IPTV业务开展的需要。因此，我们就需要针对现在的认证方式提供相应的解决方案，在保证IPTV业务开展的前提下，尽可能的减少对现网的大规范改动，以保证原有业务的的支撑。

    对于STB终端采用PPPoE进行认证的方式，主要需要解决的问题是数据的下发。因此可以针对用户的不同业务采用不同的业务分发通道。也就是说，一方面要求BRAS设备支持IPTV业务的PPPoE认证，其相关的单播数据通过PPPoE的通道进行下发；这就要求BRAS通过认证信息能够区分用户业务种类，而DLSAM设备需要支持组播分发及组播组的控制，同时要求STB设备支持双协议栈。这样既可以保证原有认证系统的功能，同时也能够保证组播业务的顺利开展。

    而对于DHCP认证方式，其主要问题是保证DHCP接入的安全性和真实性，这就需要在DHCP包文中引入OPTION82选项；对于存在多个终端同时使用DHCP的场合，为了区分这些终端，还需引入OPTION60选项。DHCPOOPTION82选项通常由DSLAM设备将用户的商品信息和设备信息到用户的DHCP报文，DHCP服务器通过识别OPTION82为来执行IP地址分配策略或其它策略。OPTION60选项通常由终端自带，不同类型的终端可以通过设置不同的OPTION60来识别。通过OPTION60选项，可以实现不同的终端分配不同的地址空间。但是，OPTION82的引入需要DSLAM的支持，目前运营使用的设备并不具备该功能，因此需要进行网络设备的改造。

    目前的解决方案比较倾向于采用DHCP，并采用独立的IPPOOL的方式，该方案可以通过针对IP的策略配置实现IPTV业务与传统上网业务的隔离。在IP-TV用户量不高的情况下，较小的设资就可以满足业务要求。

    （4）应用层认证

    应用层认证实现了机顶盒用户在IPTV系统的身份认证过程，经过应用层认证的用户才可以消费、使用IPTV台提供的各种类型的服务。只有安全的应用层认技术，才能保证内容提供商放心地精彩的内容用放在IPTV系统上。

    2.用户消费接口

    用户消费接口需要实现系统价格提示、用户确认购买、系统实现扣费一个复杂的消费过程，根据计费方式和付费方式的不同，接口的流程也有不同。

    3.内容使用接口

    内容使用接口实现用户从内容运营获得不同应用服务的过程IPTV系统提供的应用已经日益丰富，如视频直播、视频点播、游戏、卡拉OK、信息检索等等，随着机顶盒功能的日益强大，网络传输带宽的不断增加，我们有理由相信现在PC上的各种互联网应用都会通过机顶盒呈现在用户的电视机上。

    IP机顶盒的发展方向

    从数字电视机顶盒（DVB-C）、卫星机顶盒（DVB-S）、网络电视机顶盒，机顶盒到现在最红火的IP机顶盒，机顶盒的队伍不断壮大，更不断发展。为了机顶盒的大规模发展，机卡分离的机顶的大规模发展，机卡分离的机顶盒渐成趋势。另外，双模机顶盒、软件机顶盒也在不断成熟。随着数字家庭概念的发展和推广，未来的机顶盒可能会演变成为家庭中客厅技术的核心控制单元，也就是业界称的“HomeGateway”或“ResidentialGateway”。除了可以包今现有的视频传输功能之外，更多的是向家庭中所有的智能设备提供一条集成的，综合的交通本世纪，实现设备之间的互联互通，并且可以给不同终端提供不同个性业务，实现“Multi-Play”。
