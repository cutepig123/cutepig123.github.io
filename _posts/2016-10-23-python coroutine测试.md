<p>目的：实现一个类似于asyn await的用法，来方便的编写callback相关函数</p>
<p>&nbsp;</p>
<pre>from __future__ import print_function<br />import time<br />import threading<br /><br />def asyn_task(callback):<br />    def SleepTask():<br />        time.sleep(1)<br />        callback("world")<br />   # t = threading.Timer(1.0, lambda :callback("world"))<br />    t = threading.Thread(target=SleepTask)<br />    t.start()  # after 30 seconds, "hello, world" will be printed<br /><br /><br />def main():<br />    asyn_task(lambda s:print(s))<br />    print ("hello")<br /><br />def main2():<br />    class myCoroutine:<br />        def __init__(self):<br />            self.evt = threading.Event()<br />            self.co=self.myCOroutine()<br />            self.co.next()<br />        def myCOroutine(self):<br />            while 1:<br />                self.evt.clear()<br />                line = (yield)<br />               # print ('yield:' + line)<br />                self.line = line<br />                self.evt.set()<br /><br />        def await(self):<br />            self.evt.wait()<br />            return self.line<br /><br />        def send(self, *args):<br />            self.co.send(*args)<br /><br />    g =  myCoroutine()<br />    asyn_task(lambda s:g.send(s))<br />    print ("hello")<br />    s = g.await()<br />    print (s)<br /><br /><br />main2()</pre>