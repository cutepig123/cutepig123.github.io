终于搞明白pppoe + NAT 作上网服务器的原理了，哈哈哈。<BR><U><B><BR>rp－PPPoE设置</B></U>：<BR>
<P class=MsoNormal><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: 宋体">检查</SPAN><SPAN lang=EN-US style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana">rppppoe</SPAN><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: 宋体">装上没有（</SPAN><SPAN lang=EN-US style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana">redFlag</SPAN><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: 宋体">已经装上）</SPAN><SPAN lang=EN-US style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana"><?xml:namespace prefix = o /><o:p></P>
<DIV style="BORDER-RIGHT: #cccccc 1px solid; PADDING-RIGHT: 5px; BORDER-TOP: #cccccc 1px solid; PADDING-LEFT: 4px; FONT-SIZE: 13px; PADDING-BOTTOM: 4px; BORDER-LEFT: #cccccc 1px solid; WIDTH: 98%; WORD-BREAK: break-all; PADDING-TOP: 4px; BORDER-BOTTOM: #cccccc 1px solid; BACKGROUND-COLOR: #eeeeee"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top><SPAN style="COLOR: #000000">rpm&nbsp;</SPAN><SPAN style="COLOR: #000000">-</SPAN><SPAN style="COLOR: #000000">qa&nbsp;</SPAN><SPAN style="COLOR: #000000">|</SPAN><SPAN style="COLOR: #000000">&nbsp;grep&nbsp;</SPAN><SPAN style="COLOR: #000000">-</SPAN><SPAN style="COLOR: #000000">i&nbsp;</SPAN><SPAN style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #800000">pppoe</SPAN><SPAN style="COLOR: #800000">"</SPAN></DIV>
<P class=MsoNormal></o:p></SPAN><SPAN lang=EN-US style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Verdana"><BR><SPAN style="BACKGROUND: yellow 0% 50%; moz-background-clip: initial; moz-background-origin: initial; moz-background-inline-policy: initial">/etc/ppp/pap-secrets</SPAN></SPAN><SPAN style="FONT-SIZE: 9pt; BACKGROUND: yellow 0% 50%; COLOR: black; FONT-FAMILY: 宋体; moz-background-clip: initial; moz-background-origin: initial; moz-background-inline-policy: initial">配置如下</SPAN><SPAN style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: 宋体">：</SPAN><SPAN lang=EN-US style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Verdana"><BR></P>
<DIV style="BORDER-RIGHT: #cccccc 1px solid; PADDING-RIGHT: 5px; BORDER-TOP: #cccccc 1px solid; PADDING-LEFT: 4px; FONT-SIZE: 13px; PADDING-BOTTOM: 4px; BORDER-LEFT: #cccccc 1px solid; WIDTH: 98%; WORD-BREAK: break-all; PADDING-TOP: 4px; BORDER-BOTTOM: #cccccc 1px solid; BACKGROUND-COLOR: #eeeeee"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top><SPAN style="COLOR: #008000">#</SPAN><SPAN style="COLOR: #008000">client&nbsp;server&nbsp;secret&nbsp;IP&nbsp;address</SPAN><SPAN style="COLOR: #008000"><BR><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top></SPAN><SPAN style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #800000">usr</SPAN><SPAN style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #000000">*</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #800000">123</SPAN><SPAN style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #000000">*</SPAN></DIV>
<P class=MsoNormal><SPAN style="BACKGROUND: yellow 0% 50%; moz-background-clip: initial; moz-background-origin: initial; moz-background-inline-policy: initial">/etc/ppp/chap-secrets</SPAN></SPAN><SPAN style="FONT-SIZE: 9pt; BACKGROUND: yellow 0% 50%; COLOR: black; FONT-FAMILY: 宋体; moz-background-clip: initial; moz-background-origin: initial; moz-background-inline-policy: initial">的配置和</SPAN><SPAN lang=EN-US style="FONT-SIZE: 9pt; BACKGROUND: yellow 0% 50%; COLOR: black; FONT-FAMILY: Verdana; moz-background-clip: initial; moz-background-origin: initial; moz-background-inline-policy: initial">pap-secrets</SPAN><SPAN style="FONT-SIZE: 9pt; BACKGROUND: yellow 0% 50%; COLOR: black; FONT-FAMILY: 宋体; moz-background-clip: initial; moz-background-origin: initial; moz-background-inline-policy: initial">一样</SPAN><SPAN lang=EN-US style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Verdana"><BR><BR><SPAN style="BACKGROUND: yellow 0% 50%; moz-background-clip: initial; moz-background-origin: initial; moz-background-inline-policy: initial">/etc/ppp/</SPAN></SPAN><STRONG><SPAN lang=EN-US style="FONT-SIZE: 9pt; BACKGROUND: yellow 0% 50%; COLOR: red; FONT-FAMILY: Verdana; moz-background-clip: initial; moz-background-origin: initial; moz-background-inline-policy: initial">pppoe</SPAN></STRONG><SPAN lang=EN-US style="FONT-SIZE: 9pt; BACKGROUND: yellow 0% 50%; COLOR: black; FONT-FAMILY: Verdana; moz-background-clip: initial; moz-background-origin: initial; moz-background-inline-policy: initial">-server-options</SPAN><SPAN style="FONT-SIZE: 9pt; BACKGROUND: yellow 0% 50%; COLOR: black; FONT-FAMILY: 宋体; moz-background-clip: initial; moz-background-origin: initial; moz-background-inline-policy: initial">配置如下</SPAN><SPAN style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: 宋体">：</SPAN><SPAN lang=EN-US style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Verdana"><o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-US style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Verdana"></P>
<DIV style="BORDER-RIGHT: #cccccc 1px solid; PADDING-RIGHT: 5px; BORDER-TOP: #cccccc 1px solid; PADDING-LEFT: 4px; FONT-SIZE: 13px; PADDING-BOTTOM: 4px; BORDER-LEFT: #cccccc 1px solid; WIDTH: 98%; WORD-BREAK: break-all; PADDING-TOP: 4px; BORDER-BOTTOM: #cccccc 1px solid; BACKGROUND-COLOR: #eeeeee"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top><SPAN style="COLOR: #008000">#</SPAN><SPAN style="COLOR: #008000">auth&nbsp;&nbsp;#注释掉这三行使用任意帐号就可以登录</SPAN><SPAN style="COLOR: #008000"><BR><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top>#</SPAN><SPAN style="COLOR: #008000">require-pap</SPAN><SPAN style="COLOR: #008000"><BR><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top>#</SPAN><SPAN style="COLOR: #008000">require-chap</SPAN><SPAN style="COLOR: #008000"><BR><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top></SPAN><SPAN style="COLOR: #000000">login<BR><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top>lcp</SPAN><SPAN style="COLOR: #000000">-</SPAN><SPAN style="COLOR: #000000">echo</SPAN><SPAN style="COLOR: #000000">-</SPAN><SPAN style="COLOR: #000000">interval&nbsp;</SPAN><SPAN style="COLOR: #000000">30</SPAN><SPAN style="COLOR: #000000"><BR><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top>lcp</SPAN><SPAN style="COLOR: #000000">-</SPAN><SPAN style="COLOR: #000000">echo</SPAN><SPAN style="COLOR: #000000">-</SPAN><SPAN style="COLOR: #000000">failure&nbsp;</SPAN><SPAN style="COLOR: #000000">4</SPAN><SPAN style="COLOR: #000000"><BR><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top>ms</SPAN><SPAN style="COLOR: #000000">-</SPAN><SPAN style="COLOR: #000000">dns&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #000000">202.118</SPAN><SPAN style="COLOR: #000000">.</SPAN><SPAN style="COLOR: #000000">224.101</SPAN></DIV>
<P class=MsoNormal><BR><BR></SPAN><SPAN style="FONT-SIZE: 9pt; BACKGROUND: yellow 0% 50%; COLOR: black; FONT-FAMILY: 宋体; moz-background-clip: initial; moz-background-origin: initial; moz-background-inline-policy: initial">然后运行</SPAN><SPAN style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: 宋体">：</SPAN><SPAN lang=EN-US style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Verdana"><BR></SPAN><SPAN lang=EN-US style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Verdana"></P>
<DIV style="BORDER-RIGHT: #cccccc 1px solid; PADDING-RIGHT: 5px; BORDER-TOP: #cccccc 1px solid; PADDING-LEFT: 4px; FONT-SIZE: 13px; PADDING-BOTTOM: 4px; BORDER-LEFT: #cccccc 1px solid; WIDTH: 98%; WORD-BREAK: break-all; PADDING-TOP: 4px; BORDER-BOTTOM: #cccccc 1px solid; BACKGROUND-COLOR: #eeeeee"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top><SPAN style="COLOR: #000000">modprobe&nbsp;pppoe<BR><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top>pppoe</SPAN><SPAN style="COLOR: #000000">-</SPAN><SPAN style="COLOR: #000000">server&nbsp;</SPAN><SPAN style="COLOR: #000000">-</SPAN><SPAN style="COLOR: #000000">I&nbsp;eth1&nbsp;</SPAN><SPAN style="COLOR: #000000">-</SPAN><SPAN style="COLOR: #000000">N&nbsp;</SPAN><SPAN style="COLOR: #000000">200</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #000000">-</SPAN><SPAN style="COLOR: #000000">L&nbsp;</SPAN><SPAN style="COLOR: #000000">192.168</SPAN><SPAN style="COLOR: #000000">.</SPAN><SPAN style="COLOR: #000000">0.1</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #000000">-</SPAN><SPAN style="COLOR: #000000">R&nbsp;</SPAN><SPAN style="COLOR: #000000">192.168</SPAN><SPAN style="COLOR: #000000">.</SPAN><SPAN style="COLOR: #000000">0.100</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #000000">-</SPAN><SPAN style="COLOR: #000000">r&nbsp;</SPAN><SPAN style="COLOR: #000000">-</SPAN><SPAN style="COLOR: #000000">u</SPAN></DIV>
<P class=MsoNormal><BR></SPAN></P>
<P class=MsoNormal><U><B><SPAN lang=EN-US style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Verdana">iptables设置：</SPAN></B></U></P>
<P class=MsoNormal><SPAN style="FONT-SIZE: 10pt; BACKGROUND: yellow 0% 50%; FONT-FAMILY: 宋体; moz-background-clip: initial; moz-background-origin: initial; moz-background-inline-policy: initial">打开</SPAN><SPAN lang=EN-US style="FONT-SIZE: 10pt; BACKGROUND: yellow 0% 50%; FONT-FAMILY: Verdana; moz-background-clip: initial; moz-background-origin: initial; moz-background-inline-policy: initial">ip</SPAN><SPAN style="FONT-SIZE: 10pt; BACKGROUND: yellow 0% 50%; FONT-FAMILY: 宋体; moz-background-clip: initial; moz-background-origin: initial; moz-background-inline-policy: initial">转发和NAT功能</SPAN><BR></P>
<DIV style="BORDER-RIGHT: #cccccc 1px solid; PADDING-RIGHT: 5px; BORDER-TOP: #cccccc 1px solid; PADDING-LEFT: 4px; FONT-SIZE: 13px; PADDING-BOTTOM: 4px; BORDER-LEFT: #cccccc 1px solid; WIDTH: 98%; WORD-BREAK: break-all; PADDING-TOP: 4px; BORDER-BOTTOM: #cccccc 1px solid; BACKGROUND-COLOR: #eeeeee"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top><SPAN style="COLOR: #000000">echo&nbsp;</SPAN><SPAN style="COLOR: #000000">1</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #000000">&gt;</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #000000">/</SPAN><SPAN style="COLOR: #000000">proc</SPAN><SPAN style="COLOR: #000000">/</SPAN><SPAN style="COLOR: #000000">sys</SPAN><SPAN style="COLOR: #000000">/</SPAN><SPAN style="COLOR: #000000">net</SPAN><SPAN style="COLOR: #000000">/</SPAN><SPAN style="COLOR: #000000">ipv4</SPAN><SPAN style="COLOR: #000000">/</SPAN><SPAN style="COLOR: #000000">ip_forward<BR><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top>iptables&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #000000">-</SPAN><SPAN style="COLOR: #000000">t&nbsp;nat&nbsp;</SPAN><SPAN style="COLOR: #000000">-</SPAN><SPAN style="COLOR: #000000">F<BR><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top>iptables&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #000000">-</SPAN><SPAN style="COLOR: #000000">t&nbsp;nat&nbsp;</SPAN><SPAN style="COLOR: #000000">-</SPAN><SPAN style="COLOR: #000000">L<BR><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top>iptables&nbsp;</SPAN><SPAN style="COLOR: #000000">-</SPAN><SPAN style="COLOR: #000000">t&nbsp;nat&nbsp;</SPAN><SPAN style="COLOR: #000000">-</SPAN><SPAN style="COLOR: #000000">A&nbsp;POSTROUTING&nbsp;</SPAN><SPAN style="COLOR: #000000">-</SPAN><SPAN style="COLOR: #000000">o&nbsp;eth0&nbsp;</SPAN><SPAN style="COLOR: #000000">-</SPAN><SPAN style="COLOR: #000000">j&nbsp;SNAT&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #000000">--</SPAN><SPAN style="COLOR: #000000">to&nbsp;</SPAN><SPAN style="COLOR: #000000">219.217</SPAN><SPAN style="COLOR: #000000">.</SPAN><SPAN style="COLOR: #000000">235.73</SPAN><SPAN style="COLOR: #000000"><BR><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top></SPAN><SPAN style="COLOR: #008000">#</SPAN><SPAN style="COLOR: #008000">iptables&nbsp;-t&nbsp;nat&nbsp;-A&nbsp;POSTROUTING&nbsp;-o&nbsp;eth0&nbsp;-j&nbsp;SNAT&nbsp;-s&nbsp;192.168.0.0/24&nbsp;--to&nbsp;219.217.235.73</SPAN><SPAN style="COLOR: #008000"><BR><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top></SPAN></DIV>
<P class=MsoNormal><BR>pppoe-server -I <U>eth1</U>&nbsp; -r -u<BR><SPAN lang=EN-US style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Verdana"><o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: 宋体">用</SPAN><SPAN lang=EN-US style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Verdana">xp</SPAN><SPAN style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: 宋体">连接就可以了</SPAN><SPAN lang=EN-US style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Verdana"><o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-US><o:p><U><B>注意：</B></U><BR></o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-US><o:p>为了防止局域网内用户设置ip和eth1一致，从而达到间接上网的目的，必须将eth1的ip设置为空！<BR>我猜测<BR>用NAT上网时，客户设置好ip和网关为eth1后，发给服务器的连接会被iptables识别并路由过去。<BR>用pppoe设置好后，客户如果没有建立pppoe连接，</o:p></SPAN><SPAN lang=EN-US>发给服务器的数据报会被过虑到,iptables识别不了。<BR>而建立连接后，</SPAN><SPAN lang=EN-US>iptables识别就能识别出他来了。<BR>具体是怎么实现的有待研究。<BR></SPAN></P>