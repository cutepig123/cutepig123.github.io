今晚突然想写一个matlab的，基于SAD的区域法立体匹配方法。<BR>下面以并列出matlab和c++版本的代码及实验结果。<BR>MATLAB版本：<BR>有个地方36~42行应该还能优化，只是我没找到相应的函数,这个地方运行很慢<BR><BR>
<DIV style="BORDER-RIGHT: #cccccc 1px solid; PADDING-RIGHT: 5px; BORDER-TOP: #cccccc 1px solid; PADDING-LEFT: 4px; FONT-SIZE: 13px; PADDING-BOTTOM: 4px; BORDER-LEFT: #cccccc 1px solid; WIDTH: 98%; WORD-BREAK: break-all; PADDING-TOP: 4px; BORDER-BOTTOM: #cccccc 1px solid; BACKGROUND-COLOR: #eeeeee"><SPAN style="COLOR: #008080">&nbsp;1</SPAN><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top><SPAN style="COLOR: #000000">%</SPAN><SPAN style="COLOR: #000000">function&nbsp;SADMatch<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;2</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top>clear,clc<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;3</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top>tic<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;4</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top></SPAN><SPAN style="COLOR: #000000">%</SPAN><SPAN style="COLOR: #000000">im1</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">imread(</SPAN><SPAN style="COLOR: #000000">'</SPAN><SPAN style="COLOR: #000000">Test_left.jpg</SPAN><SPAN style="COLOR: #000000">'</SPAN><SPAN style="COLOR: #000000">);<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;5</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top></SPAN><SPAN style="COLOR: #000000">%</SPAN><SPAN style="COLOR: #000000">im2</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">imread(</SPAN><SPAN style="COLOR: #000000">'</SPAN><SPAN style="COLOR: #000000">Test_right.jpg</SPAN><SPAN style="COLOR: #000000">'</SPAN><SPAN style="COLOR: #000000">);<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;6</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top></SPAN><SPAN style="COLOR: #000000">%</SPAN><SPAN style="COLOR: #000000">&nbsp;im1</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">imread(</SPAN><SPAN style="COLOR: #000000">'</SPAN><SPAN style="COLOR: #000000">im0.jpg</SPAN><SPAN style="COLOR: #000000">'</SPAN><SPAN style="COLOR: #000000">);<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;7</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top></SPAN><SPAN style="COLOR: #000000">%</SPAN><SPAN style="COLOR: #000000">&nbsp;im2</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">imread(</SPAN><SPAN style="COLOR: #000000">'</SPAN><SPAN style="COLOR: #000000">im1.jpg</SPAN><SPAN style="COLOR: #000000">'</SPAN><SPAN style="COLOR: #000000">);<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;8</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top>im1</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">imread(</SPAN><SPAN style="COLOR: #000000">'</SPAN><SPAN style="COLOR: #000000">left.BMP</SPAN><SPAN style="COLOR: #000000">'</SPAN><SPAN style="COLOR: #000000">);<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;9</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top>im2</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">imread(</SPAN><SPAN style="COLOR: #000000">'</SPAN><SPAN style="COLOR: #000000">right.BMP</SPAN><SPAN style="COLOR: #000000">'</SPAN><SPAN style="COLOR: #000000">);<BR></SPAN><SPAN style="COLOR: #008080">10</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top><BR></SPAN><SPAN style="COLOR: #008080">11</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top><BR></SPAN><SPAN style="COLOR: #008080">12</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top></SPAN><SPAN style="COLOR: #0000ff">if</SPAN><SPAN style="COLOR: #000000">&nbsp;isrgb(im1)<BR></SPAN><SPAN style="COLOR: #008080">13</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;im1</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">rgb2gray(im1);<BR></SPAN><SPAN style="COLOR: #008080">14</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top>end<BR></SPAN><SPAN style="COLOR: #008080">15</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top></SPAN><SPAN style="COLOR: #000000">%</SPAN><SPAN style="COLOR: #000000">imshow(im1);<BR></SPAN><SPAN style="COLOR: #008080">16</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top>im1</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #0000ff">double</SPAN><SPAN style="COLOR: #000000">(im1);<BR></SPAN><SPAN style="COLOR: #008080">17</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top><BR></SPAN><SPAN style="COLOR: #008080">18</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top></SPAN><SPAN style="COLOR: #0000ff">if</SPAN><SPAN style="COLOR: #000000">&nbsp;isrgb(im2)<BR></SPAN><SPAN style="COLOR: #008080">19</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;im2</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">rgb2gray(im2);<BR></SPAN><SPAN style="COLOR: #008080">20</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top>end<BR></SPAN><SPAN style="COLOR: #008080">21</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top></SPAN><SPAN style="COLOR: #000000">%</SPAN><SPAN style="COLOR: #000000">figure<BR></SPAN><SPAN style="COLOR: #008080">22</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top></SPAN><SPAN style="COLOR: #000000">%</SPAN><SPAN style="COLOR: #000000">imshow(im2);<BR></SPAN><SPAN style="COLOR: #008080">23</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top>im2</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #0000ff">double</SPAN><SPAN style="COLOR: #000000">(im2);<BR></SPAN><SPAN style="COLOR: #008080">24</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top><BR></SPAN><SPAN style="COLOR: #008080">25</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top>D</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">20</SPAN><SPAN style="COLOR: #000000">;&nbsp;</SPAN><SPAN style="COLOR: #000000">%</SPAN><SPAN style="COLOR: #000000">最大视差<BR></SPAN><SPAN style="COLOR: #008080">26</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top>N</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">5</SPAN><SPAN style="COLOR: #000000">;&nbsp;</SPAN><SPAN style="COLOR: #000000">%</SPAN><SPAN style="COLOR: #000000">窗口大小的一半<BR></SPAN><SPAN style="COLOR: #008080">27</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top>[H,W]</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">size(im1);<BR></SPAN><SPAN style="COLOR: #008080">28</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top><BR></SPAN><SPAN style="COLOR: #008080">29</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top></SPAN><SPAN style="COLOR: #000000">%</SPAN><SPAN style="COLOR: #000000">计算右图减去左图，相减产生D个矩阵放到imgDiff中&nbsp;<BR></SPAN><SPAN style="COLOR: #008080">30</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top>imgDiff</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">zeros(H,W,D);<BR></SPAN><SPAN style="COLOR: #008080">31</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top>e</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">zeros(H,W);<BR></SPAN><SPAN style="COLOR: #008080">32</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top></SPAN><SPAN style="COLOR: #0000ff">for</SPAN><SPAN style="COLOR: #000000">&nbsp;i</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">1</SPAN><SPAN style="COLOR: #000000">:D<BR></SPAN><SPAN style="COLOR: #008080">33</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;fprintf(</SPAN><SPAN style="COLOR: #000000">'</SPAN><SPAN style="COLOR: #000000">%g\n</SPAN><SPAN style="COLOR: #000000">'</SPAN><SPAN style="COLOR: #000000">,i)<BR></SPAN><SPAN style="COLOR: #008080">34</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;e(:,</SPAN><SPAN style="COLOR: #000000">1</SPAN><SPAN style="COLOR: #000000">:(W</SPAN><SPAN style="COLOR: #000000">-</SPAN><SPAN style="COLOR: #000000">i))</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">abs(im2(:,</SPAN><SPAN style="COLOR: #000000">1</SPAN><SPAN style="COLOR: #000000">:(W</SPAN><SPAN style="COLOR: #000000">-</SPAN><SPAN style="COLOR: #000000">i))</SPAN><SPAN style="COLOR: #000000">-</SPAN><SPAN style="COLOR: #000000">&nbsp;im1(:,(i</SPAN><SPAN style="COLOR: #000000">+</SPAN><SPAN style="COLOR: #000000">1</SPAN><SPAN style="COLOR: #000000">):W));<BR></SPAN><SPAN style="COLOR: #008080">35</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #000000">%</SPAN><SPAN style="COLOR: #000000">e</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">conv2(e,e,</SPAN><SPAN style="COLOR: #000000">'</SPAN><SPAN style="COLOR: #000000">same</SPAN><SPAN style="COLOR: #000000">'</SPAN><SPAN style="COLOR: #000000">);<BR></SPAN><SPAN style="COLOR: #008080">36</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;e2</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">zeros(H,W);</SPAN><SPAN style="COLOR: #000000">%</SPAN><SPAN style="COLOR: #000000">计算窗口内的和<BR></SPAN><SPAN style="COLOR: #008080">37</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #0000ff">for</SPAN><SPAN style="COLOR: #000000">&nbsp;y</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">(N</SPAN><SPAN style="COLOR: #000000">+</SPAN><SPAN style="COLOR: #000000">1</SPAN><SPAN style="COLOR: #000000">):(H</SPAN><SPAN style="COLOR: #000000">-</SPAN><SPAN style="COLOR: #000000">N)<BR></SPAN><SPAN style="COLOR: #008080">38</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #0000ff">for</SPAN><SPAN style="COLOR: #000000">&nbsp;x</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">(N</SPAN><SPAN style="COLOR: #000000">+</SPAN><SPAN style="COLOR: #000000">1</SPAN><SPAN style="COLOR: #000000">):(W</SPAN><SPAN style="COLOR: #000000">-</SPAN><SPAN style="COLOR: #000000">N)<BR></SPAN><SPAN style="COLOR: #008080">39</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e2(y,x)</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">sum(sum(e((y</SPAN><SPAN style="COLOR: #000000">-</SPAN><SPAN style="COLOR: #000000">N):(y</SPAN><SPAN style="COLOR: #000000">+</SPAN><SPAN style="COLOR: #000000">N),(x</SPAN><SPAN style="COLOR: #000000">-</SPAN><SPAN style="COLOR: #000000">N):(x</SPAN><SPAN style="COLOR: #000000">+</SPAN><SPAN style="COLOR: #000000">N))));<BR></SPAN><SPAN style="COLOR: #008080">40</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end<BR></SPAN><SPAN style="COLOR: #008080">41</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;end<BR></SPAN><SPAN style="COLOR: #008080">42</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;imgDiff(:,:,i)</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">e2;<BR></SPAN><SPAN style="COLOR: #008080">43</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top>end<BR></SPAN><SPAN style="COLOR: #008080">44</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top><BR></SPAN><SPAN style="COLOR: #008080">45</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top></SPAN><SPAN style="COLOR: #000000">%</SPAN><SPAN style="COLOR: #000000">找到最小的视差，到dispMap<BR></SPAN><SPAN style="COLOR: #008080">46</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top>dispMap</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">zeros(H,W);<BR></SPAN><SPAN style="COLOR: #008080">47</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top></SPAN><SPAN style="COLOR: #0000ff">for</SPAN><SPAN style="COLOR: #000000">&nbsp;x</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">1</SPAN><SPAN style="COLOR: #000000">:W<BR></SPAN><SPAN style="COLOR: #008080">48</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #0000ff">for</SPAN><SPAN style="COLOR: #000000">&nbsp;y</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">1</SPAN><SPAN style="COLOR: #000000">:H<BR></SPAN><SPAN style="COLOR: #008080">49</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #000000">%</SPAN><SPAN style="COLOR: #000000">[val,id]</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">min(imgDiff(y,x,:));<BR></SPAN><SPAN style="COLOR: #008080">50</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[val,id]</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">sort(imgDiff(y,x,:));<BR></SPAN><SPAN style="COLOR: #008080">51</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #0000ff">if</SPAN><SPAN style="COLOR: #000000">&nbsp;abs(val(</SPAN><SPAN style="COLOR: #000000">1</SPAN><SPAN style="COLOR: #000000">)</SPAN><SPAN style="COLOR: #000000">-</SPAN><SPAN style="COLOR: #000000">val(</SPAN><SPAN style="COLOR: #000000">2</SPAN><SPAN style="COLOR: #000000">))</SPAN><SPAN style="COLOR: #000000">&gt;</SPAN><SPAN style="COLOR: #000000">10</SPAN><SPAN style="COLOR: #000000"><BR></SPAN><SPAN style="COLOR: #008080">52</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dispMap(y,x)</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">id(</SPAN><SPAN style="COLOR: #000000">1</SPAN><SPAN style="COLOR: #000000">);<BR></SPAN><SPAN style="COLOR: #008080">53</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end<BR></SPAN><SPAN style="COLOR: #008080">54</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;end<BR></SPAN><SPAN style="COLOR: #008080">55</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top>end<BR></SPAN><SPAN style="COLOR: #008080">56</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top>dispMap</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">dispMap</SPAN><SPAN style="COLOR: #000000">*</SPAN><SPAN style="COLOR: #000000">200</SPAN><SPAN style="COLOR: #000000">/</SPAN><SPAN style="COLOR: #000000">D;<BR></SPAN><SPAN style="COLOR: #008080">57</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top>dispMap</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">uint8(dispMap);<BR></SPAN><SPAN style="COLOR: #008080">58</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top>toc<BR></SPAN><SPAN style="COLOR: #008080">59</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top>imshow(dispMap)<BR></SPAN><SPAN style="COLOR: #008080">60</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top></SPAN><SPAN style="COLOR: #000000">%</SPAN><SPAN style="COLOR: #000000">imwrite(dispMap,</SPAN><SPAN style="COLOR: #000000">'</SPAN><SPAN style="COLOR: #000000">dispMap.jpg</SPAN><SPAN style="COLOR: #000000">'</SPAN><SPAN style="COLOR: #000000">)</SPAN></DIV>c版本：<BR>加入了crosscheck功能<BR><BR>
<DIV style="BORDER-RIGHT: #cccccc 1px solid; PADDING-RIGHT: 5px; BORDER-TOP: #cccccc 1px solid; PADDING-LEFT: 4px; FONT-SIZE: 13px; PADDING-BOTTOM: 4px; BORDER-LEFT: #cccccc 1px solid; WIDTH: 98%; WORD-BREAK: break-all; PADDING-TOP: 4px; BORDER-BOTTOM: #cccccc 1px solid; BACKGROUND-COLOR: #eeeeee"><SPAN style="COLOR: #008080">&nbsp;&nbsp;1</SPAN><IMG id=Codehighlighter1_0_234_Open_Image onclick="this.style.display='none'; Codehighlighter1_0_234_Open_Text.style.display='none'; Codehighlighter1_0_234_Closed_Image.style.display='inline'; Codehighlighter1_0_234_Closed_Text.style.display='inline';" src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedBlockStart.gif" align=top><IMG id=Codehighlighter1_0_234_Closed_Image style="DISPLAY: none" onclick="this.style.display='none'; Codehighlighter1_0_234_Closed_Text.style.display='none'; Codehighlighter1_0_234_Open_Image.style.display='inline'; Codehighlighter1_0_234_Open_Text.style.display='inline';" src="https://www.cnblogs.com/images/OutliningIndicators/ContractedBlock.gif" align=top><SPAN id=Codehighlighter1_0_234_Closed_Text style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</SPAN><SPAN id=Codehighlighter1_0_234_Open_Text><SPAN style="COLOR: #008000">/*</SPAN><SPAN style="COLOR: #008000">***********************************************************************<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;&nbsp;2</SPAN><SPAN style="COLOR: #008000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>功能：SAD匹配<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;&nbsp;3</SPAN><SPAN style="COLOR: #008000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>输入：用图像image1的(x1,y12)和image2的（x2,y12）处建立大小为2*windowSize大小的窗口计算SAD误差并返回<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;&nbsp;4</SPAN><SPAN style="COLOR: #008000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>图像必须为灰度<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;&nbsp;5</SPAN><SPAN style="COLOR: #008000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedBlockEnd.gif" align=top>***********************************************************************</SPAN><SPAN style="COLOR: #008000">*/</SPAN></SPAN><SPAN style="COLOR: #000000"><BR></SPAN><SPAN style="COLOR: #008080">&nbsp;&nbsp;6</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top></SPAN><SPAN style="COLOR: #0000ff">int</SPAN><SPAN style="COLOR: #000000">&nbsp;SAD(IplImage&nbsp;</SPAN><SPAN style="COLOR: #000000">*</SPAN><SPAN style="COLOR: #000000">image1,IplImage</SPAN><SPAN style="COLOR: #000000">*</SPAN><SPAN style="COLOR: #000000">image2,</SPAN><SPAN style="COLOR: #0000ff">int</SPAN><SPAN style="COLOR: #000000">&nbsp;x1,</SPAN><SPAN style="COLOR: #0000ff">int</SPAN><SPAN style="COLOR: #000000">&nbsp;x2,</SPAN><SPAN style="COLOR: #0000ff">int</SPAN><SPAN style="COLOR: #000000">&nbsp;y12,</SPAN><SPAN style="COLOR: #0000ff">int</SPAN><SPAN style="COLOR: #000000">&nbsp;WindowSize)<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;&nbsp;7</SPAN><SPAN style="COLOR: #000000"><IMG id=Codehighlighter1_315_843_Open_Image onclick="this.style.display='none'; Codehighlighter1_315_843_Open_Text.style.display='none'; Codehighlighter1_315_843_Closed_Image.style.display='inline'; Codehighlighter1_315_843_Closed_Text.style.display='inline';" src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedBlockStart.gif" align=top><IMG id=Codehighlighter1_315_843_Closed_Image style="DISPLAY: none" onclick="this.style.display='none'; Codehighlighter1_315_843_Closed_Text.style.display='none'; Codehighlighter1_315_843_Open_Image.style.display='inline'; Codehighlighter1_315_843_Open_Text.style.display='inline';" src="https://www.cnblogs.com/images/OutliningIndicators/ContractedBlock.gif" align=top></SPAN><SPAN id=Codehighlighter1_315_843_Closed_Text style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG src="https://www.cnblogs.com/images/dot.gif"></SPAN><SPAN id=Codehighlighter1_315_843_Open_Text><SPAN style="COLOR: #000000">{<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;&nbsp;8</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #008000">//</SPAN><SPAN style="COLOR: #008000">H_CHECK(CV_ARE_SIZES_EQ(image1,image2));</SPAN><SPAN style="COLOR: #008000"><BR></SPAN><SPAN style="COLOR: #008080">&nbsp;&nbsp;9</SPAN><SPAN style="COLOR: #008000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top></SPAN><SPAN style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #0000ff">int</SPAN><SPAN style="COLOR: #000000">&nbsp;W</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">image1</SPAN><SPAN style="COLOR: #000000">-&gt;</SPAN><SPAN style="COLOR: #000000">width,H</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">image1</SPAN><SPAN style="COLOR: #000000">-&gt;</SPAN><SPAN style="COLOR: #000000">height;<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;10</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top></SPAN><SPAN style="COLOR: #008000">//</SPAN><SPAN style="COLOR: #008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;H_CHECK(x1&gt;=WindowSize&nbsp;&amp;&amp;&nbsp;x1&lt;W-WindowSize<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;11</SPAN><SPAN style="COLOR: #008000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top></SPAN><SPAN style="COLOR: #008000">//</SPAN><SPAN style="COLOR: #008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;x2&gt;=WindowSize&nbsp;&amp;&amp;&nbsp;x2&lt;W-WindowSize<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;12</SPAN><SPAN style="COLOR: #008000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top></SPAN><SPAN style="COLOR: #008000">//</SPAN><SPAN style="COLOR: #008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;y12&gt;=WindowSize&nbsp;&amp;&amp;&nbsp;y12&lt;H-WindowSize<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;13</SPAN><SPAN style="COLOR: #008000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top></SPAN><SPAN style="COLOR: #008000">//</SPAN><SPAN style="COLOR: #008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</SPAN><SPAN style="COLOR: #008000"><BR></SPAN><SPAN style="COLOR: #008080">&nbsp;14</SPAN><SPAN style="COLOR: #008000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top></SPAN><SPAN style="COLOR: #000000"><BR></SPAN><SPAN style="COLOR: #008080">&nbsp;15</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #0000ff">int</SPAN><SPAN style="COLOR: #000000">&nbsp;dx,dy;<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;16</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #0000ff">int</SPAN><SPAN style="COLOR: #000000">&nbsp;sum</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">0</SPAN><SPAN style="COLOR: #000000">;<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;17</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #0000ff">for</SPAN><SPAN style="COLOR: #000000">&nbsp;(dy</SPAN><SPAN style="COLOR: #000000">=-</SPAN><SPAN style="COLOR: #000000">WindowSize;dy</SPAN><SPAN style="COLOR: #000000">&lt;=</SPAN><SPAN style="COLOR: #000000">WindowSize;dy</SPAN><SPAN style="COLOR: #000000">++</SPAN><SPAN style="COLOR: #000000">)<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;18</SPAN><SPAN style="COLOR: #000000"><IMG id=Codehighlighter1_609_827_Open_Image onclick="this.style.display='none'; Codehighlighter1_609_827_Open_Text.style.display='none'; Codehighlighter1_609_827_Closed_Image.style.display='inline'; Codehighlighter1_609_827_Closed_Text.style.display='inline';" src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif" align=top><IMG id=Codehighlighter1_609_827_Closed_Image style="DISPLAY: none" onclick="this.style.display='none'; Codehighlighter1_609_827_Closed_Text.style.display='none'; Codehighlighter1_609_827_Open_Image.style.display='inline'; Codehighlighter1_609_827_Open_Text.style.display='inline';" src="https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN id=Codehighlighter1_609_827_Closed_Text style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG src="https://www.cnblogs.com/images/dot.gif"></SPAN><SPAN id=Codehighlighter1_609_827_Open_Text><SPAN style="COLOR: #000000">{<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;19</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LPBYTE&nbsp;p1</SPAN><SPAN style="COLOR: #000000">=&amp;</SPAN><SPAN style="COLOR: #000000">CV_IMAGE_ELEM(image1,BYTE,y12</SPAN><SPAN style="COLOR: #000000">+</SPAN><SPAN style="COLOR: #000000">dy,x1</SPAN><SPAN style="COLOR: #000000">-</SPAN><SPAN style="COLOR: #000000">WindowSize);<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;20</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LPBYTE&nbsp;p2</SPAN><SPAN style="COLOR: #000000">=&amp;</SPAN><SPAN style="COLOR: #000000">CV_IMAGE_ELEM(image2,BYTE,y12</SPAN><SPAN style="COLOR: #000000">+</SPAN><SPAN style="COLOR: #000000">dy,x2</SPAN><SPAN style="COLOR: #000000">-</SPAN><SPAN style="COLOR: #000000">WindowSize);<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;21</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #0000ff">for</SPAN><SPAN style="COLOR: #000000">&nbsp;(dx</SPAN><SPAN style="COLOR: #000000">=-</SPAN><SPAN style="COLOR: #000000">WindowSize;dx</SPAN><SPAN style="COLOR: #000000">&lt;=</SPAN><SPAN style="COLOR: #000000">WindowSize;dx</SPAN><SPAN style="COLOR: #000000">++</SPAN><SPAN style="COLOR: #000000">)<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;22</SPAN><SPAN style="COLOR: #000000"><IMG id=Codehighlighter1_780_824_Open_Image onclick="this.style.display='none'; Codehighlighter1_780_824_Open_Text.style.display='none'; Codehighlighter1_780_824_Closed_Image.style.display='inline'; Codehighlighter1_780_824_Closed_Text.style.display='inline';" src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif" align=top><IMG id=Codehighlighter1_780_824_Closed_Image style="DISPLAY: none" onclick="this.style.display='none'; Codehighlighter1_780_824_Closed_Text.style.display='none'; Codehighlighter1_780_824_Open_Image.style.display='inline'; Codehighlighter1_780_824_Open_Text.style.display='inline';" src="https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN id=Codehighlighter1_780_824_Closed_Text style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG src="https://www.cnblogs.com/images/dot.gif"></SPAN><SPAN id=Codehighlighter1_780_824_Open_Text><SPAN style="COLOR: #000000">{<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;23</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sum</SPAN><SPAN style="COLOR: #000000">+=</SPAN><SPAN style="COLOR: #000000">abs(</SPAN><SPAN style="COLOR: #000000">*</SPAN><SPAN style="COLOR: #000000">p1</SPAN><SPAN style="COLOR: #000000">-*</SPAN><SPAN style="COLOR: #000000">p2);<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;24</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p1</SPAN><SPAN style="COLOR: #000000">++</SPAN><SPAN style="COLOR: #000000">;<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;25</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p2</SPAN><SPAN style="COLOR: #000000">++</SPAN><SPAN style="COLOR: #000000">;<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;26</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN style="COLOR: #000000"><BR></SPAN><SPAN style="COLOR: #008080">&nbsp;27</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN style="COLOR: #000000"><BR></SPAN><SPAN style="COLOR: #008080">&nbsp;28</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top><BR></SPAN><SPAN style="COLOR: #008080">&nbsp;29</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #0000ff">return</SPAN><SPAN style="COLOR: #000000">&nbsp;sum;<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;30</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedBlockEnd.gif" align=top>}</SPAN></SPAN><SPAN style="COLOR: #000000"><BR></SPAN><SPAN style="COLOR: #008080">&nbsp;31</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top></SPAN><SPAN style="COLOR: #0000ff">int</SPAN><SPAN style="COLOR: #000000">&nbsp;GetDisparitySAD(IplImage&nbsp;</SPAN><SPAN style="COLOR: #000000">*</SPAN><SPAN style="COLOR: #000000">image1,IplImage</SPAN><SPAN style="COLOR: #000000">*</SPAN><SPAN style="COLOR: #000000">image2,</SPAN><SPAN style="COLOR: #0000ff">int</SPAN><SPAN style="COLOR: #000000">&nbsp;x,</SPAN><SPAN style="COLOR: #0000ff">int</SPAN><SPAN style="COLOR: #000000">&nbsp;y,</SPAN><SPAN style="COLOR: #0000ff">int</SPAN><SPAN style="COLOR: #000000">&nbsp;WindowSize,</SPAN><SPAN style="COLOR: #0000ff">int</SPAN><SPAN style="COLOR: #000000">&nbsp;maxDX)<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;32</SPAN><SPAN style="COLOR: #000000"><IMG id=Codehighlighter1_936_1207_Open_Image onclick="this.style.display='none'; Codehighlighter1_936_1207_Open_Text.style.display='none'; Codehighlighter1_936_1207_Closed_Image.style.display='inline'; Codehighlighter1_936_1207_Closed_Text.style.display='inline';" src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedBlockStart.gif" align=top><IMG id=Codehighlighter1_936_1207_Closed_Image style="DISPLAY: none" onclick="this.style.display='none'; Codehighlighter1_936_1207_Closed_Text.style.display='none'; Codehighlighter1_936_1207_Open_Image.style.display='inline'; Codehighlighter1_936_1207_Open_Text.style.display='inline';" src="https://www.cnblogs.com/images/OutliningIndicators/ContractedBlock.gif" align=top></SPAN><SPAN id=Codehighlighter1_936_1207_Closed_Text style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG src="https://www.cnblogs.com/images/dot.gif"></SPAN><SPAN id=Codehighlighter1_936_1207_Open_Text><SPAN style="COLOR: #000000">{<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;33</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #008000">//</SPAN><SPAN style="COLOR: #008000">H_CHECK(x-maxDX-WindowSize&nbsp;&gt;=0&nbsp;&amp;&amp;&nbsp;x+WindowSize&lt;image1-&gt;width&nbsp;);</SPAN><SPAN style="COLOR: #008000"><BR></SPAN><SPAN style="COLOR: #008080">&nbsp;34</SPAN><SPAN style="COLOR: #008000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top></SPAN><SPAN style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #0000ff">int</SPAN><SPAN style="COLOR: #000000">&nbsp;x2,i;<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;35</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #0000ff">int</SPAN><SPAN style="COLOR: #000000">&nbsp;sadMin</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">99999</SPAN><SPAN style="COLOR: #000000">,dispBest</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">0</SPAN><SPAN style="COLOR: #000000">;<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;36</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #0000ff">for</SPAN><SPAN style="COLOR: #000000">(i</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">1</SPAN><SPAN style="COLOR: #000000">;i</SPAN><SPAN style="COLOR: #000000">&lt;</SPAN><SPAN style="COLOR: #000000">maxDX;i</SPAN><SPAN style="COLOR: #000000">++</SPAN><SPAN style="COLOR: #000000">)<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;37</SPAN><SPAN style="COLOR: #000000"><IMG id=Codehighlighter1_1069_1186_Open_Image onclick="this.style.display='none'; Codehighlighter1_1069_1186_Open_Text.style.display='none'; Codehighlighter1_1069_1186_Closed_Image.style.display='inline'; Codehighlighter1_1069_1186_Closed_Text.style.display='inline';" src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif" align=top><IMG id=Codehighlighter1_1069_1186_Closed_Image style="DISPLAY: none" onclick="this.style.display='none'; Codehighlighter1_1069_1186_Closed_Text.style.display='none'; Codehighlighter1_1069_1186_Open_Image.style.display='inline'; Codehighlighter1_1069_1186_Open_Text.style.display='inline';" src="https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN id=Codehighlighter1_1069_1186_Closed_Text style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG src="https://www.cnblogs.com/images/dot.gif"></SPAN><SPAN id=Codehighlighter1_1069_1186_Open_Text><SPAN style="COLOR: #000000">{<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;38</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x2</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">x</SPAN><SPAN style="COLOR: #000000">-</SPAN><SPAN style="COLOR: #000000">i;<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;39</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #0000ff">int</SPAN><SPAN style="COLOR: #000000">&nbsp;sad</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">SAD(image1,image2,x,x2,y,WindowSize);<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;40</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #0000ff">if</SPAN><SPAN style="COLOR: #000000">(sadMin&nbsp;</SPAN><SPAN style="COLOR: #000000">&gt;</SPAN><SPAN style="COLOR: #000000">sad)<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;41</SPAN><SPAN style="COLOR: #000000"><IMG id=Codehighlighter1_1149_1183_Open_Image onclick="this.style.display='none'; Codehighlighter1_1149_1183_Open_Text.style.display='none'; Codehighlighter1_1149_1183_Closed_Image.style.display='inline'; Codehighlighter1_1149_1183_Closed_Text.style.display='inline';" src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif" align=top><IMG id=Codehighlighter1_1149_1183_Closed_Image style="DISPLAY: none" onclick="this.style.display='none'; Codehighlighter1_1149_1183_Closed_Text.style.display='none'; Codehighlighter1_1149_1183_Open_Image.style.display='inline'; Codehighlighter1_1149_1183_Open_Text.style.display='inline';" src="https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN id=Codehighlighter1_1149_1183_Closed_Text style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG src="https://www.cnblogs.com/images/dot.gif"></SPAN><SPAN id=Codehighlighter1_1149_1183_Open_Text><SPAN style="COLOR: #000000">{<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;42</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sadMin</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">sad;<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;43</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dispBest</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">i;<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;44</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN style="COLOR: #000000"><BR></SPAN><SPAN style="COLOR: #008080">&nbsp;45</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN style="COLOR: #000000"><BR></SPAN><SPAN style="COLOR: #008080">&nbsp;46</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top><BR></SPAN><SPAN style="COLOR: #008080">&nbsp;47</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #0000ff">return</SPAN><SPAN style="COLOR: #000000">&nbsp;dispBest;<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;48</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedBlockEnd.gif" align=top>}</SPAN></SPAN><SPAN style="COLOR: #000000"><BR></SPAN><SPAN style="COLOR: #008080">&nbsp;49</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top></SPAN><SPAN style="COLOR: #008000">//</SPAN><SPAN style="COLOR: #008000">反相匹配</SPAN><SPAN style="COLOR: #008000"><BR></SPAN><SPAN style="COLOR: #008080">&nbsp;50</SPAN><SPAN style="COLOR: #008000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top></SPAN><SPAN style="COLOR: #0000ff">int</SPAN><SPAN style="COLOR: #000000">&nbsp;GetDisparitySAD_Reverse(IplImage&nbsp;</SPAN><SPAN style="COLOR: #000000">*</SPAN><SPAN style="COLOR: #000000">image1,IplImage</SPAN><SPAN style="COLOR: #000000">*</SPAN><SPAN style="COLOR: #000000">image2,</SPAN><SPAN style="COLOR: #0000ff">int</SPAN><SPAN style="COLOR: #000000">&nbsp;xr,</SPAN><SPAN style="COLOR: #0000ff">int</SPAN><SPAN style="COLOR: #000000">&nbsp;y,</SPAN><SPAN style="COLOR: #0000ff">int</SPAN><SPAN style="COLOR: #000000">&nbsp;WindowSize,</SPAN><SPAN style="COLOR: #0000ff">int</SPAN><SPAN style="COLOR: #000000">&nbsp;maxDX)<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;51</SPAN><SPAN style="COLOR: #000000"><IMG id=Codehighlighter1_1316_1589_Open_Image onclick="this.style.display='none'; Codehighlighter1_1316_1589_Open_Text.style.display='none'; Codehighlighter1_1316_1589_Closed_Image.style.display='inline'; Codehighlighter1_1316_1589_Closed_Text.style.display='inline';" src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedBlockStart.gif" align=top><IMG id=Codehighlighter1_1316_1589_Closed_Image style="DISPLAY: none" onclick="this.style.display='none'; Codehighlighter1_1316_1589_Closed_Text.style.display='none'; Codehighlighter1_1316_1589_Open_Image.style.display='inline'; Codehighlighter1_1316_1589_Open_Text.style.display='inline';" src="https://www.cnblogs.com/images/OutliningIndicators/ContractedBlock.gif" align=top></SPAN><SPAN id=Codehighlighter1_1316_1589_Closed_Text style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG src="https://www.cnblogs.com/images/dot.gif"></SPAN><SPAN id=Codehighlighter1_1316_1589_Open_Text><SPAN style="COLOR: #000000">{<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;52</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #008000">//</SPAN><SPAN style="COLOR: #008000">H_CHECK(x-maxDX-WindowSize&nbsp;&gt;=0&nbsp;&amp;&amp;&nbsp;x+WindowSize&lt;image1-&gt;width&nbsp;);</SPAN><SPAN style="COLOR: #008000"><BR></SPAN><SPAN style="COLOR: #008080">&nbsp;53</SPAN><SPAN style="COLOR: #008000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top></SPAN><SPAN style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #0000ff">int</SPAN><SPAN style="COLOR: #000000">&nbsp;xl,i;<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;54</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #0000ff">int</SPAN><SPAN style="COLOR: #000000">&nbsp;sadMin</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">99999</SPAN><SPAN style="COLOR: #000000">,dispBest</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">0</SPAN><SPAN style="COLOR: #000000">;<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;55</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #0000ff">for</SPAN><SPAN style="COLOR: #000000">(i</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">1</SPAN><SPAN style="COLOR: #000000">;i</SPAN><SPAN style="COLOR: #000000">&lt;</SPAN><SPAN style="COLOR: #000000">maxDX;i</SPAN><SPAN style="COLOR: #000000">++</SPAN><SPAN style="COLOR: #000000">)<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;56</SPAN><SPAN style="COLOR: #000000"><IMG id=Codehighlighter1_1449_1568_Open_Image onclick="this.style.display='none'; Codehighlighter1_1449_1568_Open_Text.style.display='none'; Codehighlighter1_1449_1568_Closed_Image.style.display='inline'; Codehighlighter1_1449_1568_Closed_Text.style.display='inline';" src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif" align=top><IMG id=Codehighlighter1_1449_1568_Closed_Image style="DISPLAY: none" onclick="this.style.display='none'; Codehighlighter1_1449_1568_Closed_Text.style.display='none'; Codehighlighter1_1449_1568_Open_Image.style.display='inline'; Codehighlighter1_1449_1568_Open_Text.style.display='inline';" src="https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN id=Codehighlighter1_1449_1568_Closed_Text style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG src="https://www.cnblogs.com/images/dot.gif"></SPAN><SPAN id=Codehighlighter1_1449_1568_Open_Text><SPAN style="COLOR: #000000">{<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;57</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xl</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">xr</SPAN><SPAN style="COLOR: #000000">+</SPAN><SPAN style="COLOR: #000000">i;<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;58</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #0000ff">int</SPAN><SPAN style="COLOR: #000000">&nbsp;sad</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">SAD(image1,image2,xl,xr,y,WindowSize);<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;59</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #0000ff">if</SPAN><SPAN style="COLOR: #000000">(sadMin&nbsp;</SPAN><SPAN style="COLOR: #000000">&gt;</SPAN><SPAN style="COLOR: #000000">sad)<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;60</SPAN><SPAN style="COLOR: #000000"><IMG id=Codehighlighter1_1531_1565_Open_Image onclick="this.style.display='none'; Codehighlighter1_1531_1565_Open_Text.style.display='none'; Codehighlighter1_1531_1565_Closed_Image.style.display='inline'; Codehighlighter1_1531_1565_Closed_Text.style.display='inline';" src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif" align=top><IMG id=Codehighlighter1_1531_1565_Closed_Image style="DISPLAY: none" onclick="this.style.display='none'; Codehighlighter1_1531_1565_Closed_Text.style.display='none'; Codehighlighter1_1531_1565_Open_Image.style.display='inline'; Codehighlighter1_1531_1565_Open_Text.style.display='inline';" src="https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN id=Codehighlighter1_1531_1565_Closed_Text style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG src="https://www.cnblogs.com/images/dot.gif"></SPAN><SPAN id=Codehighlighter1_1531_1565_Open_Text><SPAN style="COLOR: #000000">{<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;61</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sadMin</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">sad;<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;62</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dispBest</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">i;<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;63</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN style="COLOR: #000000"><BR></SPAN><SPAN style="COLOR: #008080">&nbsp;64</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN style="COLOR: #000000"><BR></SPAN><SPAN style="COLOR: #008080">&nbsp;65</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top><BR></SPAN><SPAN style="COLOR: #008080">&nbsp;66</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #0000ff">return</SPAN><SPAN style="COLOR: #000000">&nbsp;dispBest;<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;67</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedBlockEnd.gif" align=top>}</SPAN></SPAN><SPAN style="COLOR: #000000"><BR></SPAN><SPAN style="COLOR: #008080">&nbsp;68</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align=top></SPAN><SPAN style="COLOR: #0000ff">void</SPAN><SPAN style="COLOR: #000000">&nbsp;CDlgImagePanorama::OnBnClickedBnMatchSad()<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;69</SPAN><SPAN style="COLOR: #000000"><IMG id=Codehighlighter1_1639_3237_Open_Image onclick="this.style.display='none'; Codehighlighter1_1639_3237_Open_Text.style.display='none'; Codehighlighter1_1639_3237_Closed_Image.style.display='inline'; Codehighlighter1_1639_3237_Closed_Text.style.display='inline';" src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedBlockStart.gif" align=top><IMG id=Codehighlighter1_1639_3237_Closed_Image style="DISPLAY: none" onclick="this.style.display='none'; Codehighlighter1_1639_3237_Closed_Text.style.display='none'; Codehighlighter1_1639_3237_Open_Image.style.display='inline'; Codehighlighter1_1639_3237_Open_Text.style.display='inline';" src="https://www.cnblogs.com/images/OutliningIndicators/ContractedBlock.gif" align=top></SPAN><SPAN id=Codehighlighter1_1639_3237_Closed_Text style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG src="https://www.cnblogs.com/images/dot.gif"></SPAN><SPAN id=Codehighlighter1_1639_3237_Open_Text><SPAN style="COLOR: #000000">{<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;70</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #008000">//</SPAN><SPAN style="COLOR: #008000">&nbsp;TODO:&nbsp;在此添加控件通知处理程序代码<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;71</SPAN><SPAN style="COLOR: #008000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top></SPAN><SPAN style="COLOR: #008000">//</SPAN><SPAN style="COLOR: #008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HImage&nbsp;im1(5,5,1);<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;72</SPAN><SPAN style="COLOR: #008000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top></SPAN><SPAN style="COLOR: #008000">//</SPAN><SPAN style="COLOR: #008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HImage&nbsp;im2(5,5,1);<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;73</SPAN><SPAN style="COLOR: #008000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top></SPAN><SPAN style="COLOR: #008000">//</SPAN><SPAN style="COLOR: #008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cvSet(im2,cvScalar(1));<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;74</SPAN><SPAN style="COLOR: #008000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top></SPAN><SPAN style="COLOR: #008000">//</SPAN><SPAN style="COLOR: #008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;sum=SAD(im1,im2,2,2,2,2);<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;75</SPAN><SPAN style="COLOR: #008000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top></SPAN><SPAN style="COLOR: #008000">//</SPAN><SPAN style="COLOR: #008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TRACE("sum&nbsp;%d&nbsp;",sum);</SPAN><SPAN style="COLOR: #008000"><BR></SPAN><SPAN style="COLOR: #008080">&nbsp;76</SPAN><SPAN style="COLOR: #008000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top></SPAN><SPAN style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;AfxMessageBox(</SPAN><SPAN style="COLOR: #000000">"</SPAN><SPAN style="COLOR: #000000">选择左图</SPAN><SPAN style="COLOR: #000000">"</SPAN><SPAN style="COLOR: #000000">);<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;77</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;CString&nbsp;fileNameL</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">GetFileName(</SPAN><SPAN style="COLOR: #000000">"</SPAN><SPAN style="COLOR: #000000">imageL</SPAN><SPAN style="COLOR: #000000">"</SPAN><SPAN style="COLOR: #000000">);<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;78</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #0000ff">if</SPAN><SPAN style="COLOR: #000000">(fileNameL.GetLength()</SPAN><SPAN style="COLOR: #000000">==</SPAN><SPAN style="COLOR: #000000">0</SPAN><SPAN style="COLOR: #000000">)<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;79</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #0000ff">return</SPAN><SPAN style="COLOR: #000000">;<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;80</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;AfxMessageBox(</SPAN><SPAN style="COLOR: #000000">"</SPAN><SPAN style="COLOR: #000000">选择右图</SPAN><SPAN style="COLOR: #000000">"</SPAN><SPAN style="COLOR: #000000">);<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;81</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;CString&nbsp;fileNameR</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">GetFileName(</SPAN><SPAN style="COLOR: #000000">"</SPAN><SPAN style="COLOR: #000000">imageR</SPAN><SPAN style="COLOR: #000000">"</SPAN><SPAN style="COLOR: #000000">);<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;82</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #0000ff">if</SPAN><SPAN style="COLOR: #000000">(fileNameR.GetLength()</SPAN><SPAN style="COLOR: #000000">==</SPAN><SPAN style="COLOR: #000000">0</SPAN><SPAN style="COLOR: #000000">)<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;83</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #0000ff">return</SPAN><SPAN style="COLOR: #000000">;<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;84</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;HImage&nbsp;im1(fileNameL,</SPAN><SPAN style="COLOR: #000000">0</SPAN><SPAN style="COLOR: #000000">);<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;85</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;HImage&nbsp;im2(fileNameR,</SPAN><SPAN style="COLOR: #000000">0</SPAN><SPAN style="COLOR: #000000">);<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;86</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;H_CHECK(im1.w()</SPAN><SPAN style="COLOR: #000000">==</SPAN><SPAN style="COLOR: #000000">im2.w()&nbsp;</SPAN><SPAN style="COLOR: #000000">&amp;&amp;</SPAN><SPAN style="COLOR: #000000">&nbsp;im1.h()</SPAN><SPAN style="COLOR: #000000">==</SPAN><SPAN style="COLOR: #000000">im2.h()&nbsp;</SPAN><SPAN style="COLOR: #000000">&amp;&amp;</SPAN><SPAN style="COLOR: #000000">&nbsp;im1.nChannels()</SPAN><SPAN style="COLOR: #000000">==</SPAN><SPAN style="COLOR: #000000">im2.nChannels()&nbsp;</SPAN><SPAN style="COLOR: #000000">&amp;&amp;</SPAN><SPAN style="COLOR: #000000">&nbsp;im1.nChannels()</SPAN><SPAN style="COLOR: #000000">==</SPAN><SPAN style="COLOR: #000000">1</SPAN><SPAN style="COLOR: #000000">);<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;87</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;88</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #0000ff">if</SPAN><SPAN style="COLOR: #000000">(AfxMessageBox(</SPAN><SPAN style="COLOR: #000000">"</SPAN><SPAN style="COLOR: #000000">resample&nbsp;to&nbsp;width&nbsp;320?</SPAN><SPAN style="COLOR: #000000">"</SPAN><SPAN style="COLOR: #000000">,MB_YESNO)</SPAN><SPAN style="COLOR: #000000">==</SPAN><SPAN style="COLOR: #000000">IDYES)<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;89</SPAN><SPAN style="COLOR: #000000"><IMG id=Codehighlighter1_2234_2381_Open_Image onclick="this.style.display='none'; Codehighlighter1_2234_2381_Open_Text.style.display='none'; Codehighlighter1_2234_2381_Closed_Image.style.display='inline'; Codehighlighter1_2234_2381_Closed_Text.style.display='inline';" src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif" align=top><IMG id=Codehighlighter1_2234_2381_Closed_Image style="DISPLAY: none" onclick="this.style.display='none'; Codehighlighter1_2234_2381_Closed_Text.style.display='none'; Codehighlighter1_2234_2381_Open_Image.style.display='inline'; Codehighlighter1_2234_2381_Open_Text.style.display='inline';" src="https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN id=Codehighlighter1_2234_2381_Closed_Text style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG src="https://www.cnblogs.com/images/dot.gif"></SPAN><SPAN id=Codehighlighter1_2234_2381_Open_Text><SPAN style="COLOR: #000000">{<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;90</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #0000ff">int</SPAN><SPAN style="COLOR: #000000">&nbsp;h</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">((</SPAN><SPAN style="COLOR: #0000ff">double</SPAN><SPAN style="COLOR: #000000">)im1.h())</SPAN><SPAN style="COLOR: #000000">*</SPAN><SPAN style="COLOR: #000000">320.0</SPAN><SPAN style="COLOR: #000000">/</SPAN><SPAN style="COLOR: #000000">im1.w();<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;91</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HImage&nbsp;imgTmp(</SPAN><SPAN style="COLOR: #000000">320</SPAN><SPAN style="COLOR: #000000">,h,</SPAN><SPAN style="COLOR: #000000">1</SPAN><SPAN style="COLOR: #000000">);<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;92</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cvResize(im1,imgTmp);<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;93</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;im1</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">imgTmp;<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;94</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top><BR></SPAN><SPAN style="COLOR: #008080">&nbsp;95</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cvResize(im2,imgTmp);<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;96</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;im2</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">imgTmp;<BR></SPAN><SPAN style="COLOR: #008080">&nbsp;97</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN style="COLOR: #000000"><BR></SPAN><SPAN style="COLOR: #008080">&nbsp;98</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top><BR></SPAN><SPAN style="COLOR: #008080">&nbsp;99</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #0000ff">int</SPAN><SPAN style="COLOR: #000000">&nbsp;W</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">im1.w(),H</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">im1.h();<BR></SPAN><SPAN style="COLOR: #008080">100</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;H_CHECK(W</SPAN><SPAN style="COLOR: #000000">&gt;</SPAN><SPAN style="COLOR: #000000">0</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #000000">&amp;&amp;</SPAN><SPAN style="COLOR: #000000">&nbsp;H</SPAN><SPAN style="COLOR: #000000">&gt;</SPAN><SPAN style="COLOR: #000000">0</SPAN><SPAN style="COLOR: #000000">);<BR></SPAN><SPAN style="COLOR: #008080">101</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;OutputDebugString(</SPAN><SPAN style="COLOR: #000000">"</SPAN><SPAN style="COLOR: #000000">SAD&nbsp;Start</SPAN><SPAN style="COLOR: #000000">"</SPAN><SPAN style="COLOR: #000000">);<BR></SPAN><SPAN style="COLOR: #008080">102</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;DWORD&nbsp;dwTime</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">GetTickCount();<BR></SPAN><SPAN style="COLOR: #008080">103</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #0000ff">int</SPAN><SPAN style="COLOR: #000000">&nbsp;windowSize</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">GetDlgItemInt(IDC_EDIT_WINSIZE)</SPAN><SPAN style="COLOR: #000000">/</SPAN><SPAN style="COLOR: #000000">2</SPAN><SPAN style="COLOR: #000000">;<BR></SPAN><SPAN style="COLOR: #008080">104</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;ASSERT(windowSize</SPAN><SPAN style="COLOR: #000000">&gt;</SPAN><SPAN style="COLOR: #000000">0</SPAN><SPAN style="COLOR: #000000">);<BR></SPAN><SPAN style="COLOR: #008080">105</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #0000ff">int</SPAN><SPAN style="COLOR: #000000">&nbsp;MaxDispX</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">W</SPAN><SPAN style="COLOR: #000000">/</SPAN><SPAN style="COLOR: #000000">6</SPAN><SPAN style="COLOR: #000000">;<BR></SPAN><SPAN style="COLOR: #008080">106</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #0000ff">int</SPAN><SPAN style="COLOR: #000000">&nbsp;x,y;<BR></SPAN><SPAN style="COLOR: #008080">107</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #0000ff">int</SPAN><SPAN style="COLOR: #000000">&nbsp;Scale</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">255</SPAN><SPAN style="COLOR: #000000">/</SPAN><SPAN style="COLOR: #000000">MaxDispX;<BR></SPAN><SPAN style="COLOR: #008080">108</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top><BR></SPAN><SPAN style="COLOR: #008080">109</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #0000ff">char</SPAN><SPAN style="COLOR: #000000">&nbsp;s[</SPAN><SPAN style="COLOR: #000000">1000</SPAN><SPAN style="COLOR: #000000">];<BR></SPAN><SPAN style="COLOR: #008080">110</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;sprintf(s,</SPAN><SPAN style="COLOR: #000000">"</SPAN><SPAN style="COLOR: #000000">图像大小%d*%d，搜索范围%d,窗口大小%d</SPAN><SPAN style="COLOR: #000000">"</SPAN><SPAN style="COLOR: #000000">,W,H,MaxDispX,windowSize);<BR></SPAN><SPAN style="COLOR: #008080">111</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;SetDlgItemText(IDC_MATCH_INFO,s);<BR></SPAN><SPAN style="COLOR: #008080">112</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top><BR></SPAN><SPAN style="COLOR: #008080">113</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;HImage&nbsp;imageDisp(W,H,</SPAN><SPAN style="COLOR: #000000">1</SPAN><SPAN style="COLOR: #000000">);<BR></SPAN><SPAN style="COLOR: #008080">114</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;TRACE(</SPAN><SPAN style="COLOR: #000000">"</SPAN><SPAN style="COLOR: #000000">MaxDispX&nbsp;%d</SPAN><SPAN style="COLOR: #000000">"</SPAN><SPAN style="COLOR: #000000">,MaxDispX);<BR></SPAN><SPAN style="COLOR: #008080">115</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #0000ff">for</SPAN><SPAN style="COLOR: #000000">&nbsp;(y</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">windowSize;y</SPAN><SPAN style="COLOR: #000000">&lt;</SPAN><SPAN style="COLOR: #000000">H</SPAN><SPAN style="COLOR: #000000">-</SPAN><SPAN style="COLOR: #000000">windowSize;y</SPAN><SPAN style="COLOR: #000000">++</SPAN><SPAN style="COLOR: #000000">)<BR></SPAN><SPAN style="COLOR: #008080">116</SPAN><SPAN style="COLOR: #000000"><IMG id=Codehighlighter1_2836_3160_Open_Image onclick="this.style.display='none'; Codehighlighter1_2836_3160_Open_Text.style.display='none'; Codehighlighter1_2836_3160_Closed_Image.style.display='inline'; Codehighlighter1_2836_3160_Closed_Text.style.display='inline';" src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif" align=top><IMG id=Codehighlighter1_2836_3160_Closed_Image style="DISPLAY: none" onclick="this.style.display='none'; Codehighlighter1_2836_3160_Closed_Text.style.display='none'; Codehighlighter1_2836_3160_Open_Image.style.display='inline'; Codehighlighter1_2836_3160_Open_Text.style.display='inline';" src="https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN id=Codehighlighter1_2836_3160_Closed_Text style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG src="https://www.cnblogs.com/images/dot.gif"></SPAN><SPAN id=Codehighlighter1_2836_3160_Open_Text><SPAN style="COLOR: #000000">{<BR></SPAN><SPAN style="COLOR: #008080">117</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #0000ff">for</SPAN><SPAN style="COLOR: #000000">&nbsp;(x</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">MaxDispX</SPAN><SPAN style="COLOR: #000000">+</SPAN><SPAN style="COLOR: #000000">windowSize;x</SPAN><SPAN style="COLOR: #000000">&lt;</SPAN><SPAN style="COLOR: #000000">W</SPAN><SPAN style="COLOR: #000000">-</SPAN><SPAN style="COLOR: #000000">windowSize;x</SPAN><SPAN style="COLOR: #000000">++</SPAN><SPAN style="COLOR: #000000">)<BR></SPAN><SPAN style="COLOR: #008080">118</SPAN><SPAN style="COLOR: #000000"><IMG id=Codehighlighter1_2889_3138_Open_Image onclick="this.style.display='none'; Codehighlighter1_2889_3138_Open_Text.style.display='none'; Codehighlighter1_2889_3138_Closed_Image.style.display='inline'; Codehighlighter1_2889_3138_Closed_Text.style.display='inline';" src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif" align=top><IMG id=Codehighlighter1_2889_3138_Closed_Image style="DISPLAY: none" onclick="this.style.display='none'; Codehighlighter1_2889_3138_Closed_Text.style.display='none'; Codehighlighter1_2889_3138_Open_Image.style.display='inline'; Codehighlighter1_2889_3138_Open_Text.style.display='inline';" src="https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN id=Codehighlighter1_2889_3138_Closed_Text style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG src="https://www.cnblogs.com/images/dot.gif"></SPAN><SPAN id=Codehighlighter1_2889_3138_Open_Text><SPAN style="COLOR: #000000">{<BR></SPAN><SPAN style="COLOR: #008080">119</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top><BR></SPAN><SPAN style="COLOR: #008080">120</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #0000ff">int</SPAN><SPAN style="COLOR: #000000">&nbsp;disp</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">GetDisparitySAD(im1,im2,x,y,windowSize,MaxDispX);<BR></SPAN><SPAN style="COLOR: #008080">121</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #008000">//</SPAN><SPAN style="COLOR: #008000">CV_IMAGE_ELEM(imageDisp.m_IplImage,BYTE,y,x)=disp*Scale;</SPAN><SPAN style="COLOR: #008000"><BR></SPAN><SPAN style="COLOR: #008080">122</SPAN><SPAN style="COLOR: #008000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top></SPAN><SPAN style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #0000ff">if</SPAN><SPAN style="COLOR: #000000">(disp&nbsp;</SPAN><SPAN style="COLOR: #000000">&amp;&amp;</SPAN><SPAN style="COLOR: #000000">&nbsp;abs(disp</SPAN><SPAN style="COLOR: #000000">-</SPAN><SPAN style="COLOR: #000000">GetDisparitySAD_Reverse(im1,im2,x</SPAN><SPAN style="COLOR: #000000">-</SPAN><SPAN style="COLOR: #000000">disp,y,windowSize,MaxDispX))</SPAN><SPAN style="COLOR: #000000">&lt;</SPAN><SPAN style="COLOR: #000000">5</SPAN><SPAN style="COLOR: #000000">)<BR></SPAN><SPAN style="COLOR: #008080">123</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imageDisp(x,y)</SPAN><SPAN style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">disp</SPAN><SPAN style="COLOR: #000000">*</SPAN><SPAN style="COLOR: #000000">Scale;<BR></SPAN><SPAN style="COLOR: #008080">124</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN style="COLOR: #000000"><BR></SPAN><SPAN style="COLOR: #008080">125</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TRACE(</SPAN><SPAN style="COLOR: #000000">"</SPAN><SPAN style="COLOR: #000000">y&nbsp;%d</SPAN><SPAN style="COLOR: #000000">"</SPAN><SPAN style="COLOR: #000000">,y);<BR></SPAN><SPAN style="COLOR: #008080">126</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN style="COLOR: #000000"><BR></SPAN><SPAN style="COLOR: #008080">127</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top><BR></SPAN><SPAN style="COLOR: #008080">128</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top><BR></SPAN><SPAN style="COLOR: #008080">129</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;TRACE(</SPAN><SPAN style="COLOR: #000000">"</SPAN><SPAN style="COLOR: #000000">SAD&nbsp;End(%d&nbsp;ms)</SPAN><SPAN style="COLOR: #000000">"</SPAN><SPAN style="COLOR: #000000">,GetTickCount()</SPAN><SPAN style="COLOR: #000000">-</SPAN><SPAN style="COLOR: #000000">dwTime);<BR></SPAN><SPAN style="COLOR: #008080">130</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align=top>&nbsp;&nbsp;&nbsp;&nbsp;imageDisp.Show(</SPAN><SPAN style="COLOR: #000000">"</SPAN><SPAN style="COLOR: #000000">disp</SPAN><SPAN style="COLOR: #000000">"</SPAN><SPAN style="COLOR: #000000">);<BR></SPAN><SPAN style="COLOR: #008080">131</SPAN><SPAN style="COLOR: #000000"><IMG src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedBlockEnd.gif" align=top>}</SPAN></SPAN></DIV><BR>