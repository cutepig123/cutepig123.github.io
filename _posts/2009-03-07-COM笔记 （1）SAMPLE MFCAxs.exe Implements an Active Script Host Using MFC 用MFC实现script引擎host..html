<meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="ProgId" content="Word.Document"><meta name="Generator" content="Microsoft Word 11"><meta name="Originator" content="Microsoft Word 11"><link rel="File-List" href="file:///C:%5CDOCUME%7E1%5Chjs%5CLOCALS%7E1%5CTemp%5Cmsohtml1%5C01%5Cclip_filelist.xml"><link rel="Edit-Time-Data" href="file:///C:%5CDOCUME%7E1%5Chjs%5CLOCALS%7E1%5CTemp%5Cmsohtml1%5C01%5Cclip_editdata.mso"><!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:View>Normal</w:View>
  <w:Zoom>0</w:Zoom>
  <w:PunctuationKerning/>
  <w:DrawingGridVerticalSpacing>7.8 磅</w:DrawingGridVerticalSpacing>
  <w:DisplayHorizontalDrawingGridEvery>0</w:DisplayHorizontalDrawingGridEvery>
  <w:DisplayVerticalDrawingGridEvery>2</w:DisplayVerticalDrawingGridEvery>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:Compatibility>
   <w:SpaceForUL/>
   <w:BalanceSingleByteDoubleByteWidth/>
   <w:DoNotLeaveBackslashAlone/>
   <w:ULTrailSpace/>
   <w:DoNotExpandShiftReturn/>
   <w:AdjustLineHeightInTable/>
   <w:BreakWrappedTables/>
   <w:SnapToGridInCell/>
   <w:WrapTextWithPunct/>
   <w:UseAsianBreakRules/>
   <w:DontGrowAutofit/>
   <w:UseFELayout/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" LatentStyleCount="156">
 </w:LatentStyles>
</xml><![endif]--><style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:宋体;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-alt:SimSun;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 135135232 16 0 262145 0;}
@font-face
	{font-family:"\@宋体";
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 135135232 16 0 262145 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	mso-pagination:none;
	font-size:10.5pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:宋体;
	mso-font-kerning:1.0pt;}
 /* Page Definitions */
 @page
	{mso-page-border-surround-header:no;
	mso-page-border-surround-footer:no;}
@page Section1
	{size:595.3pt 841.9pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;
	mso-header-margin:42.55pt;
	mso-footer-margin:49.6pt;
	mso-paper-source:0;
	layout-grid:15.6pt;}
div.Section1
	{page:Section1;}
 /* List Definitions */
 @list l0
	{mso-list-id:65804882;
	mso-list-template-ids:-1082595480;}
@list l0:level1
	{mso-level-number-format:bullet;
	mso-level-text:;
	mso-level-tab-stop:36.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l1
	{mso-list-id:232469592;
	mso-list-template-ids:-1023384486;}
@list l1:level1
	{mso-level-number-format:bullet;
	mso-level-text:;
	mso-level-tab-stop:36.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l2
	{mso-list-id:370810705;
	mso-list-template-ids:944960182;}
@list l2:level1
	{mso-level-number-format:bullet;
	mso-level-text:;
	mso-level-tab-stop:36.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l3
	{mso-list-id:455484876;
	mso-list-template-ids:1859168680;}
@list l3:level1
	{mso-level-number-format:bullet;
	mso-level-text:;
	mso-level-tab-stop:36.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l4
	{mso-list-id:519586756;
	mso-list-template-ids:-478763754;}
@list l4:level1
	{mso-level-number-format:bullet;
	mso-level-text:;
	mso-level-tab-stop:36.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l5
	{mso-list-id:605045101;
	mso-list-template-ids:1686168492;}
@list l5:level1
	{mso-level-number-format:bullet;
	mso-level-text:;
	mso-level-tab-stop:36.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l5:level2
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:72.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;
	mso-ansi-font-size:10.0pt;
	font-family:"Courier New";
	mso-bidi-font-family:"Times New Roman";}
@list l6
	{mso-list-id:1572109880;
	mso-list-template-ids:-665545590;}
@list l6:level1
	{mso-level-number-format:bullet;
	mso-level-text:;
	mso-level-tab-stop:36.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l7
	{mso-list-id:2014185506;
	mso-list-template-ids:1893248440;}
@list l7:level1
	{mso-level-number-format:bullet;
	mso-level-text:;
	mso-level-tab-stop:36.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l8
	{mso-list-id:2041777084;
	mso-list-template-ids:-1540866138;}
@list l8:level1
	{mso-level-number-format:bullet;
	mso-level-text:;
	mso-level-tab-stop:36.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l8:level2
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:72.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;
	mso-ansi-font-size:10.0pt;
	font-family:"Courier New";
	mso-bidi-font-family:"Times New Roman";}
ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style><!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:普通表格;
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
	mso-para-margin:0cm;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
</style>
<![endif]-->

<p class="MsoNormal" style="text-align: left;" align="left"><b><span style="font-size: 24pt; font-family: 宋体;" lang="EN-US">SAMPLE: MFCAxs.exe Implements an Active Script Host
Using MFC<o:p></o:p></span></b></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><!--[if gte vml 1]><v:shapetype id="_x0000_t75"
 coordsize="21600,21600" o:spt="75" o:preferrelative="t" path="m@4@5l@4@11@9@11@9@5xe"
 filled="f" stroked="f">
 <v:stroke joinstyle="miter"/>
 <v:formulas>
  <v:f eqn="if lineDrawn pixelLineWidth 0"/>
  <v:f eqn="sum @0 1 0"/>
  <v:f eqn="sum 0 0 @1"/>
  <v:f eqn="prod @2 1 2"/>
  <v:f eqn="prod @3 21600 pixelWidth"/>
  <v:f eqn="prod @3 21600 pixelHeight"/>
  <v:f eqn="sum @0 0 1"/>
  <v:f eqn="prod @6 1 2"/>
  <v:f eqn="prod @7 21600 pixelWidth"/>
  <v:f eqn="sum @8 21600 0"/>
  <v:f eqn="prod @7 21600 pixelHeight"/>
  <v:f eqn="sum @10 21600 0"/>
 </v:formulas>
 <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>
 <o:lock v:ext="edit" aspectratio="t"/>
</v:shapetype><v:shape id="_x0000_i1026" type="#_x0000_t75" alt="Retired KB Article"
 style='width:12pt;height:12pt'>
 <v:imagedata src="file:///C:\DOCUME~1\hjs\LOCALS~1\Temp\msohtml1\01\clip_image001.gif"
  o:href="http://support.microsoft.com/library/images/support/cn/Archived-KB_16.png"/>
</v:shape><![endif]--><!--[if !vml]--><img src="file:///C:/DOCUME%7E1/hjs/LOCALS%7E1/Temp/msohtml1/01/clip_image001.gif" alt="Retired KB Article" v:shapes="_x0000_i1026" width="16" height="16"><!--[endif]--><a href="http://support.microsoft.com/kb/168214/en-us/#rtDisclaimer">Retired KB
Content Disclaimer</a><o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><a href="http://support.microsoft.com/kb/168214/en-us/#appliesto">View products
that this article applies to.</a><o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><script type="text/javascript">
if (!loadTOCNode) {var loadTOCNode = function(){}}
</script>This article was previously published under Q168214<o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><b><span style="font-size: 18pt; font-family: 宋体;" lang="EN-US"><a href="javascript:void(0);">On This Page</a><o:p></o:p></span></b></p>

<p class="MsoNormal" style="margin-left: 144pt; text-align: left; text-indent: -18pt;" align="left"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">·<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]--><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><a href="http://support.microsoft.com/kb/168214/en-us/"><span style="text-decoration: none;"><!--[if gte vml 1]><v:shape id="_x0000_i1028" type="#_x0000_t75"
 alt="" style='width:7.5pt;height:7.5pt' o:button="t">
 <v:imagedata src="file:///C:\DOCUME~1\hjs\LOCALS~1\Temp\msohtml1\01\clip_image002.gif"
  o:href="http://support.microsoft.com/library/images/support/kbgraphics/public/en-us/downarrow.gif"/>
</v:shape><![endif]--><!--[if !vml]--><img src="file:///C:/DOCUME%7E1/hjs/LOCALS%7E1/Temp/msohtml1/01/clip_image002.gif" v:shapes="_x0000_i1028" width="10" border="0" height="10"><!--[endif]--></span>SUMMARY</a><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-left: 144pt; text-align: left; text-indent: -18pt;" align="left"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">·<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]--><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><a href="http://support.microsoft.com/kb/168214/en-us/"><span style="text-decoration: none;"><!--[if gte vml 1]><v:shape id="_x0000_i1029" type="#_x0000_t75"
 alt="" style='width:7.5pt;height:7.5pt' o:button="t">
 <v:imagedata src="file:///C:\DOCUME~1\hjs\LOCALS~1\Temp\msohtml1\01\clip_image002.gif"
  o:href="http://support.microsoft.com/library/images/support/kbgraphics/public/en-us/downarrow.gif"/>
</v:shape><![endif]--><!--[if !vml]--><img src="file:///C:/DOCUME%7E1/hjs/LOCALS%7E1/Temp/msohtml1/01/clip_image002.gif" v:shapes="_x0000_i1029" width="10" border="0" height="10"><!--[endif]--></span>MORE INFORMATION</a><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-left: 180pt; text-align: left; text-indent: -18pt;" align="left"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;" lang="EN-US"><span style="">o<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]--><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><a href="http://support.microsoft.com/kb/168214/en-us/"><span style="text-decoration: none;"><!--[if gte vml 1]><v:shape id="_x0000_i1030" type="#_x0000_t75"
 alt="" style='width:7.5pt;height:7.5pt' o:button="t">
 <v:imagedata src="file:///C:\DOCUME~1\hjs\LOCALS~1\Temp\msohtml1\01\clip_image002.gif"
  o:href="http://support.microsoft.com/library/images/support/kbgraphics/public/en-us/downarrow.gif"/>
</v:shape><![endif]--><!--[if !vml]--><img src="file:///C:/DOCUME%7E1/hjs/LOCALS%7E1/Temp/msohtml1/01/clip_image002.gif" v:shapes="_x0000_i1030" width="10" border="0" height="10"><!--[endif]--></span>Running the Sample</a><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-left: 180pt; text-align: left; text-indent: -18pt;" align="left"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;" lang="EN-US"><span style="">o<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]--><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><a href="http://support.microsoft.com/kb/168214/en-us/"><span style="text-decoration: none;"><!--[if gte vml 1]><v:shape id="_x0000_i1031" type="#_x0000_t75"
 alt="" style='width:7.5pt;height:7.5pt' o:button="t">
 <v:imagedata src="file:///C:\DOCUME~1\hjs\LOCALS~1\Temp\msohtml1\01\clip_image002.gif"
  o:href="http://support.microsoft.com/library/images/support/kbgraphics/public/en-us/downarrow.gif"/>
</v:shape><![endif]--><!--[if !vml]--><img src="file:///C:/DOCUME%7E1/hjs/LOCALS%7E1/Temp/msohtml1/01/clip_image002.gif" v:shapes="_x0000_i1031" width="10" border="0" height="10"><!--[endif]--></span>Exposing the Host: Dispatch Objects</a><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-left: 180pt; text-align: left; text-indent: -18pt;" align="left"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;" lang="EN-US"><span style="">o<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]--><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><a href="http://support.microsoft.com/kb/168214/en-us/"><span style="text-decoration: none;"><!--[if gte vml 1]><v:shape id="_x0000_i1032" type="#_x0000_t75"
 alt="" style='width:7.5pt;height:7.5pt' o:button="t">
 <v:imagedata src="file:///C:\DOCUME~1\hjs\LOCALS~1\Temp\msohtml1\01\clip_image002.gif"
  o:href="http://support.microsoft.com/library/images/support/kbgraphics/public/en-us/downarrow.gif"/>
</v:shape><![endif]--><!--[if !vml]--><img src="file:///C:/DOCUME%7E1/hjs/LOCALS%7E1/Temp/msohtml1/01/clip_image002.gif" v:shapes="_x0000_i1032" width="10" border="0" height="10"><!--[endif]--></span>Named Items</a><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-left: 180pt; text-align: left; text-indent: -18pt;" align="left"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;" lang="EN-US"><span style="">o<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]--><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><a href="http://support.microsoft.com/kb/168214/en-us/"><span style="text-decoration: none;"><!--[if gte vml 1]><v:shape id="_x0000_i1033" type="#_x0000_t75"
 alt="" style='width:7.5pt;height:7.5pt' o:button="t">
 <v:imagedata src="file:///C:\DOCUME~1\hjs\LOCALS~1\Temp\msohtml1\01\clip_image002.gif"
  o:href="http://support.microsoft.com/library/images/support/kbgraphics/public/en-us/downarrow.gif"/>
</v:shape><![endif]--><!--[if !vml]--><img src="file:///C:/DOCUME%7E1/hjs/LOCALS%7E1/Temp/msohtml1/01/clip_image002.gif" v:shapes="_x0000_i1033" width="10" border="0" height="10"><!--[endif]--></span>Getting to Other Apps: HostCreateObject</a><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-left: 180pt; text-align: left; text-indent: -18pt;" align="left"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;" lang="EN-US"><span style="">o<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]--><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><a href="http://support.microsoft.com/kb/168214/en-us/"><span style="text-decoration: none;"><!--[if gte vml 1]><v:shape id="_x0000_i1034" type="#_x0000_t75"
 alt="" style='width:7.5pt;height:7.5pt' o:button="t">
 <v:imagedata src="file:///C:\DOCUME~1\hjs\LOCALS~1\Temp\msohtml1\01\clip_image002.gif"
  o:href="http://support.microsoft.com/library/images/support/kbgraphics/public/en-us/downarrow.gif"/>
</v:shape><![endif]--><!--[if !vml]--><img src="file:///C:/DOCUME%7E1/hjs/LOCALS%7E1/Temp/msohtml1/01/clip_image002.gif" v:shapes="_x0000_i1034" width="10" border="0" height="10"><!--[endif]--></span>Class Wizard Support</a><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-left: 180pt; text-align: left; text-indent: -18pt;" align="left"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;" lang="EN-US"><span style="">o<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]--><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><a href="http://support.microsoft.com/kb/168214/en-us/"><span style="text-decoration: none;"><!--[if gte vml 1]><v:shape id="_x0000_i1035" type="#_x0000_t75"
 alt="" style='width:7.5pt;height:7.5pt' o:button="t">
 <v:imagedata src="file:///C:\DOCUME~1\hjs\LOCALS~1\Temp\msohtml1\01\clip_image002.gif"
  o:href="http://support.microsoft.com/library/images/support/kbgraphics/public/en-us/downarrow.gif"/>
</v:shape><![endif]--><!--[if !vml]--><img src="file:///C:/DOCUME%7E1/hjs/LOCALS%7E1/Temp/msohtml1/01/clip_image002.gif" v:shapes="_x0000_i1035" width="10" border="0" height="10"><!--[endif]--></span>Appendix A: Object Model</a><o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><script type="text/javascript">
            var sectionFilter = "type != 'notice' && type != 'securedata' && type != 'querywords'";
            var tocArrow = "/library/images/support/kbgraphics/public/en-us/downarrow.gif";
            var depthLimit = 10;
            var depth3Limit = 10;
            var depth4Limit = 5;
            var depth5Limit = 3;
            var tocEntryMinimum = 1;
</script><a href="javascript:void(0);">Expand all</a> | <a href="javascript:void(0);">Collapse all</a><script type="text/javascript">
                    if (kb_page_object)
                    {
                    kb_page_object.kb_imageExpandHoverText = 'Click to expand this image';
                    }
</script><o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><b><span style="font-size: 18pt; font-family: 宋体;" lang="EN-US"><a href="javascript:void(0);">SUMMARY</a><o:p></o:p></span></b></p>

<p class="MsoNormal" style="text-align: left;" align="left"><b><span style="font-size: 18pt; font-family: 宋体;" lang="EN-US">MFCAxs.exe is a sample that contains MfcAxscrVb.
MfcAxscrVb is an instructional...<o:p></o:p></span></b></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><script type="text/javascript">
                            loadTOCNode(1, 'summary');
</script>MFCAxs.exe is a sample that contains MfcAxscrVb. MfcAxscrVb is an
instructional sample Active Scripting host written using MFC. It hosts the
VBScript DLL; however, the Active Scripting mechanisms are generic to any
Active Scripting engine. MfcAxscrVb shows just one possible way to provide
dispatch objects from the host, to implement the host's Active Scripting
interfaces, and to connect the messages of windows in the host with events
fired to the scripting engine. <br>
<br>
MfcAxscrVb</span><span style="font-size: 12pt; font-family: 宋体;">实现了<span lang="EN-US">vbscript</span>的<span lang="EN-US">host</span>功能，通过提供<span lang="EN-US">IDispatch</span>接口的<span lang="EN-US">object</span>实现<span lang="EN-US">script</span>接口。使用<span lang="EN-US">events</span>实现消息通信。<span lang="EN-US"><br>
<br>
MfcAxscrVb includes a Visual C++ 5.0 workspace and project file. Although no
VC++ 4.2 compatible makefile or mdpfile is provided, the source code for
MfcAxscrVb is compatible with MFC 4.2b. <br>
<br>
Prerequisites: COM, Automation <o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><a href="http://support.microsoft.com/kb/168214/en-us/#top"><span style="text-decoration: none;"><!--[if gte vml 1]><v:shape
 id="_x0000_i1039" type="#_x0000_t75" alt="" style='width:7.5pt;height:7.5pt'
 o:button="t">
 <v:imagedata src="file:///C:\DOCUME~1\hjs\LOCALS~1\Temp\msohtml1\01\clip_image003.gif"
  o:href="http://support.microsoft.com/library/images/support/kbgraphics/public/en-us/uparrow.gif"/>
</v:shape><![endif]--><!--[if !vml]--><img src="file:///C:/DOCUME%7E1/hjs/LOCALS%7E1/Temp/msohtml1/01/clip_image003.gif" v:shapes="_x0000_i1039" width="10" border="0" height="10"><!--[endif]--></span>Back to the top</a><o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><b><span style="font-size: 18pt; font-family: 宋体;" lang="EN-US"><a href="javascript:void(0);">MORE INFORMATION</a><o:p></o:p></span></b></p>

<p class="MsoNormal" style="text-align: left;" align="left"><b><span style="font-size: 18pt; font-family: 宋体;" lang="EN-US">The following file is available for download from the
Microsoft Download Center:...<o:p></o:p></span></b></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><script type="text/javascript">
                            loadTOCNode(1, 'moreinformation');
</script>The following file is available for download from the Microsoft <o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">程序及源代码可以在这里下载：（注：用<span lang="EN-US">vc2005</span>编译的话会有几个小错误，不过很好改）<span lang="EN-US"><o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">Download Center:<o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><a href="http://download.microsoft.com/download/vc50pro/mfcaxs/1/win98/en-us/mfcaxs.exe">MFCAxs.exe</a>
(http://download.microsoft.com/download/vc50pro/mfcaxs/1/win98/en-us/mfcaxs.exe)
<o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">For additional information about how to download
Microsoft Support files, click the following article number to view the article
in the Microsoft Knowledge Base: <o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><a href="http://support.microsoft.com/kb/119591/EN-US/">119591</a>&nbsp;
(http://support.microsoft.com/kb/119591/EN-US/ ) How to Obtain Microsoft
Support Files from Online Services <o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">Microsoft scanned this file for viruses. Microsoft used
the most current virus-detection software that was available on the date that
the file was posted. The file is stored on security-enhanced servers that help
to prevent any unauthorized changes to the file. <o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><a href="http://support.microsoft.com/kb/168214/en-us/#top"><span style="text-decoration: none;"><!--[if gte vml 1]><v:shape
 id="_x0000_i1041" type="#_x0000_t75" alt="" style='width:7.5pt;height:7.5pt'
 o:button="t">
 <v:imagedata src="file:///C:\DOCUME~1\hjs\LOCALS~1\Temp\msohtml1\01\clip_image003.gif"
  o:href="http://support.microsoft.com/library/images/support/kbgraphics/public/en-us/uparrow.gif"/>
</v:shape><![endif]--><!--[if !vml]--><img src="file:///C:/DOCUME%7E1/hjs/LOCALS%7E1/Temp/msohtml1/01/clip_image003.gif" v:shapes="_x0000_i1041" width="10" border="0" height="10"><!--[endif]--></span>Back to the top</a><o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><b><span style="font-size: 13.5pt; font-family: 宋体;" lang="EN-US">Running the Sample<o:p></o:p></span></b></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><script type="text/javascript">
                loadTOCNode(2, 'moreinformation');
</script>When you run the MfcAxscrVb sample you will notice a large edit
control in the upper left-hand corner of the application. You can paste or type
script into this window and select the "Run Script" button to invoke
the script. Several test scripts are provided for you in the Script.txt and
Testevents.txt files. <o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">运行该程序，在左上角的文本框内可以输入<span lang="EN-US">vbscript</span>语句，并按<span lang="EN-US">RunScript</span>按钮执行。在<span lang="EN-US">Script.txt </span>和<span lang="EN-US"> Testevents.txt</span>文件里有一些例子<span lang="EN-US"><o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><a href="http://support.microsoft.com/kb/168214/en-us/#top"><span style="text-decoration: none;"><!--[if gte vml 1]><v:shape
 id="_x0000_i1043" type="#_x0000_t75" alt="" style='width:7.5pt;height:7.5pt'
 o:button="t">
 <v:imagedata src="file:///C:\DOCUME~1\hjs\LOCALS~1\Temp\msohtml1\01\clip_image003.gif"
  o:href="http://support.microsoft.com/library/images/support/kbgraphics/public/en-us/uparrow.gif"/>
</v:shape><![endif]--><!--[if !vml]--><img src="file:///C:/DOCUME%7E1/hjs/LOCALS%7E1/Temp/msohtml1/01/clip_image003.gif" v:shapes="_x0000_i1043" width="10" border="0" height="10"><!--[endif]--></span>Back to the top</a><o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><b><span style="font-size: 13.5pt; font-family: 宋体;" lang="EN-US">Exposing the Host: Dispatch Objects<o:p></o:p></span></b></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><script type="text/javascript">
                loadTOCNode(2, 'moreinformation');
</script>The main focus for this sample is the implementation of dispatch
objects using MFC. The reason for this is simple. A scripting language isn't
much use if there isn't anything to script.<br style="">
<!--[if !supportLineBreakNewLine]--><br style="">
<!--[endif]--><o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">本文的目的是介绍用<span lang="EN-US">MFC</span>实现<span lang="EN-US">dispatch</span>对象方法。<span lang="EN-US"><o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><br>
The core technology upon which all Active Scripting depends is most certainly
that of Automation. A solid working knowledge of Automation is absolutely
necessary before attempting to code any Active Scripting host. There are several
good references for Automation: c<span style="color: red;">hapters 14 and 15 of
Brockshmidt's "Inside OLE," chapter 11 of Dale Rogerson's
"Inside COM," and the "OLE Automation Programmer's Reference.</span>"
<br style="">
<!--[if !supportLineBreakNewLine]--><br style="">
<!--[endif]--><o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">实现的主要技术是<span lang="EN-US">automation</span>。可以参考这些书：。。<span lang="EN-US"><o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><br>
<b>CCmdTargetPlus:</b><br>
<br>
What you need are some objects that allow for scriptable properties and methods
through IDispatch but also generate scriptable events. MFC definitely does most
of the grunt work for you when implementing dispatch interfaces for a COM
object. However, the only MFC class that supports both incoming dispatch
interfaces and outgoing dispatch interfaces, or event sinks, is COleControl.
COleControl is much too bulky for what you want. You just want events, a
dispatch interface, and type information. VBScript needs to read type information
for dispatch objects that support events. You could either create this on the
fly, or create a static type library for your host's dispatch objects and
obtain the ITypeInfo for each individual object. <br style="">
<!--[if !supportLineBreakNewLine]--><br style="">
<!--[endif]--><o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">我们需要实现的是<span lang="EN-US">script</span>语言可以用<span lang="EN-US">dispatch</span>接口控制的属性，方法和事件。<span lang="EN-US">MFC</span>的<span lang="EN-US">ColeControl</span>支持输入和输出<span lang="EN-US">disptch</span>接口，<span lang="EN-US">event sinks</span>。但是对我们来说，这个类太大了。我们只需要<span lang="EN-US">events,</span>和<span lang="EN-US">dispatch</span>接口<span lang="EN-US">,</span>和<span lang="EN-US">type</span>信息。<span lang="EN-US">Vbscrip</span>需要读入支持<span lang="EN-US">event</span>的<span lang="EN-US">dispatch</span>对象的<span lang="EN-US">type</span>信息。<span lang="EN-US"><o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><br>
While probably not necessary, MfcAxscrVb has a base class called CCmdTargetPlus
that supports these three pieces: dispatch interface, connection points with a
control-style event map, and easily accessible type information through
IProvideClassInfo. Most of the code in CmdTargetPlus was added to allow for
event maps, which makes adding events to derived classes much easier. <br style="">
<!--[if !supportLineBreakNewLine]--><br style="">
<!--[endif]--><o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">这里有一个基类<span lang="EN-US">CcmdTargetPlus</span>实现了三个功能：<span lang="EN-US">dispatch
</span>接口<span lang="EN-US">, </span>连接点和事件<span lang="EN-US">map, </span>和通过<span lang="EN-US">IProvideClassInfo </span>实现的<span lang="EN-US">type </span>信息 <span lang="EN-US"><o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><br>
<b>Dispatch Objects:</b><br>
<br>
All host-provided dispatch objects are implemented using CCmdTargetPlus. There
are a few things they need to do to work well. Refer to any of the dispatch
objects (CAButtonDispatch, CBButtonDispatch, and so forth) for a boilerplate on
what is necessary. A brief rundown on MfcAxscrvb's object model is listed at
the end of this document. <br style="">
<!--[if !supportLineBreakNewLine]--><br style="">
<!--[endif]--><o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">程序里提供的<span lang="EN-US">dispatch objects</span>都是用<span lang="EN-US">CcmdTargetPlus</span>实现的。需要注意（可以参考<span lang="EN-US">CAButtonDispatch, CBButtonDispatch..</span>）<span lang="EN-US">,</span>本文末尾介绍了该程序实现的<span lang="EN-US">object<o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><br>
If you add your own objects, be sure to double-check for three unique GUIDs for
the primary dispatch and primary events interfaces, and for the clsid for the
object in sum. This needs to be done in the implementation file and in the .odl
file. (Cut and Paste helps here.) Cut and paste all of the class wizard macros,
and then change them to the new class name. Class Wizard is very particular,
but if you follow everything just right in the .odl, .h, and .cpp files, you
can use it to add new events, properties, and methods to your dispatch object
as if it were an MFC OLE Control. This is sort of handy. <br style="">
<!--[if !supportLineBreakNewLine]--><br style="">
<!--[endif]--><o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">如果你想自己用<span lang="EN-US">CcmdTargetPlus</span>添加<span lang="EN-US">object</span>，需要注意：有三个唯一的<span lang="EN-US">GUID(dispatch, event</span>和<span lang="EN-US">clsid)</span>，需要在<span lang="EN-US">cpp</span>和<span lang="EN-US">odl</span>文件里分别实现。<span lang="EN-US"><o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><br>
MfcAxscrVb keeps the object implementing the dispatch mechanisms separate from
the MFC object, which it is actually referring to. For example, the dialog box
has a button called the "AButton," which is scriptable. The MFC
button object is CButton. The CCmdTargetPlus-derived class, CAButtonDispatch,
is separate and distinct. This is a key point. Only what the host programmer
explicitly chooses to expose for basic MFC objects and Windows controls will be
scriptable. <br style="">
<!--[if !supportLineBreakNewLine]--><br style="">
<!--[endif]--><o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">本程序将<span lang="EN-US">dispatch</span>机构的实现和<span lang="EN-US">mfc</span>对象的实现分开为不同的类。比如有一个按钮对应<span lang="EN-US">Cbutton</span>类，而该按钮对应的<span lang="EN-US">dispatch</span>为<span lang="EN-US">CAButtonDispatch</span>类。<span lang="EN-US"><o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><b><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">CEventsButton, CEventsEdit, CeventsListBox:</span></b><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><br>
<br>
For events, there needs to be some code that responds to a Windows event-- say,
a button click--and generates an event for the script engine. (Remember an
event is a dispatch Invoke on an interface handled by connection points in the
host object.) This sample accomplishes this by adding standard MFC message
handlers into objects derived from the various classes. Each of these handlers
merely has to call FireEvent (courtesy of the code added to CCmdTargetPlus) on
the dispatch object. Everything else happens automatically. <br style="">
<!--[if !supportLineBreakNewLine]--><br style="">
<!--[endif]--><o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">对于<span lang="EN-US">event,</span>需要用连接点实现。本文通过添加<span lang="EN-US">MFC</span>消息的<span lang="EN-US">handler</span>到类中实现此。每一个<span lang="EN-US">handler</span>必须对<span lang="EN-US">dispatch</span>的对象调用<span lang="EN-US">FireEvent</span>。其他的都自动发生。<span lang="EN-US"><o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><br>
Because the dispatch object and the actual MFC window object are separate in
this sample, the dialog parent needs to explicitly hook the two together. This
is done in the Mfcaxscrvbdlg constructor. <o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">由于<span lang="EN-US">dispatch</span>对象和<span lang="EN-US">MFC</span>对象的实现分开来了，<span lang="EN-US">dialog</span>类的<span lang="EN-US">constructor</span>中必须显式的将这两个连在一起<span lang="EN-US"><o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><a href="http://support.microsoft.com/kb/168214/en-us/#top"><span style="text-decoration: none;"><!--[if gte vml 1]><v:shape
 id="_x0000_i1045" type="#_x0000_t75" alt="" style='width:7.5pt;height:7.5pt'
 o:button="t">
 <v:imagedata src="file:///C:\DOCUME~1\hjs\LOCALS~1\Temp\msohtml1\01\clip_image003.gif"
  o:href="http://support.microsoft.com/library/images/support/kbgraphics/public/en-us/uparrow.gif"/>
</v:shape><![endif]--><!--[if !vml]--><img src="file:///C:/DOCUME%7E1/hjs/LOCALS%7E1/Temp/msohtml1/01/clip_image003.gif" v:shapes="_x0000_i1045" width="10" border="0" height="10"><!--[endif]--></span>Back to the top</a><o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><b><span style="font-size: 13.5pt; font-family: 宋体;" lang="EN-US">Named Items<o:p></o:p></span></b></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><script type="text/javascript">
                loadTOCNode(2, 'moreinformation');
</script>Once you have dispatch objects, you have to set them up so that the
script engine knows about them. The collection of all the named dispatch
objects that the script engine knows about is called the "Script
Namespace." Items are added to the script namespace through the
IActiveScript::AddNamedItem method. As I mentioned previously, it is the host's
duty to implement an IDispatch for the object and support type-information
through ITypeInfo for the object. When the script engine needs to resolve a
reference to a named item, it uses the IActiveScriptSite::GetItemInfo method to
request an IUnknown pointer (which it queries mainly for IDispatch) and an
ITypeInfo pointer. <br style="">
<!--[if !supportLineBreakNewLine]--><br style="">
<!--[endif]--><o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">你必须让<span lang="EN-US">script</span>引擎知道你拥有的<span lang="EN-US">dispatch</span>对象。你必须实现<span lang="EN-US">script</span>名称空间，这通过<span lang="EN-US">IActiveScript::AddNamedItem</span>实现。<span lang="EN-US">Host</span>必须实现<span lang="EN-US">Idispatch</span>和<span lang="EN-US">ItypeInfo</span>。<span lang="EN-US">Script</span>引擎通过<span lang="EN-US">IActiveScriptSite::GetItemInfo</span>得到某一项<span lang="EN-US">named item</span>的<span lang="EN-US">Iunknown</span>和<span lang="EN-US">ITypeInfo</span>指针。<span lang="EN-US"><o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><br>
Not everything that a host wants to be scriptable needs to be a named item.
Usually the host will have a hierarchy of objects, where sub-objects are
accessible through a higher-level object. A common metaphor is the
Application-&gt;Document-&gt;Item hierarchy, where the Document object is
accessible from the top-level Application object as an IDispatch property of
the Application object itself. In the same manner, the Document object itself
exposes several sub-objects and each is an Item that you can obtain through an
Item array or other contrivance. <br>
<br>
Using this scheme, the scripting engine is smart enough to navigate to a
sub-item when the script code says the following without needing Document or
Item to be added to the script namespace: <o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">Set Obj = Application.Document.Item(1)<br style="">
<!--[if !supportLineBreakNewLine]--><br style="">
<!--[endif]--><o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">也可以不用<span lang="EN-US">named item</span>实现，<span lang="EN-US">host</span>可以有一系列树状的对象，底层的可以通过高层对象得到。比如<span lang="EN-US">Application-&gt;Document-&gt;Item</span>。其中<span lang="EN-US">Document</span>可以通过获取<span lang="EN-US">application</span>对象的<span lang="EN-US">Application</span>得到。用这种方法，<span lang="EN-US">script</span>引擎可以遍历所有的<span lang="EN-US">item,</span>比如<span lang="EN-US">Set Obj = Application.Document.Item(1)<o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">As long as the sub-objects are exposed as get-properties
of their parent object, the script engine finds them successfully.
Interestingly enough, the script engine is able to "assume" the
top-level item in the hierarchy. What this means is that if Application is
declared as the top-level item, then it is sufficient to say the following for
the prior script code: <o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">Set Obj = Document.Item(1)<br>
<span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">This is exactly how Internet Explorer 3.0 allows you to
script code in the context of the Window object without always prefixing all
references to objects with "Window." A script host needs to identify
the top-level script item in the call to AddNamedItems by using the
SCRIPTITEM_GLOBALMEMBERS flag. What usually isn't made clear by Active
Scripting documentation, however, is that only named items can support events.
Using the above example, there is no syntax to say the following to handle an
event in a particular item: <o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><span style="">&nbsp;&nbsp; </span>Sub
Application.Document.Item(1)_OnEvent ' this doesn't work!<br style="">
<!--[if !supportLineBreakNewLine]--><br style="">
<!--[endif]--><o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">这就是<span lang="EN-US">IE</span>实现的功能。他的最顶层是<span lang="EN-US">Window,script
host</span>通过<span lang="EN-US">AddNamedItems</span>（<span lang="EN-US">SCRIPTITEM_GLOBALMEMBERS</span>）实现顶层的<span lang="EN-US">script item.</span>但是只有<span lang="EN-US">named item</span>支持<span lang="EN-US">event</span>。这点需要注意。<span lang="EN-US"><o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">So, for MfcAxscrvbdlg, because we want to be able to
handle the events of every object in the hierarchy, every object is added as a
Named Item. Each object is also accessible through the top-level Scripter
object (the dialog itself), which does not support events currently. <br style="">
<!--[if !supportLineBreakNewLine]--><br style="">
<!--[endif]--><o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">对我们来说，想<span lang="EN-US">handle</span>所有对象的<span lang="EN-US">event</span>，因此必须都作为<span lang="EN-US">named item</span>实现。并且都可以通过顶层对象（<span lang="EN-US">dialog</span>本身，尚不支持<span lang="EN-US">event</span>）得到。<span lang="EN-US"><o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><br>
<b>WebBrowser Control:</b><br>
<br>
In this sample, the script host exposes only one external object to the script
namespace. This is the WebBrowser control hosted on the dialog by MFC's default
control containment support. All you need is an AddRef'd dispatch pointer to
the control, and you're set. For events, the external object needs to expose an
ITypeInfo pointer somehow. MfcAxscrVb gets this through
IProvideClassInfo::GetClassInfo. As a last resort, a host could read the
object's type-information itself to expose an ITypeInfo. Fortunately, the WebBrowser
control supports GetClassInfo, so MfcAxscrVb doesn't do this. <br style="">
<!--[if !supportLineBreakNewLine]--><br style="">
<!--[endif]--><o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">本例中，<span lang="EN-US">host</span>只暴露了一个外部的对象给<span lang="EN-US">script</span>的<span lang="EN-US">namespace</span>，即<span lang="EN-US">WebBrowser</span>。<span lang="EN-US">Host</span>通过<span lang="EN-US">AddRef'd</span>得到<span lang="EN-US">dispatch</span>接口，通过<span lang="EN-US">IprovideClassInfo ::<o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">GetClassInfo</span><span style="font-size: 12pt; font-family: 宋体;">得到<span lang="EN-US">ITypeInfo<o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><br>
If you wanted to add other external automation objects to the namespace, all
that usually is necessary is to obtain an IUnknown interface using
CoCreateInstance. Alternatively, the host can support a generic means for
obtaining external objects, albeit ones that don't need to have events handled.
In Visual Basic, the function to do this is called CreateObject. <o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">如果你想加入新的外部对象，只需使用<span lang="EN-US">CoCreateInstance</span>获得<span lang="EN-US">Iunknown</span>接口。在<span lang="EN-US">vb</span>中<span lang="EN-US">host</span>提供的是<span lang="EN-US">createobject</span>方法<span lang="EN-US"><o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><a href="http://support.microsoft.com/kb/168214/en-us/#top"><span style="text-decoration: none;"><!--[if gte vml 1]><v:shape
 id="_x0000_i1047" type="#_x0000_t75" alt="" style='width:7.5pt;height:7.5pt'
 o:button="t">
 <v:imagedata src="file:///C:\DOCUME~1\hjs\LOCALS~1\Temp\msohtml1\01\clip_image003.gif"
  o:href="http://support.microsoft.com/library/images/support/kbgraphics/public/en-us/uparrow.gif"/>
</v:shape><![endif]--><!--[if !vml]--><img src="file:///C:/DOCUME%7E1/hjs/LOCALS%7E1/Temp/msohtml1/01/clip_image003.gif" v:shapes="_x0000_i1047" width="10" border="0" height="10"><!--[endif]--></span>Back to the top</a><o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><b><span style="font-size: 13.5pt; font-family: 宋体;" lang="EN-US">Getting to Other Apps: HostCreateObject<o:p></o:p></span></b></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><script type="text/javascript">
                loadTOCNode(2, 'moreinformation');
</script>Other than the set of properties used to expose all of the child
objects, the main Scripter object (the dialog class itself) exposes only one
special method. This method demonstrates a simple means for simulating VB's
CreateObject function. Note that the method is named HostCreateObject to
emphasize that this method is not provided for free by the script engine, but
the host must implement it itself. Some hosts clearly would not want to provide
this ability for security reasons, IE3 is a prime example. The primary goal of
HostCreateObject is to return the dispatch pointer of the requested object.
Once the scripting engine has the dispatch pointer, it knows what to do from
there. <br style="">
<!--[if !supportLineBreakNewLine]--><br style="">
<!--[endif]--><o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">HostCreateObject</span><span style="font-size: 12pt; font-family: 宋体;">的目的是返回要求的对象的<span lang="EN-US">dispatch</span>指针<span lang="EN-US"><o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><br>
<b>NOTE</b>: As of version 2.0, the VBScript and JScript engines now support
CreateObject as a built-in function. The host does not need to implement this
function. This function will, however, test an object to make sure it is safe
for scripting before allowing the object to be used. Objects deem themselves
safe for scripting by either supporting the IObjectSafety interface or marking
the appropriate Component Category registry entries for Safe-For-Scripting.
Refer to the Microsoft Knowledge Base for more information. <o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">注：<span lang="EN-US">vbscript</span>本身已经支持<span lang="EN-US">CreateObject</span>了<span lang="EN-US"><o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><a href="http://support.microsoft.com/kb/168214/en-us/#top"><span style="text-decoration: none;"><!--[if gte vml 1]><v:shape
 id="_x0000_i1049" type="#_x0000_t75" alt="" style='width:7.5pt;height:7.5pt'
 o:button="t">
 <v:imagedata src="file:///C:\DOCUME~1\hjs\LOCALS~1\Temp\msohtml1\01\clip_image003.gif"
  o:href="http://support.microsoft.com/library/images/support/kbgraphics/public/en-us/uparrow.gif"/>
</v:shape><![endif]--><!--[if !vml]--><img src="file:///C:/DOCUME%7E1/hjs/LOCALS%7E1/Temp/msohtml1/01/clip_image003.gif" v:shapes="_x0000_i1049" width="10" border="0" height="10"><!--[endif]--></span>Back to the top</a><o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><b><span style="font-size: 13.5pt; font-family: 宋体;" lang="EN-US">Class Wizard Support<o:p></o:p></span></b></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><script type="text/javascript">
                loadTOCNode(2, 'moreinformation');
</script>The last little bit of trickery in MfcAxscrVb is the manipulations
made to support ClassWizard. Class Wizard, technically isn't "dumb."
It is just mentally challenged. It is pretty convenient for what it does, but
remember that it just blindly searches files looking for those special
ClassWizard comments. If you follow the format for COleControl, you can just
about get away with using ClassWizard's Automation and Events tabs. <br style="">
<!--[if !supportLineBreakNewLine]--><br style="">
<!--[endif]--><o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">介绍一下怎么实现对<span lang="EN-US">ClassWizard</span>的支持。<span lang="EN-US">ClassWizard</span>只是通过在文件中查找特别的<span lang="EN-US">comments</span>实现。可以参考<span lang="EN-US">ColeControl</span>看看如何实现<span lang="EN-US">Automation</span>和<span lang="EN-US">Events<o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><br>
One complication is that MfcAxscrVb uses derivation in some of its object
hierarchy. All of the button objects are derived from a common CButtonDispatch
object that exposes properties and methods, all of which it would individually
support. However, when it comes time to fill out the .odl file, each individual
object needs to contain all of the properties and methods of the parent class.
Needless to say, this is going to confuse Class Wizard when it comes time to
number the DISPIDs. If you use Class Wizard, make sure you double-check the
generated DISPIDs in two places: the .odl file for the automation class and the
enumeration inside the class definition. When working with the derived button
classes, it is easy to see the same DISPID assigned to multiple properties and
methods. It is much easier to correct the DISPIDs, though, than to add
everything by scratch, so the functionality has been left in MfcAxscrVb. <br style="">
<!--[if !supportLineBreakNewLine]--><br style="">
<!--[endif]--><o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><br>
With Visual C++ 5.0's improved support of IDL methods and properties through
ClassView, it's a toss up whether ClassWizard is needed or not. But MfcAxscrVb
supports it for now. Enjoy. <o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><a href="http://support.microsoft.com/kb/168214/en-us/#top"><span style="text-decoration: none;"><!--[if gte vml 1]><v:shape
 id="_x0000_i1051" type="#_x0000_t75" alt="" style='width:7.5pt;height:7.5pt'
 o:button="t">
 <v:imagedata src="file:///C:\DOCUME~1\hjs\LOCALS~1\Temp\msohtml1\01\clip_image003.gif"
  o:href="http://support.microsoft.com/library/images/support/kbgraphics/public/en-us/uparrow.gif"/>
</v:shape><![endif]--><!--[if !vml]--><img src="file:///C:/DOCUME%7E1/hjs/LOCALS%7E1/Temp/msohtml1/01/clip_image003.gif" v:shapes="_x0000_i1051" width="10" border="0" height="10"><!--[endif]--></span>Back to the top</a><o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><b><span style="font-size: 13.5pt; font-family: 宋体;" lang="EN-US">Appendix A: Object Model<o:p></o:p></span></b></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><script type="text/javascript">
                loadTOCNode(2, 'moreinformation');
</script><b>Scripter:</b><br>
<br>
This is the master object from which all other objects are derived. It is
"IMfcaxscrvbDlg" in the .odl file but is added as the Named Item
"Scripter." It has one method, HostCreateObject, which is described
above. <br style="">
<!--[if !supportLineBreakNewLine]--><br style="">
<!--[endif]--><o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">这是<span lang="EN-US">master</span>对象，在<span lang="EN-US">odl</span>中为<span lang="EN-US">ImfcaxscrvbDlg</span>，而<span lang="EN-US">named item</span>是<span lang="EN-US">Scripter</span>。他只有一个方法<span lang="EN-US">HostCreateObject<o:p></o:p></span></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><br>
<b>Button Objects:</b><br>
<br>
AButton BButton, CancelButton, OKButton, RunScript <br>
<br>
<b>Properties</b></span><b><span style="font-size: 12pt; font-family: 宋体;">属性</span></b><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-left: 144pt; text-align: left; text-indent: -18pt;" align="left"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">·<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]--><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">Caption: Text of
button face.<o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><b><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">Methods</span></b><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"> </span><span style="font-size: 12pt; font-family: 宋体;">方法<span lang="EN-US">Press: Acts as if the button were pushed. <o:p></o:p></span></span></p>

<p class="MsoNormal" style="margin-left: 144pt; text-align: left; text-indent: -18pt;" align="left"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">·<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]--><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">Press: Acts as if
the button were pushed.<o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><b><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">Events</span></b><b><span style="font-size: 12pt; font-family: 宋体;">事件</span></b><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-left: 144pt; text-align: left; text-indent: -18pt;" align="left"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">·<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]--><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">OnClick: Fired
when button is pushed.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-left: 144pt; text-align: left; text-indent: -18pt;" align="left"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">·<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]--><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">OnMouseOver: Fired
when mouse rolls over button.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-left: 144pt; text-align: left; text-indent: -18pt;" align="left"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">·<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]--><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">OnFocus(bSet):
Fired when focus is given or taken from button.<o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><b><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">BroCon:</span></b><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><br>
<br>
BroCon is the name of the WebBrowser control on the dialog box. It supports all
properties and methods as documented in the Internet Client SDK/ActiveX SDK for
the WebBrowser control. <br>
<br>
<b>EditCon:</b><br>
<br>
<b>Methods</b><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-left: 144pt; text-align: left; text-indent: -18pt;" align="left"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">·<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]--><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">AppendLine(strToAdd):
Adds strToAdd to end of edit text window.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-left: 144pt; text-align: left; text-indent: -18pt;" align="left"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">·<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]--><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">InsertLine(strToAdd,
nWhere): Adds strToAdd at line #nWhere.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-left: 144pt; text-align: left; text-indent: -18pt;" align="left"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">·<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]--><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">RemoveLine(nWhere):
Removes line # nWhere from edit window.<o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><b><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">Events</span></b><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-left: 144pt; text-align: left; text-indent: -18pt;" align="left"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">·<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]--><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">OnMouseOver: Fired
when mouse rolls over window.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-left: 144pt; text-align: left; text-indent: -18pt;" align="left"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">·<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]--><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">OnChar(strChar):
Fired when character strChar is entered into window.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-left: 144pt; text-align: left; text-indent: -18pt;" align="left"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">·<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]--><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">OnFocus(bSet):
Fired when focus is given or taken from button.<o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><b><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">Lbox:</span></b><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><br>
<br>
<b>Methods</b><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-left: 144pt; text-align: left; text-indent: -18pt;" align="left"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">·<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]--><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">AddString(strIn):
Adds StrIn into list box.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-left: 144pt; text-align: left; text-indent: -18pt;" align="left"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">·<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]--><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">ClearList: Clears
all strings from list box.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-left: 144pt; text-align: left; text-indent: -18pt;" align="left"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">·<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]--><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">RemoveString(strRemove):
Removes first instance of StrRemove and removes it from list box.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-left: 144pt; text-align: left; text-indent: -18pt;" align="left"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">·<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]--><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">SelectString(strSelect):
Selects string specified by strSelect.<o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><b><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">Events</span></b><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-left: 144pt; text-align: left; text-indent: -18pt;" align="left"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">·<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]--><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">OnMouseOver: Fired
when mouse rolls over window.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-left: 144pt; text-align: left; text-indent: -18pt;" align="left"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">·<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]--><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">OnFocus(bSet):
Fired when focus is given or taken from button.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-left: 144pt; text-align: left; text-indent: -18pt;" align="left"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">·<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]--><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">OnSelCancel(strCancelled):
When selection is cancelled in a list box element strCancelled.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-left: 144pt; text-align: left; text-indent: -18pt;" align="left"><!--[if !supportLists]--><span style="font-size: 10pt; font-family: Symbol;" lang="EN-US"><span style="">·<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]--><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">OnSelChange(strChange):
When a list box element strChange is selected by the user.<o:p></o:p></span></p>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><a href="http://support.microsoft.com/kb/168214/en-us/#top"><span style="text-decoration: none;"><!--[if gte vml 1]><v:shape
 id="_x0000_i1053" type="#_x0000_t75" alt="" style='width:7.5pt;height:7.5pt'
 o:button="t">
 <v:imagedata src="file:///C:\DOCUME~1\hjs\LOCALS~1\Temp\msohtml1\01\clip_image003.gif"
  o:href="http://support.microsoft.com/library/images/support/kbgraphics/public/en-us/uparrow.gif"/>
</v:shape><![endif]--><!--[if !vml]--><img src="file:///C:/DOCUME%7E1/hjs/LOCALS%7E1/Temp/msohtml1/01/clip_image003.gif" v:shapes="_x0000_i1053" width="10" border="0" height="10"><!--[endif]--></span>Back to the top</a><o:p></o:p></span></p>

<div class="MsoNormal" style="text-align: center;" align="center"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">

<hr size="2" width="100%" align="center">

</span></div>

<p class="MsoNormal" style="text-align: left;" align="left"><b><span style="font-size: 10pt; font-family: 宋体;" lang="EN-US">APPLIES TO<o:p></o:p></span></b></p>

<ul type="disc"><li class="MsoNormal" style="text-align: left;"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">Microsoft
     Internet Explorer 3.01<o:p></o:p></span></li><li class="MsoNormal" style="text-align: left;"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">Microsoft
     Internet Explorer 3.02<o:p></o:p></span></li><li class="MsoNormal" style="text-align: left;"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">Microsoft
     Internet Explorer 4.0 128-Bit Edition<o:p></o:p></span></li><li class="MsoNormal" style="text-align: left;"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">Microsoft
     Internet Explorer 4.01 Service Pack 2<o:p></o:p></span></li><li class="MsoNormal" style="text-align: left;"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">Microsoft
     Visual Basic, Scripting Edition 1.0<o:p></o:p></span></li><li class="MsoNormal" style="text-align: left;"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">Microsoft
     Visual Basic, Scripting Edition 1.1<o:p></o:p></span></li><li class="MsoNormal" style="text-align: left;"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">Microsoft
     Visual Basic, Scripting Edition 2.0<o:p></o:p></span></li><li class="MsoNormal" style="text-align: left;"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">Microsoft
     Foundation Class Library 4.2, when used with:<o:p></o:p></span></li><ul type="circle"><li class="MsoNormal" style="text-align: left;"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">Microsoft Visual
      C++ 5.0 Enterprise Edition<o:p></o:p></span></li><li class="MsoNormal" style="text-align: left;"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US">Microsoft
      Visual C++ 5.0 Professional Edition<o:p></o:p></span></li></ul></ul>

<p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><a href="http://support.microsoft.com/kb/168214/en-us/#top"><span style="text-decoration: none;"><!--[if gte vml 1]><v:shape
 id="_x0000_i1054" type="#_x0000_t75" alt="" style='width:7.5pt;height:7.5pt'
 o:button="t">
 <v:imagedata src="file:///C:\DOCUME~1\hjs\LOCALS~1\Temp\msohtml1\01\clip_image003.gif"
  o:href="http://support.microsoft.com/library/images/support/kbgraphics/public/en-us/uparrow.gif"/>
</v:shape><![endif]--><!--[if !vml]--><img src="file:///C:/DOCUME%7E1/hjs/LOCALS%7E1/Temp/msohtml1/01/clip_image003.gif" v:shapes="_x0000_i1054" width="10" border="0" height="10"><!--[endif]--></span>Back to the top</a><o:p></o:p></span></p>

<p class="MsoNormal"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>

