这个crebar用起来参数真奇怪, 算了, 直接上代码吧:<br />先弄一个基于cdialog的类CMyDlgBar,将基类改为cdialogbar, 需要注意必须修改 constructor(没有参数), OnInitDialog(里面需要初始化)<br /><div class="cnblogs_code"><!--<br /><br />Code highlighting produced by Actipro CodeHighlighter (freeware)<br />http://www.CodeHighlighter.com/<br /><br />--><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" /><span style="color: #0000ff;">class</span><span style="color: #000000;">&nbsp;CMyDlgBar&nbsp;:&nbsp;</span><span style="color: #0000ff;">public</span><span style="color: #000000;">&nbsp;CDialogBar<br /><img id="Codehighlighter1_36_590_Open_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_36_590_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_36_590_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_36_590_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_36_590_Closed_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_36_590_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_36_590_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_36_590_Open_Text').style.display='inline';" align="top"></span><span id="Codehighlighter1_36_590_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;"><img src="http://www.cnblogs.com/Images/dot.gif"  alt="" /></span><span id="Codehighlighter1_36_590_Open_Text"><span style="color: #000000;">{<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;DECLARE_DYNAMIC(CMyDlgBar)<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" /><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" /></span><span style="color: #0000ff;">public</span><span style="color: #000000;">:<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;CMyDlgBar();&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//</span><span style="color: #008000;">&nbsp;standard&nbsp;constructor</span><span style="color: #008000;"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" /></span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">virtual</span><span style="color: #000000;">&nbsp;</span><span style="color: #000000;">~</span><span style="color: #000000;">CMyDlgBar();<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" /><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" /></span><span style="color: #008000;">//</span><span style="color: #008000;">&nbsp;Dialog&nbsp;Data</span><span style="color: #008000;"><br /><img id="Codehighlighter1_160_181_Open_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_160_181_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_160_181_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_160_181_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_160_181_Closed_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_160_181_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_160_181_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_160_181_Open_Text').style.display='inline';" align="top"></span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">enum</span><span style="color: #000000;">&nbsp;</span><span id="Codehighlighter1_160_181_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;"><img src="http://www.cnblogs.com/Images/dot.gif"  alt="" /></span><span id="Codehighlighter1_160_181_Open_Text"><span style="color: #000000;">{&nbsp;IDD&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;IDD_DIALOG1&nbsp;}</span></span><span style="color: #000000;">;<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" /><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" /></span><span style="color: #0000ff;">protected</span><span style="color: #000000;">:<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">virtual</span><span style="color: #000000;">&nbsp;</span><span style="color: #0000ff;">void</span><span style="color: #000000;">&nbsp;DoDataExchange(CDataExchange</span><span style="color: #000000;">*</span><span style="color: #000000;">&nbsp;pDX);&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//</span><span style="color: #008000;">&nbsp;DDX/DDV&nbsp;support</span><span style="color: #008000;"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" /></span><span style="color: #000000;"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;DECLARE_MESSAGE_MAP()<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" /></span><span style="color: #0000ff;">public</span><span style="color: #000000;">:<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">virtual</span><span style="color: #000000;">&nbsp;BOOL&nbsp;Create(CWnd</span><span style="color: #000000;">*</span><span style="color: #000000;">&nbsp;pParentWnd,&nbsp;UINT&nbsp;nIDTemplate,&nbsp;UINT&nbsp;nStyle,&nbsp;UINT&nbsp;nID);<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">int</span><span style="color: #000000;">&nbsp;m_nData;<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;afx_msg&nbsp;</span><span style="color: #0000ff;">void</span><span style="color: #000000;">&nbsp;OnBnClickedOk();<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" /></span><span style="color: #008000;">//</span><span style="color: #008000;">&nbsp;&nbsp;&nbsp;&nbsp;afx_msg&nbsp;void&nbsp;OnBnClickedButton1();</span><span style="color: #008000;"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" /></span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;afx_msg&nbsp;</span><span style="color: #0000ff;">void</span><span style="color: #000000;">&nbsp;OnBnClickedButton1();<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;afx_msg&nbsp;LRESULT&nbsp;OnInitDialog(UINT&nbsp;wParam,LONG&nbsp;lParam);<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" /><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;afx_msg&nbsp;</span><span style="color: #0000ff;">void</span><span style="color: #000000;">&nbsp;OnEnChangeEdit1();<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockEnd.gif" align="top"  alt="" />}</span></span><span style="color: #000000;">;</span></div><br /><div class="cnblogs_code"><!--<br /><br />Code highlighting produced by Actipro CodeHighlighter (freeware)<br />http://www.CodeHighlighter.com/<br /><br />--><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" /><span style="color: #000000;"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" /></span><span style="color: #008000;">//</span><span style="color: #008000;">&nbsp;CMyDlgBar&nbsp;dialog</span><span style="color: #008000;"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" /></span><span style="color: #000000;"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" />IMPLEMENT_DYNAMIC(CMyDlgBar,&nbsp;CDialogBar)<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" /><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" />CMyDlgBar::CMyDlgBar()<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;CDialogBar()<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;,&nbsp;m_nData(</span><span style="color: #800080;">0</span><span style="color: #000000;">)<br /><img id="Codehighlighter1_117_121_Open_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_117_121_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_117_121_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_117_121_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_117_121_Closed_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_117_121_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_117_121_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_117_121_Open_Text').style.display='inline';" align="top"></span><span id="Codehighlighter1_117_121_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;"><img src="http://www.cnblogs.com/Images/dot.gif"  alt="" /></span><span id="Codehighlighter1_117_121_Open_Text"><span style="color: #000000;">{<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" /><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockEnd.gif" align="top"  alt="" />}</span></span><span style="color: #000000;"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" /><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" />CMyDlgBar::</span><span style="color: #000000;">~</span><span style="color: #000000;">CMyDlgBar()<br /><img id="Codehighlighter1_147_150_Open_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_147_150_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_147_150_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_147_150_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_147_150_Closed_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_147_150_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_147_150_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_147_150_Open_Text').style.display='inline';" align="top"></span><span id="Codehighlighter1_147_150_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;"><img src="http://www.cnblogs.com/Images/dot.gif"  alt="" /></span><span id="Codehighlighter1_147_150_Open_Text"><span style="color: #000000;">{<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockEnd.gif" align="top"  alt="" />}</span></span><span style="color: #000000;"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" /><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" /></span><span style="color: #0000ff;">void</span><span style="color: #000000;">&nbsp;CMyDlgBar::DoDataExchange(CDataExchange</span><span style="color: #000000;">*</span><span style="color: #000000;">&nbsp;pDX)<br /><img id="Codehighlighter1_203_240_Open_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_203_240_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_203_240_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_203_240_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_203_240_Closed_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_203_240_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_203_240_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_203_240_Open_Text').style.display='inline';" align="top"></span><span id="Codehighlighter1_203_240_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;"><img src="http://www.cnblogs.com/Images/dot.gif"  alt="" /></span><span id="Codehighlighter1_203_240_Open_Text"><span style="color: #000000;">{<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;CDialogBar::DoDataExchange(pDX);<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockEnd.gif" align="top"  alt="" />}</span></span><span style="color: #000000;"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" /><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" /><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" />BEGIN_MESSAGE_MAP(CMyDlgBar,&nbsp;CDialogBar)<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;ON_BN_CLICKED(IDOK,&nbsp;</span><span style="color: #000000;">&amp;</span><span style="color: #000000;">CMyDlgBar::OnBnClickedOk)<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" /></span><span style="color: #008000;">//</span><span style="color: #008000;">&nbsp;&nbsp;&nbsp;&nbsp;ON_BN_CLICKED(IDC_BUTTON1,&nbsp;&amp;CMyDlgBar::OnBnClickedButton1)</span><span style="color: #008000;"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" /></span><span style="color: #000000;">ON_BN_CLICKED(IDC_BUTTON1,&nbsp;</span><span style="color: #000000;">&amp;</span><span style="color: #000000;">CMyDlgBar::OnBnClickedButton1)<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" />ON_EN_CHANGE(IDC_EDIT1,&nbsp;</span><span style="color: #000000;">&amp;</span><span style="color: #000000;">CMyDlgBar::OnEnChangeEdit1)<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" />ON_MESSAGE(WM_INITDIALOG,OnInitDialog)<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" />END_MESSAGE_MAP()<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" /><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" />LRESULT&nbsp;CMyDlgBar::OnInitDialog(UINT&nbsp;wParam,LONG&nbsp;lParam)<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" /><br /><img id="Codehighlighter1_622_908_Open_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_622_908_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_622_908_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_622_908_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_622_908_Closed_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_622_908_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_622_908_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_622_908_Open_Text').style.display='inline';" align="top"></span><span id="Codehighlighter1_622_908_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;"><img src="http://www.cnblogs.com/Images/dot.gif"  alt="" /></span><span id="Codehighlighter1_622_908_Open_Text"><span style="color: #000000;">{<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" /><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//</span><span style="color: #008000;">&nbsp;TODO:&nbsp;Add&nbsp;extra&nbsp;initialization&nbsp;here</span><span style="color: #008000;"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" /></span><span style="color: #000000;"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;BOOL&nbsp;bRet&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;HandleInitDialog(wParam,lParam);<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" /><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span style="color: #000000;">&nbsp;(</span><span style="color: #000000;">!</span><span style="color: #000000;">UpdateData(FALSE))<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" /><br /><img id="Codehighlighter1_740_782_Open_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_740_782_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_740_782_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_740_782_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_740_782_Closed_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_740_782_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_740_782_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_740_782_Open_Text').style.display='inline';" align="top">&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="Codehighlighter1_740_782_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;"><img src="http://www.cnblogs.com/Images/dot.gif"  alt="" /></span><span id="Codehighlighter1_740_782_Open_Text"><span style="color: #000000;">{<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" /><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TRACE(</span><span style="color: #800000;">"</span><span style="color: #800000;">InitCDataStatus&nbsp;Failed！</span><span style="color: #800000;">"</span><span style="color: #000000;">);<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" /><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="color: #000000;"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" /><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span style="color: #000000;">&nbsp;TRUE;&nbsp;</span><span style="color: #008000;">//</span><span style="color: #008000;">&nbsp;return&nbsp;TRUE&nbsp;unless&nbsp;you&nbsp;set&nbsp;the&nbsp;focus&nbsp;to&nbsp;a&nbsp;control<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" /><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//</span><span style="color: #008000;">&nbsp;EXCEPTION:&nbsp;OCX&nbsp;Property&nbsp;Pages&nbsp;should&nbsp;return&nbsp;FALSE</span><span style="color: #008000;"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" /></span><span style="color: #000000;"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockEnd.gif" align="top"  alt="" />}</span></span><span style="color: #000000;"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" /><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" /></span><span style="color: #008000;">//</span><span style="color: #008000;">&nbsp;CMyDlgBar&nbsp;message&nbsp;handlers</span><span style="color: #008000;"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" /></span><span style="color: #000000;"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" />BOOL&nbsp;CMyDlgBar::Create(CWnd</span><span style="color: #000000;">*</span><span style="color: #000000;">&nbsp;pParentWnd,&nbsp;UINT&nbsp;nIDTemplate,&nbsp;UINT&nbsp;nStyle,&nbsp;UINT&nbsp;nID)<br /><img id="Codehighlighter1_1023_1191_Open_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1023_1191_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_1023_1191_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_1023_1191_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_1023_1191_Closed_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1023_1191_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_1023_1191_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_1023_1191_Open_Text').style.display='inline';" align="top"></span><span id="Codehighlighter1_1023_1191_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;"><img src="http://www.cnblogs.com/Images/dot.gif"  alt="" /></span><span id="Codehighlighter1_1023_1191_Open_Text"><span style="color: #000000;">{<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//</span><span style="color: #008000;">&nbsp;TODO:&nbsp;Add&nbsp;your&nbsp;specialized&nbsp;code&nbsp;here&nbsp;and/or&nbsp;call&nbsp;the&nbsp;base&nbsp;class</span><span style="color: #008000;"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" /></span><span style="color: #000000;"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CDialogBar::Create(pParentWnd,&nbsp;nIDTemplate,&nbsp;nStyle,&nbsp;nID);<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UpdateData(FALSE);<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span style="color: #000000;">&nbsp;TRUE;<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockEnd.gif" align="top"  alt="" />}</span></span><span style="color: #000000;"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" /><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" /></span><span style="color: #0000ff;">void</span><span style="color: #000000;">&nbsp;CMyDlgBar::OnBnClickedOk()<br /><img id="Codehighlighter1_1225_1286_Open_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1225_1286_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_1225_1286_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_1225_1286_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_1225_1286_Closed_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1225_1286_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_1225_1286_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_1225_1286_Open_Text').style.display='inline';" align="top"></span><span id="Codehighlighter1_1225_1286_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;"><img src="http://www.cnblogs.com/Images/dot.gif"  alt="" /></span><span id="Codehighlighter1_1225_1286_Open_Text"><span style="color: #000000;">{<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//</span><span style="color: #008000;">&nbsp;TODO:&nbsp;Add&nbsp;your&nbsp;control&nbsp;notification&nbsp;handler&nbsp;code&nbsp;here</span><span style="color: #008000;"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockEnd.gif" align="top"  alt="" /></span><span style="color: #000000;">}</span></span><span style="color: #000000;"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" /><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" /></span><span style="color: #008000;">//</span><span style="color: #008000;">void&nbsp;CMyDlgBar::OnBnClickedButton1()<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" /></span><span style="color: #008000;">//</span><span style="color: #008000;">{<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" /></span><span style="color: #008000;">//</span><span style="color: #008000;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//</span><span style="color: #008000;">&nbsp;TODO:&nbsp;Add&nbsp;your&nbsp;control&nbsp;notification&nbsp;handler&nbsp;code&nbsp;here<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" /></span><span style="color: #008000;">//</span><span style="color: #008000;">}</span><span style="color: #008000;"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" /></span><span style="color: #000000;"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" /></span><span style="color: #0000ff;">void</span><span style="color: #000000;">&nbsp;CMyDlgBar::OnBnClickedButton1()<br /><img id="Codehighlighter1_1433_1494_Open_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1433_1494_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_1433_1494_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_1433_1494_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_1433_1494_Closed_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1433_1494_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_1433_1494_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_1433_1494_Open_Text').style.display='inline';" align="top"></span><span id="Codehighlighter1_1433_1494_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;"><img src="http://www.cnblogs.com/Images/dot.gif"  alt="" /></span><span id="Codehighlighter1_1433_1494_Open_Text"><span style="color: #000000;">{<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//</span><span style="color: #008000;">&nbsp;TODO:&nbsp;Add&nbsp;your&nbsp;control&nbsp;notification&nbsp;handler&nbsp;code&nbsp;here</span><span style="color: #008000;"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockEnd.gif" align="top"  alt="" /></span><span style="color: #000000;">}</span></span><span style="color: #000000;"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" /><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" /><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" /></span><span style="color: #0000ff;">void</span><span style="color: #000000;">&nbsp;CMyDlgBar::OnEnChangeEdit1()<br /><img id="Codehighlighter1_1531_1861_Open_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1531_1861_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_1531_1861_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_1531_1861_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_1531_1861_Closed_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1531_1861_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_1531_1861_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_1531_1861_Open_Text').style.display='inline';" align="top"></span><span id="Codehighlighter1_1531_1861_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;"><img src="http://www.cnblogs.com/Images/dot.gif"  alt="" /></span><span id="Codehighlighter1_1531_1861_Open_Text"><span style="color: #000000;">{<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//</span><span style="color: #008000;">&nbsp;TODO:&nbsp;&nbsp;If&nbsp;this&nbsp;is&nbsp;a&nbsp;RICHEDIT&nbsp;control,&nbsp;the&nbsp;control&nbsp;will&nbsp;not<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//</span><span style="color: #008000;">&nbsp;send&nbsp;this&nbsp;notification&nbsp;unless&nbsp;you&nbsp;override&nbsp;the&nbsp;CDialogBar::OnInitDialog()<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//</span><span style="color: #008000;">&nbsp;function&nbsp;and&nbsp;call&nbsp;CRichEditCtrl().SetEventMask()<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//</span><span style="color: #008000;">&nbsp;with&nbsp;the&nbsp;ENM_CHANGE&nbsp;flag&nbsp;ORed&nbsp;into&nbsp;the&nbsp;mask.</span><span style="color: #008000;"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" /></span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;MessageBox(L</span><span style="color: #800000;">"</span><span style="color: #800000;">Changed</span><span style="color: #800000;">"</span><span style="color: #000000;">);<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//</span><span style="color: #008000;">&nbsp;TODO:&nbsp;&nbsp;Add&nbsp;your&nbsp;control&nbsp;notification&nbsp;handler&nbsp;code&nbsp;here</span><span style="color: #008000;"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockEnd.gif" align="top"  alt="" /></span><span style="color: #000000;">}</span></span><span style="color: #000000;"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" /><br /><br />在cmainframe里面定义两个变量<br /></span>CMyDlgBar m_barAttrib;<br />&nbsp;&nbsp; &nbsp;CReBar&nbsp;&nbsp; &nbsp;&nbsp; m_wndReBar;<br /><br />必须实现oncreate和oncmdmsg<br /><div class="cnblogs_code"><!--<br /><br />Code highlighting produced by Actipro CodeHighlighter (freeware)<br />http://www.CodeHighlighter.com/<br /><br />--><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" /><span style="color: #000000;"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" /></span><span style="color: #0000ff;">int</span><span style="color: #000000;">&nbsp;CMainFrame::OnCreate(LPCREATESTRUCT&nbsp;lpCreateStruct)<br /><img id="Codehighlighter1_57_1586_Open_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_57_1586_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_57_1586_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_57_1586_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_57_1586_Closed_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_57_1586_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_57_1586_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_57_1586_Open_Text').style.display='inline';" align="top"></span><span id="Codehighlighter1_57_1586_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;"><img src="http://www.cnblogs.com/Images/dot.gif"  alt="" /></span><span id="Codehighlighter1_57_1586_Open_Text"><span style="color: #000000;">{<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span style="color: #000000;">&nbsp;(CFrameWnd::OnCreate(lpCreateStruct)&nbsp;</span><span style="color: #000000;">==</span><span style="color: #000000;">&nbsp;</span><span style="color: #000000;">-</span><span style="color: #800080;">1</span><span style="color: #000000;">)<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span style="color: #000000;">&nbsp;</span><span style="color: #000000;">-</span><span style="color: #800080;">1</span><span style="color: #000000;">;<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span style="color: #000000;">&nbsp;(</span><span style="color: #000000;">!</span><span style="color: #000000;">m_wndToolBar.CreateEx(</span><span style="color: #0000ff;">this</span><span style="color: #000000;">,&nbsp;TBSTYLE_FLAT,&nbsp;WS_CHILD&nbsp;</span><span style="color: #000000;">|</span><span style="color: #000000;">&nbsp;WS_VISIBLE&nbsp;</span><span style="color: #000000;">|</span><span style="color: #000000;">&nbsp;CBRS_TOP<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000;">|</span><span style="color: #000000;">&nbsp;CBRS_GRIPPER&nbsp;</span><span style="color: #000000;">|</span><span style="color: #000000;">&nbsp;CBRS_TOOLTIPS&nbsp;</span><span style="color: #000000;">|</span><span style="color: #000000;">&nbsp;CBRS_FLYBY&nbsp;</span><span style="color: #000000;">|</span><span style="color: #000000;">&nbsp;CBRS_SIZE_DYNAMIC)&nbsp;</span><span style="color: #000000;">||</span><span style="color: #000000;"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000;">!</span><span style="color: #000000;">m_wndToolBar.LoadToolBar(IDR_MAINFRAME))<br /><img id="Codehighlighter1_318_399_Open_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_318_399_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_318_399_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_318_399_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_318_399_Closed_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_318_399_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_318_399_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_318_399_Open_Text').style.display='inline';" align="top">&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="Codehighlighter1_318_399_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;"><img src="http://www.cnblogs.com/Images/dot.gif"  alt="" /></span><span id="Codehighlighter1_318_399_Open_Text"><span style="color: #000000;">{<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TRACE0(</span><span style="color: #800000;">"</span><span style="color: #800000;">Failed&nbsp;to&nbsp;create&nbsp;toolbar\n</span><span style="color: #800000;">"</span><span style="color: #000000;">);<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span style="color: #000000;">&nbsp;</span><span style="color: #000000;">-</span><span style="color: #800080;">1</span><span style="color: #000000;">;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//</span><span style="color: #008000;">&nbsp;fail&nbsp;to&nbsp;create</span><span style="color: #008000;"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"  alt="" /></span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="color: #000000;"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" /><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span style="color: #000000;">&nbsp;(</span><span style="color: #000000;">!</span><span style="color: #000000;">m_wndStatusBar.Create(</span><span style="color: #0000ff;">this</span><span style="color: #000000;">)&nbsp;</span><span style="color: #000000;">||</span><span style="color: #000000;"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000;">!</span><span style="color: #000000;">m_wndStatusBar.SetIndicators(indicators,<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">sizeof</span><span style="color: #000000;">(indicators)</span><span style="color: #000000;">/</span><span style="color: #0000ff;">sizeof</span><span style="color: #000000;">(UINT)))<br /><img id="Codehighlighter1_521_605_Open_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_521_605_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_521_605_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_521_605_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_521_605_Closed_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_521_605_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_521_605_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_521_605_Open_Text').style.display='inline';" align="top">&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="Codehighlighter1_521_605_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;"><img src="http://www.cnblogs.com/Images/dot.gif"  alt="" /></span><span id="Codehighlighter1_521_605_Open_Text"><span style="color: #000000;">{<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TRACE0(</span><span style="color: #800000;">"</span><span style="color: #800000;">Failed&nbsp;to&nbsp;create&nbsp;status&nbsp;bar\n</span><span style="color: #800000;">"</span><span style="color: #000000;">);<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span style="color: #000000;">&nbsp;</span><span style="color: #000000;">-</span><span style="color: #800080;">1</span><span style="color: #000000;">;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//</span><span style="color: #008000;">&nbsp;fail&nbsp;to&nbsp;create</span><span style="color: #008000;"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"  alt="" /></span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="color: #000000;"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" /><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//</span><span style="color: #008000;">&nbsp;TODO:&nbsp;Delete&nbsp;these&nbsp;three&nbsp;lines&nbsp;if&nbsp;you&nbsp;don't&nbsp;want&nbsp;the&nbsp;toolbar&nbsp;to&nbsp;be&nbsp;dockable</span><span style="color: #008000;"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" /></span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span style="color: #000000;">&nbsp;(</span><span style="color: #000000;">!</span><span style="color: #000000;">m_barAttrib.Create(</span><span style="color: #0000ff;">this</span><span style="color: #000000;">,m_barAttrib.IDD,&nbsp;CBRS_ALIGN_RIGHT</span><span style="color: #000000;">|</span><span style="color: #000000;">CBRS_GRIPPER,&nbsp;m_barAttrib.IDD))<br /><img id="Codehighlighter1_784_844_Open_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_784_844_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_784_844_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_784_844_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_784_844_Closed_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_784_844_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_784_844_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_784_844_Open_Text').style.display='inline';" align="top">&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="Codehighlighter1_784_844_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;"><img src="http://www.cnblogs.com/Images/dot.gif"  alt="" /></span><span id="Codehighlighter1_784_844_Open_Text"><span style="color: #000000;">{<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TRACE0(</span><span style="color: #800000;">"</span><span style="color: #800000;">Failed&nbsp;to&nbsp;create&nbsp;dialogbar\n</span><span style="color: #800000;">"</span><span style="color: #000000;">);<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span style="color: #000000;">&nbsp;</span><span style="color: #000000;">-</span><span style="color: #800080;">1</span><span style="color: #000000;">;<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="color: #000000;"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;m_barAttrib.SetWindowText(L</span><span style="color: #800000;">"</span><span style="color: #800000;">部件属性</span><span style="color: #800000;">"</span><span style="color: #000000;">);<br /><img id="Codehighlighter1_883_950_Open_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_883_950_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_883_950_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_883_950_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_883_950_Closed_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_883_950_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_883_950_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_883_950_Open_Text').style.display='inline';" align="top">&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="Codehighlighter1_883_950_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;">/**/</span><span id="Codehighlighter1_883_950_Open_Text"><span style="color: #008000;">/*</span><span style="color: #008000;">XXX是一个资源id手工直接在资源的.h文件中添加一条，不会，这里就不教了。<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;工具条的显示和隐藏代码如下，自己慢慢理解吧：</span><span style="color: #008000;">*/</span></span><span style="color: #000000;"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//</span><span style="color: #008000;">&nbsp;&nbsp;&nbsp;&nbsp;ShowControlBar(&amp;m_barAttrib,&nbsp;(m_barAttrib.GetStyle()&nbsp;&amp;&nbsp;WS_VISIBLE)&nbsp;==&nbsp;0,&nbsp;FALSE);<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" /><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//</span><span style="color: #008000;">m_wndReBar.Create(this);</span><span style="color: #008000;"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" /></span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;m_wndReBar.Create(</span><span style="color: #0000ff;">this</span><span style="color: #000000;">,&nbsp;&nbsp;&nbsp;RBS_AUTOSIZE&nbsp;&nbsp;&nbsp;</span><span style="color: #000000;">|</span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;RBS_BANDBORDERS,<br /><img id="Codehighlighter1_1130_1207_Open_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1130_1207_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_1130_1207_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_1130_1207_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_1130_1207_Closed_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1130_1207_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_1130_1207_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_1130_1207_Open_Text').style.display='inline';" align="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="Codehighlighter1_1130_1207_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;">/**/</span><span id="Codehighlighter1_1130_1207_Open_Text"><span style="color: #008000;">/*</span><span style="color: #008000;">WS_CHILD&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;WS_VISIBLE&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;WS_CLIPSIBLINGS&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;WS_CLIPCHILDREN&nbsp;&nbsp;&nbsp;|&nbsp;</span><span style="color: #008000;">*/</span></span><span style="color: #000000;">&nbsp;&nbsp;CBRS_RIGHT)&nbsp;;<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;m_wndReBar.AddBar(</span><span style="color: #000000;">&amp;</span><span style="color: #000000;">m_barAttrib,NULL,NULL,&nbsp;RBBS_GRIPPERALWAYS</span><span style="color: #000000;">|</span><span style="color: #000000;">RBBS_FIXEDBMP);<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//</span><span style="color: #008000;">m_wndReBar.AddBar(&amp;m_wndToolBar,NULL,NULL,&nbsp;RBBS_GRIPPERALWAYS|RBBS_FIXEDBMP);</span><span style="color: #008000;"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" /></span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;m_barAttrib.EnableDocking(CBRS_ALIGN_ANY);<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;m_wndToolBar.EnableDocking(CBRS_ALIGN_ANY);<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;EnableDocking(CBRS_ALIGN_ANY);<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;DockControlBar(</span><span style="color: #000000;">&amp;</span><span style="color: #000000;">m_barAttrib);<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;DockControlBar(</span><span style="color: #000000;">&amp;</span><span style="color: #000000;">m_wndToolBar);<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span style="color: #000000;">&nbsp;</span><span style="color: #800080;">0</span><span style="color: #000000;">;<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockEnd.gif" align="top"  alt="" />}</span></span><span style="color: #000000;"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" />BOOL&nbsp;CMainFrame::OnCmdMsg(UINT&nbsp;nID,&nbsp;</span><span style="color: #0000ff;">int</span><span style="color: #000000;">&nbsp;nCode,&nbsp;</span><span style="color: #0000ff;">void</span><span style="color: #000000;">*</span><span style="color: #000000;">&nbsp;pExtra,&nbsp;AFX_CMDHANDLERINFO</span><span style="color: #000000;">*</span><span style="color: #000000;">&nbsp;pHandlerInfo)<br /><img id="Codehighlighter1_1682_1892_Open_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1682_1892_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_1682_1892_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_1682_1892_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_1682_1892_Closed_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1682_1892_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_1682_1892_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_1682_1892_Open_Text').style.display='inline';" align="top"></span><span id="Codehighlighter1_1682_1892_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;"><img src="http://www.cnblogs.com/Images/dot.gif"  alt="" /></span><span id="Codehighlighter1_1682_1892_Open_Text"><span style="color: #000000;">{<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//</span><span style="color: #008000;">&nbsp;TODO:&nbsp;Add&nbsp;your&nbsp;specialized&nbsp;code&nbsp;here&nbsp;and/or&nbsp;call&nbsp;the&nbsp;base&nbsp;class</span><span style="color: #008000;"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" /></span><span style="color: #000000;"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span style="color: #000000;">(m_barAttrib.OnCmdMsg(nID,&nbsp;nCode,&nbsp;pExtra,&nbsp;pHandlerInfo))<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span style="color: #000000;">&nbsp;TRUE;<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span style="color: #000000;">&nbsp;CFrameWnd::OnCmdMsg(nID,&nbsp;nCode,&nbsp;pExtra,&nbsp;pHandlerInfo);<br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockEnd.gif" align="top"  alt="" />}</span></span><span style="color: #000000;"><br /><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" /></span></div><br /></div>