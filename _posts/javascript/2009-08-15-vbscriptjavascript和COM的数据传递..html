<!--[if gte mso 9]><xml>  <w:WordDocument>   <w:View>Normal</w:View>   <w:Zoom>0</w:Zoom>   <w:PunctuationKerning/>   <w:DrawingGridVerticalSpacing>7.8 磅</w:DrawingGridVerticalSpacing>   <w:DisplayHorizontalDrawingGridEvery>0</w:DisplayHorizontalDrawingGridEvery>   <w:DisplayVerticalDrawingGridEvery>2</w:DisplayVerticalDrawingGridEvery>   <w:ValidateAgainstSchemas/>   <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>   <w:IgnoreMixedContent>false</w:IgnoreMixedContent>   <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>   <w:Compatibility>    <w:SpaceForUL/>    <w:BalanceSingleByteDoubleByteWidth/>    <w:DoNotLeaveBackslashAlone/>    <w:ULTrailSpace/>    <w:DoNotExpandShiftReturn/>    <w:AdjustLineHeightInTable/>    <w:BreakWrappedTables/>    <w:SnapToGridInCell/>    <w:WrapTextWithPunct/>    <w:UseAsianBreakRules/>    <w:DontGrowAutofit/>    <w:UseFELayout/>   </w:Compatibility>   <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>  </w:WordDocument> </xml><![endif]--><!--[if gte mso 9]><xml>  <w:LatentStyles DefLockedState="false" LatentStyleCount="156">  </w:LatentStyles> </xml><![endif]--><style> <!-- /* Font Definitions */  @font-face 	{font-family:宋体; 	panose-1:2 1 6 0 3 1 1 1 1 1; 	mso-font-alt:SimSun; 	mso-font-charset:134; 	mso-generic-font-family:auto; 	mso-font-pitch:variable; 	mso-font-signature:3 135135232 16 0 262145 0;} @font-face 	{font-family:"\@宋体"; 	panose-1:2 1 6 0 3 1 1 1 1 1; 	mso-font-charset:134; 	mso-generic-font-family:auto; 	mso-font-pitch:variable; 	mso-font-signature:3 135135232 16 0 262145 0;}  /* Style Definitions */  p.MsoNormal, li.MsoNormal, div.MsoNormal 	{mso-style-parent:""; 	margin:0cm; 	margin-bottom:.0001pt; 	text-align:justify; 	text-justify:inter-ideograph; 	mso-pagination:none; 	font-size:10.5pt; 	mso-bidi-font-size:12.0pt; 	font-family:"Times New Roman"; 	mso-fareast-font-family:宋体; 	mso-font-kerning:1.0pt;}  /* Page Definitions */  @page 	{mso-page-border-surround-header:no; 	mso-page-border-surround-footer:no;} @page Section1 	{size:612.0pt 792.0pt; 	margin:72.0pt 90.0pt 72.0pt 90.0pt; 	mso-header-margin:36.0pt; 	mso-footer-margin:36.0pt; 	mso-paper-source:0;} div.Section1 	{page:Section1;}  /* List Definitions */  @list l0 	{mso-list-id:1458838624; 	mso-list-template-ids:-1895797840;} @list l0:level1 	{mso-level-number-format:bullet; 	mso-level-text:; 	mso-level-tab-stop:36.0pt; 	mso-level-number-position:left; 	text-indent:-18.0pt; 	mso-ansi-font-size:10.0pt; 	font-family:Symbol;} @list l0:level2 	{mso-level-number-format:bullet; 	mso-level-text:; 	mso-level-tab-stop:72.0pt; 	mso-level-number-position:left; 	text-indent:-18.0pt; 	mso-ansi-font-size:10.0pt; 	font-family:Symbol;} ol 	{margin-bottom:0cm;} ul 	{margin-bottom:0cm;} --> </style><!--[if gte mso 10]> <style>  /* Style Definitions */  table.MsoNormalTable 	{mso-style-name:普通表格; 	mso-tstyle-rowband-size:0; 	mso-tstyle-colband-size:0; 	mso-style-noshow:yes; 	mso-style-parent:""; 	mso-padding-alt:0cm 5.4pt 0cm 5.4pt; 	mso-para-margin:0cm; 	mso-para-margin-bottom:.0001pt; 	mso-pagination:widow-orphan; 	font-size:10.0pt; 	font-family:"Times New Roman"; 	mso-ansi-language:#0400; 	mso-fareast-language:#0400; 	mso-bidi-language:#0400;} </style> <![endif]-->  <p class="MsoNormal" style="text-align: left;" align="left"><span style="font-size: 12pt; font-family: 宋体;">我们经常会遇到，将脚本中定义的多个参数打包到一个数组中，然后将这个数组传给一个组件方法。<span lang="EN-US">javascript</span>和<span lang="EN-US">vbscript</span>定义数组的方式是不 同的。<span lang="EN-US">vbscript</span>中的数组采用的是自动化兼容类型<span lang="EN-US">SAFEARRAY</span>，对它进行遍历是很方便的。</span>而javascript<span style="font-size: 12pt; font-family: 宋体;">动态脚本的秘密武器－－<span lang="EN-US">是IDispatchEx</span>接口<span lang="EN-US"><br /> &nbsp;&nbsp;&nbsp; </span>对于一个基本的<span lang="EN-US">Object</span>对象，即可以动态的增加或删除属性、方法，也可以生成一个自定义的类，完全基于一个<span lang="EN-US">IDispatchEx</span>接口。<span lang="EN-US"> IDispatchEx</span>是<span lang="EN-US">IDispatch</span>的扩展，为实现动态脚本的一些动态特性量身定制。除了提供<span lang="EN-US">IDispatch</span>接口的所有方法之 外，<span lang="EN-US">IDispatchEx</span>还额外提供以下几个特性：<span lang="EN-US"><o:p></o:p></span></span></p>  <ul type="disc"><ul type="disc"><li class="MsoNormal" style="text-align: left;"><span style="font-size: 12pt; font-family: 宋体; color: #004080;" lang="EN-US">Add new members to an object ("expando") &#8212; use <strong>GetDispID</strong>       with the <strong>fdexNameEnsure</strong> flag. </span><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><o:p></o:p></span></li><li class="MsoNormal" style="text-align: left;"><span style="font-size: 12pt; font-family: 宋体; color: #004080;" lang="EN-US">Delete members of an object &#8212; use <strong>DeleteMemberByName</strong> or <strong>DeleteMemberByDispID</strong>.       </span><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><o:p></o:p></span></li><li class="MsoNormal" style="text-align: left;"><span style="font-size: 12pt; font-family: 宋体; color: #004080;" lang="EN-US">Case-sensitive dispatch operations &#8212; use <strong>fdexNameCaseSensitive</strong>       or <strong>fdexNameCaseInsensitive</strong>. </span><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><o:p></o:p></span></li><li class="MsoNormal" style="text-align: left;"><span style="font-size: 12pt; font-family: 宋体; color: #004080;" lang="EN-US">Search for member with implicit name &#8212; use <strong>fdexNameImplicit</strong>. </span><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><o:p></o:p></span></li><li class="MsoNormal" style="text-align: left;"><span style="font-size: 12pt; font-family: 宋体; color: #004080;" lang="EN-US">Enumerate <strong>DISPID</strong>s of an object &#8212; use <strong>GetNextDispID</strong>. </span><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><o:p></o:p></span></li><li class="MsoNormal" style="text-align: left;"><span style="font-size: 12pt; font-family: 宋体; color: #004080;" lang="EN-US">Map from <strong>DISPID</strong> to element name &#8212; use <strong>GetMemberName</strong>. </span><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><o:p></o:p></span></li><li class="MsoNormal" style="text-align: left;"><span style="font-size: 12pt; font-family: 宋体; color: #004080;" lang="EN-US">Obtain properties of object members &#8212; use <strong>GetMemberProperties</strong>.       </span><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><o:p></o:p></span></li><li class="MsoNormal" style="text-align: left;"><span style="font-size: 12pt; font-family: 宋体; color: #004080;" lang="EN-US">Method invocation with <strong>this</strong> pointer &#8212; use <strong>InvokeEx</strong>       with <strong>DISPATCH_METHOD</strong>. </span><span style="font-size: 12pt; font-family: 宋体;" lang="EN-US"><o:p></o:p></span></li></ul></ul>  <span style="font-size: 12pt; font-family: 宋体; color: #004080;" lang="EN-US">Allow browsers that support the concept of name spaces to obtain the name space parent of an object &#8212; use <strong>GetNameSpaceParent</strong>.</span><!--[if gte mso 9]><xml>  <w:WordDocument>   <w:View>Normal</w:View>   <w:Zoom>0</w:Zoom>   <w:PunctuationKerning/>   <w:DrawingGridVerticalSpacing>7.8 磅</w:DrawingGridVerticalSpacing>   <w:DisplayHorizontalDrawingGridEvery>0</w:DisplayHorizontalDrawingGridEvery>   <w:DisplayVerticalDrawingGridEvery>2</w:DisplayVerticalDrawingGridEvery>   <w:ValidateAgainstSchemas/>   <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>   <w:IgnoreMixedContent>false</w:IgnoreMixedContent>   <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>   <w:Compatibility>    <w:SpaceForUL/>    <w:BalanceSingleByteDoubleByteWidth/>    <w:DoNotLeaveBackslashAlone/>    <w:ULTrailSpace/>    <w:DoNotExpandShiftReturn/>    <w:AdjustLineHeightInTable/>    <w:BreakWrappedTables/>    <w:SnapToGridInCell/>    <w:WrapTextWithPunct/>    <w:UseAsianBreakRules/>    <w:DontGrowAutofit/>    <w:UseFELayout/>   </w:Compatibility>   <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>  </w:WordDocument> </xml><![endif]--><!--[if gte mso 9]><xml>  <w:LatentStyles deflockedstate="false" latentstylecount="156">  </w:LatentStyles> </xml><![endif]--><style> <!-- /* Font Definitions */  @font-face 	{font-family:宋体; 	panose-1:2 1 6 0 3 1 1 1 1 1; 	mso-font-alt:SimSun; 	mso-font-charset:134; 	mso-generic-font-family:auto; 	mso-font-pitch:variable; 	mso-font-signature:3 135135232 16 0 262145 0;} @font-face 	{font-family:"\@宋体"; 	panose-1:2 1 6 0 3 1 1 1 1 1; 	mso-font-charset:134; 	mso-generic-font-family:auto; 	mso-font-pitch:variable; 	mso-font-signature:3 135135232 16 0 262145 0;}  /* Style Definitions */  p.MsoNormal, li.MsoNormal, div.MsoNormal 	{mso-style-parent:""; 	margin:0cm; 	margin-bottom:.0001pt; 	text-align:justify; 	text-justify:inter-ideograph; 	mso-pagination:none; 	font-size:10.5pt; 	mso-bidi-font-size:12.0pt; 	font-family:"Times New Roman"; 	mso-fareast-font-family:宋体; 	mso-font-kerning:1.0pt;}  /* Page Definitions */  @page 	{mso-page-border-surround-header:no; 	mso-page-border-surround-footer:no;} @page Section1 	{size:612.0pt 792.0pt; 	margin:72.0pt 90.0pt 72.0pt 90.0pt; 	mso-header-margin:36.0pt; 	mso-footer-margin:36.0pt; 	mso-paper-source:0;} div.Section1 	{page:Section1;} --> </style><!--[if gte mso 10]> <style>  /* Style Definitions */  table.MsoNormalTable 	{mso-style-name:普通表格; 	mso-tstyle-rowband-size:0; 	mso-tstyle-colband-size:0; 	mso-style-noshow:yes; 	mso-style-parent:""; 	mso-padding-alt:0cm 5.4pt 0cm 5.4pt; 	mso-para-margin:0cm; 	mso-para-margin-bottom:.0001pt; 	mso-pagination:widow-orphan; 	font-size:10.0pt; 	font-family:"Times New Roman"; 	mso-fareast-font-family:"Times New Roman"; 	mso-ansi-language:#0400; 	mso-fareast-language:#0400; 	mso-bidi-language:#0400;} </style> <![endif]--><span style="font-size: 12pt; font-family: 宋体;"></span>, <br /><br />ActiveX组件与JavaScript交互<br />http://hi.baidu.com/huhe/blog/item/817a59ee1ca423f8b3fb95de.html<br />介绍了连接点, 数据传递,等<br /><br />而对于vb的safearray, 推荐使用atl的CComSafeArray&lt;&gt;和CComVariant&lt;&gt;类