---
categories: windows
---
<div>#include &lt;atlstr.h&gt;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;//CString<br /><br />int _tmain(int argc, _TCHAR* argv[])<br />{<br />&nbsp;&nbsp; &nbsp;CoInitialize(NULL);<br /><br />&nbsp;&nbsp; &nbsp;CComPtr&lt;IDispatch&gt; m_pFSO;<br />&nbsp;&nbsp; &nbsp;<br />&nbsp;&nbsp; &nbsp;CComVariant strFolder(_T("C:\\11111") );<br />&nbsp;&nbsp; &nbsp;LPCOLESTR lpszName = L"CreateFolder";<br /><br />&nbsp;&nbsp; &nbsp;m_pFSO.CoCreateInstance ( L"Scripting.FileSystemObject" );<br /><br />#if 1<br />&nbsp;&nbsp; &nbsp;HRESULT hRes = m_pFSO.Invoke1(lpszName, &amp;strFolder);<br />#else<br />&nbsp;&nbsp; &nbsp;DISPID dispid;<br />&nbsp;&nbsp; &nbsp;HRESULT hr = m_pFSO.GetIDOfName(lpszName, &amp;dispid);<br /><br />&nbsp;&nbsp; &nbsp;HRESULT hRes = m_pFSO.Invoke1(dispid, &amp;strFolder);<br />#endif<br /><br />&nbsp;&nbsp; &nbsp;return 0;<br />}<br /></div>