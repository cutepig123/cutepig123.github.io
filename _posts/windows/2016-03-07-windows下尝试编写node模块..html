<p>1，首先参考http://www.cnblogs.com/yupeng/p/3469444.html写了一个模块</p>
<p>2，按照指引运行</p>
<p>F:\Program Files\nodejs\mymodule&gt;<span style="background-color: #ffff00;">node-gyp configure build</span></p>
<p><strong>奶奶的，一开始就少了一个node-gyp,上网一艘，原来这也是一个模块</strong></p>
<p><br />'node-gyp' 不是内部或外部命令，也不是可运行的程序<br />或批处理文件。</p>
<p>F:\Program Files\nodejs\mymodule&gt;<strong>npm install -g node-gyp</strong></p>
<p><strong>安装模块，成功！</strong><br />C:\Users\cutepig\AppData\Roaming\npm\node-gyp -&gt; C:\Users\cutepig\AppData\Roamin<br />g\npm\node_modules\node-gyp\bin\node-gyp.js<br />node-gyp@3.3.1 C:\Users\cutepig\AppData\Roaming\npm\node_modules\node-gyp<br />├── graceful-fs@4.1.3<br />├── osenv@0.1.3 (os-tmpdir@1.0.1, os-homedir@1.0.1)<br />├── semver@5.1.0<br />├── nopt@3.0.6 (abbrev@1.0.7)<br />├── fstream@1.0.8 (inherits@2.0.1)<br />├── which@1.2.4 (isexe@1.1.2, is-absolute@0.1.7)<br />├── minimatch@1.0.0 (sigmund@1.0.1, lru-cache@2.7.3)<br />├── mkdirp@0.5.1 (minimist@0.0.8)<br />├── glob@4.5.3 (inherits@2.0.1, inflight@1.0.4, once@1.3.3, minimatch@2.0.10)</p>
<p>├── rimraf@2.5.2 (glob@7.0.3)<br />├── tar@2.2.1 (inherits@2.0.1, block-stream@0.0.8)<br />├── npmlog@2.0.2 (ansi@0.3.1, gauge@1.2.7, are-we-there-yet@1.0.6)<br />├── path-array@1.0.1 (array-index@1.0.0)<br />└── request@2.69.0 (is-typedarray@1.0.0, aws-sign2@0.6.0, forever-agent@0.6.1<br />, caseless@0.11.0, stringstream@0.0.5, tunnel-agent@0.4.2, oauth-sign@0.8.1, iss<br />tream@0.1.2, json-stringify-safe@5.0.1, extend@3.0.0, node-uuid@1.4.7, qs@6.0.2,<br /> combined-stream@1.0.5, tough-cookie@2.2.1, mime-types@2.1.10, aws4@1.3.2, bl@1.<br />0.3, form-data@1.0.0-rc3, hawk@3.1.3, har-validator@2.0.6, http-signature@1.1.1)</p>
<p><br />F:\Program Files\nodejs\mymodule&gt;<strong>node-gyp</strong></p>
<p>  Usage: node-gyp &lt;command&gt; [options]</p>
<p>  where &lt;command&gt; is one of:<br />    - build - Invokes `msbuild` and builds the module<br />    - clean - Removes any generated build files and the "out" dir<br />    - configure - Generates MSVC project files for the current module<br />    - rebuild - Runs "clean", "configure" and "build" all at once<br />    - install - Install node development files for the specified node version.<br />    - list - Prints a listing of the currently installed node development files<br />    - remove - Removes the node development files for the specified version</p>
<p>node-gyp@3.3.1  C:\Users\cutepig\AppData\Roaming\npm\node_modules\node-gyp<br />node@0.12.0</p>
<p>F:\Program Files\nodejs\mymodule&gt;<strong>node-gyp configure build</strong></p>
<p><strong>再次执行，又莫名其妙失败。说是缺少python定义</strong></p>
<p><br />gyp info it worked if it ends with ok<br />gyp info using node-gyp@3.3.1<br />gyp info using node@0.12.0 | win32 | x64<br />gyp ERR! configure error<br />gyp ERR! stack Error: Can't find Python executable "python", you can set the PYT<br />HON env variable.<br />gyp ERR! stack     at failNoPython (C:\Users\cutepig\AppData\Roaming\npm\node_mo<br />dules\node-gyp\lib\configure.js:401:14)<br />gyp ERR! stack     at C:\Users\cutepig\AppData\Roaming\npm\node_modules\node-gyp<br />\lib\configure.js:356:11<br />gyp ERR! stack     at FSReqWrap.oncomplete (fs.js:99:15)<br />gyp ERR! System Windows_NT 6.1.7601<br />gyp ERR! command "node" "C:\\Users\\cutepig\\AppData\\Roaming\\npm\\node_modules<br />\\node-gyp\\bin\\node-gyp.js" "configure" "build"<br />gyp ERR! cwd F:\Program Files\nodejs\mymodule<br />gyp ERR! node -v v0.12.0<br />gyp ERR! node-gyp -v v3.3.1<br />gyp ERR! not ok</p>
<p>F:\Program Files\nodejs\m</p>
<p>F:\Program Files\nodejs\mymodule&gt;<strong>set PYTHON=F:\sw\Python27\python.exe</strong></p>
<p>F:\Program Files\nodejs\mymodule&gt;<strong>node-gyp configure build</strong></p>
<p><strong>设置好后，运行 ，这个错误没了&nbsp;</strong></p>
<p><strong>但是又多了个莫名其妙的错误 ！</strong></p>
<p><br />gyp info it worked if it ends with ok<br />gyp info using node-gyp@3.3.1<br />gyp info using node@0.12.0 | win32 | x64<br />gyp http GET https://nodejs.org/dist/v0.12.0/node-v0.12.0.tar.gz<br />gyp http 200 https://nodejs.org/dist/v0.12.0/node-v0.12.0.tar.gz<br />gyp http GET https://nodejs.org/dist/v0.12.0/SHASUMS256.txt<br />gyp http GET https://nodejs.org/dist/v0.12.0/x64/node.lib<br />gyp http GET https://nodejs.org/dist/v0.12.0/node.lib<br />gyp http 200 https://nodejs.org/dist/v0.12.0/SHASUMS256.txt<br />gyp http 200 https://nodejs.org/dist/v0.12.0/x64/node.lib<br />gyp http 200 https://nodejs.org/dist/v0.12.0/node.lib<br />gyp info spawn F:\sw\Python27\python.exe<br />gyp info spawn args [ 'C:\\Users\\cutepig\\AppData\\Roaming\\npm\\node_modules\\<br />node-gyp\\gyp\\gyp_main.py',<br />gyp info spawn args   'binding.gyp',<br />gyp info spawn args   '-f',<br />gyp info spawn args   'msvs',<br />gyp info spawn args   '-G',<br />gyp info spawn args   'msvs_version=auto',<br />gyp info spawn args   '-I',<br />gyp info spawn args   'F:\\Program Files\\nodejs\\mymodule\\build\\config.gypi',</p>
<p>gyp info spawn args   '-I',<br />gyp info spawn args   'C:\\Users\\cutepig\\AppData\\Roaming\\npm\\node_modules\\<br />node-gyp\\addon.gypi',<br />gyp info spawn args   '-I',<br />gyp info spawn args   'C:\\Users\\cutepig\\.node-gyp\\0.12.0\\common.gypi',<br />gyp info spawn args   '-Dlibrary=shared_library',<br />gyp info spawn args   '-Dvisibility=default',<br />gyp info spawn args   '-Dnode_root_dir=C:\\Users\\cutepig\\.node-gyp\\0.12.0',<br />gyp info spawn args   '-Dnode_gyp_dir=C:\\Users\\cutepig\\AppData\\Roaming\\npm\<br />\node_modules\\node-gyp',<br />gyp info spawn args   '-Dnode_lib_file=node.lib',<br />gyp info spawn args   '-Dmodule_root_dir=F:\\Program Files\\nodejs\\mymodule',<br />gyp info spawn args   '--depth=.',<br />gyp info spawn args   '--no-parallel',<br />gyp info spawn args   '--generator-output',<br />gyp info spawn args   'F:\\Program Files\\nodejs\\mymodule\\build',<br />gyp info spawn args   '-Goutput_dir=.' ]<br />Traceback (most recent call last):<br />  File "C:\Users\cutepig\AppData\Roaming\npm\node_modules\node-gyp\gyp\gyp_main.<br />py", line 16, in &lt;module&gt;<br />    sys.exit(gyp.script_main())<br />  File "C:\Users\cutepig\AppData\Roaming\npm\node_modules\node-gyp\gyp\pylib\gyp<br />\__init__.py", line 545, in script_main<br />    return main(sys.argv[1:])<br />  File "C:\Users\cutepig\AppData\Roaming\npm\node_modules\node-gyp\gyp\pylib\gyp<br />\__init__.py", line 538, in main<br />    return gyp_main(args)<br />  File "C:\Users\cutepig\AppData\Roaming\npm\node_modules\node-gyp\gyp\pylib\gyp<br />\__init__.py", line 514, in gyp_main<br />    options.duplicate_basename_check)<br />  File "C:\Users\cutepig\AppData\Roaming\npm\node_modules\node-gyp\gyp\pylib\gyp<br />\__init__.py", line 91, in Load<br />    generator = __import__(generator_name, globals(), locals(), generator_name)<br />  File "C:\Users\cutepig\AppData\Roaming\npm\node_modules\node-gyp\gyp\pylib\gyp<br />\generator\msvs.py", line 20, in &lt;module&gt;<br />    import gyp.MSVSUserFile as MSVSUserFile<br />  File "C:\Users\cutepig\AppData\Roaming\npm\node_modules\node-gyp\gyp\pylib\gyp<br />\MSVSUserFile.py", line 9, in &lt;module&gt;<br />    import socket # for gethostname<br />  File "F:\sw\Python27\lib\socket.py", line 47, in &lt;module&gt;<br />    <strong>import _socket</strong><br /><strong>ImportError: DLL load failed</strong>: 找不到指定的程序。<br />gyp ERR! configure error<br />gyp ERR! stack Error: `gyp` failed with exit code: 1<br />gyp ERR! stack     at ChildProcess.onCpExit (C:\Users\cutepig\AppData\Roaming\np<br />m\node_modules\node-gyp\lib\configure.js:305:16)<br />gyp ERR! stack     at ChildProcess.emit (events.js:110:17)<br />gyp ERR! stack     at Process.ChildProcess._handle.onexit (child_process.js:1067<br />:12)<br />gyp ERR! System Windows_NT 6.1.7601<br />gyp ERR! command "node" "C:\\Users\\cutepig\\AppData\\Roaming\\npm\\node_modules<br />\\node-gyp\\bin\\node-gyp.js" "configure" "build"<br />gyp ERR! cwd F:\Program Files\nodejs\mymodule<br />gyp ERR! node -v v0.12.0<br />gyp ERR! node-gyp -v v3.3.1<br />gyp ERR! not ok</p>
<p>F:\Program Files\nodejs\mymodule&gt;</p>
<p>&nbsp;</p>
<p><strong>后来俺换了一个python27，终于没有了socket的错误</strong></p>
<p><strong>但是编译又出了一堆v8的错误！</strong></p>
<p>&nbsp;</p>
<p>F:\Program Files\nodejs\mymodule&gt;node-gyp configure build<br />gyp info it worked if it ends with ok<br />gyp info using node-gyp@3.3.1<br />gyp info using node@0.12.0 | win32 | x64<br />gyp info spawn F:\Python27\python.exe<br />gyp info spawn args [ 'C:\\Users\\cutepig\\AppData\\Roaming\\npm\\node_modules\\node-gyp\\gyp\\gyp_main.py',<br />gyp info spawn args   'binding.gyp',<br />gyp info spawn args   '-f',<br />gyp info spawn args   'msvs',<br />gyp info spawn args   '-G',<br />gyp info spawn args   'msvs_version=auto',<br />gyp info spawn args   '-I',<br />gyp info spawn args   'F:\\Program Files\\nodejs\\mymodule\\build\\config.gypi',<br />gyp info spawn args   '-I',<br />gyp info spawn args   'C:\\Users\\cutepig\\AppData\\Roaming\\npm\\node_modules\\node-gyp\\addon.gypi',<br />gyp info spawn args   '-I',<br />gyp info spawn args   'C:\\Users\\cutepig\\.node-gyp\\0.12.0\\common.gypi',<br />gyp info spawn args   '-Dlibrary=shared_library',<br />gyp info spawn args   '-Dvisibility=default',<br />gyp info spawn args   '-Dnode_root_dir=C:\\Users\\cutepig\\.node-gyp\\0.12.0',<br />gyp info spawn args   '-Dnode_gyp_dir=C:\\Users\\cutepig\\AppData\\Roaming\\npm\\node_modules\\node-gyp',<br />gyp info spawn args   '-Dnode_lib_file=node.lib',<br />gyp info spawn args   '-Dmodule_root_dir=F:\\Program Files\\nodejs\\mymodule',<br />gyp info spawn args   '--depth=.',<br />gyp info spawn args   '--no-parallel',<br />gyp info spawn args   '--generator-output',<br />gyp info spawn args   'F:\\Program Files\\nodejs\\mymodule\\build',<br />gyp info spawn args   '-Goutput_dir=.' ]<br />gyp info spawn C:\Program Files (x86)\MSBuild\12.0\bin\msbuild.exe<br />gyp info spawn args [ 'build/binding.sln',<br />gyp info spawn args   '/clp:Verbosity=minimal',<br />gyp info spawn args   '/nologo',<br />gyp info spawn args   '/p:Configuration=Release;Platform=x64' ]<br />在此解决方案中一次生成一个项目。若要启用并行生成，请添加&ldquo;/m&rdquo;开关。<br />  1.cpp<br />..\1.cpp(6): error C4430: missing type specifier - int assumed. Note: C++ does not support default-int [F:\Program Files\nodejs\mymodule\build\hello.<br />vcxproj]<br />..\1.cpp(6): error C2143: syntax error : missing ',' before '&amp;' [F:\Program Files\nodejs\mymodule\build\hello.vcxproj]<br />..\1.cpp(7): error C2248: 'v8::HandleScope::HandleScope' : cannot access protected member declared in class 'v8::HandleScope' [F:\Program Files\nodej<br />s\mymodule\build\hello.vcxproj]<br />          C:\Users\cutepig\.node-gyp\0.12.0\deps\v8\include\v8.h(816) : see declaration of 'v8::HandleScope::HandleScope'<br />          C:\Users\cutepig\.node-gyp\0.12.0\deps\v8\include\v8.h(800) : see declaration of 'v8::HandleScope'<br />..\1.cpp(8): error C2039: 'Close' : is not a member of 'v8::HandleScope' [F:\Program Files\nodejs\mymodule\build\hello.vcxproj]<br />          C:\Users\cutepig\.node-gyp\0.12.0\deps\v8\include\v8.h(800) : see declaration of 'v8::HandleScope'<br />..\1.cpp(8): error C2039: 'New' : is not a member of 'v8::String' [F:\Program Files\nodejs\mymodule\build\hello.vcxproj]<br />          C:\Users\cutepig\.node-gyp\0.12.0\deps\v8\include\v8.h(1599) : see declaration of 'v8::String'<br />..\1.cpp(8): error C3861: 'New': identifier not found [F:\Program Files\nodejs\mymodule\build\hello.vcxproj]<br />..\1.cpp(12): error C2039: 'NewSymbol' : is not a member of 'v8::String' [F:\Program Files\nodejs\mymodule\build\hello.vcxproj]<br />          C:\Users\cutepig\.node-gyp\0.12.0\deps\v8\include\v8.h(1599) : see declaration of 'v8::String'<br />..\1.cpp(13): error C2664: 'v8::Local&lt;v8::FunctionTemplate&gt; v8::FunctionTemplate::New(v8::Isolate *,v8::FunctionCallback,v8::Handle&lt;v8::Value&gt;,v8::Ha<br />ndle&lt;v8::Signature&gt;,int)' : cannot convert argument 1 from 'v8::Handle&lt;v8::Value&gt; (__cdecl *)(const int)' to 'v8::Isolate *' [F:\Program Files\nodejs<br />\mymodule\build\hello.vcxproj]<br />          There is no context in which this conversion is possible<br />..\1.cpp(13): error C2227: left of '-&gt;GetFunction' must point to class/struct/union/generic type [F:\Program Files\nodejs\mymodule\build\hello.vcxpro<br />j]<br />..\1.cpp(12): error C3861: 'NewSymbol': identifier not found [F:\Program Files\nodejs\mymodule\build\hello.vcxproj]<br />gyp ERR! build error<br />gyp ERR! stack Error: `C:\Program Files (x86)\MSBuild\12.0\bin\msbuild.exe` failed with exit code: 1<br />gyp ERR! stack     at ChildProcess.onExit (C:\Users\cutepig\AppData\Roaming\npm\node_modules\node-gyp\lib\build.js:276:23)<br />gyp ERR! stack     at ChildProcess.emit (events.js:110:17)<br />gyp ERR! stack     at Process.ChildProcess._handle.onexit (child_process.js:1067:12)<br />gyp ERR! System Windows_NT 6.1.7601<br />gyp ERR! command "node" "C:\\Users\\cutepig\\AppData\\Roaming\\npm\\node_modules\\node-gyp\\bin\\node-gyp.js" "configure" "build"<br />gyp ERR! cwd F:\Program Files\nodejs\mymodule<br />gyp ERR! node -v v0.12.0<br />gyp ERR! node-gyp -v v3.3.1<br />gyp ERR! not ok</p>