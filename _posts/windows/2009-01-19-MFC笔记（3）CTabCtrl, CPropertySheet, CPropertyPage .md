---
categories: windows
---
<br>1. 作为CTabCtrl子控件的对话框属性需为Child<br>2. 初始化CTabCtrl<br>m_tab.InsertItem(0,"page0 北京");<br>m_tab.InsertItem(1," page1上海");<br>m_tab.InsertItem(2," page2江西");<br>//建立属性页各页<br>page1.Create(IDD_DIALOG1,GetDlgItem(IDC_TAB1));<br>page2.Create(IDD_DIALOG2,GetDlgItem(IDC_TAB1));<br><br>//设置页面的位置在m_tab控件范围内<br>CRect rs;<br>m_tab.GetClientRect(rs);<br>rs.top+=20;<br>rs.bottom-=4;<br>rs.left+=4;<br>rs.right-=4;<br><br>page1.MoveWindow(rs);<br>page2.MoveWindow(rs);<br><br>page1.ShowWindow(TRUE);<br>m_tab.SetCurSel(1);<br><br>3.响应函数<br><br><br>void CTestView::OnSelchangeTab1(NMHDR* pNMHDR, LRESULT* pResult)<br>{<br>// TODO: Add your control notification handler code here<br>int CurSel;<br>CurSel=m_tab.GetCurSel();<br>&nbsp;&nbsp; &nbsp;switch(CurSel)<br>&nbsp;&nbsp; &nbsp;{<br>&nbsp;&nbsp; &nbsp;case 0:<br>&nbsp;&nbsp; &nbsp;page1.ShowWindow(FALSE);<br>&nbsp;&nbsp; &nbsp;page2.ShowWindow(FALSE);<br>&nbsp;&nbsp; &nbsp;..<br>&nbsp;&nbsp; &nbsp;break;<br>&nbsp;&nbsp; &nbsp;default: ;<br>&nbsp;&nbsp; &nbsp;}<br><br>*pResult = 0;<br>} <br>