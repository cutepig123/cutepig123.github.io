nafxcw.lib&nbsp;&nbsp; &nbsp;for MFC Static&nbsp; Link Library<br /><br />Use of MFC in a Shared&nbsp; DLL : _AFXDLL&nbsp; in "preprocessor definitions" list defined<br /><br />When Using both CRT and MFC libraries together you need to be careful. In such cases its important for MFC libraries to get linked before CRT libraries.<br /><br />If you are using MFC, you need to link libc.lib before msvcrt.lib. You can do this by explicitely setting linker option.<br /><br />please go through this link... http://support.microsoft.com/kb/148652<br />problem while linking CRT and MFC together <br /><br />Great!!! Thanks alot sach!!<br /><br />The solution I used was as per the link and creating a new header file, ForceLib.h. The file looks like this:<br />Code:<br />#ifndef _AFX_NOFORCE_LIBS<br /><br />/////////////////////////////////////////////////////////////////////////////<br />// Win32 libraries<br /><br />#ifndef _AFXDLL<br />&nbsp;&nbsp; &nbsp;#ifndef _UNICODE<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;#ifdef _DEBUG<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;#pragma comment(lib, "nafxcwd.lib")<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;#else<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;#pragma comment(lib, "nafxcw.lib")<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;#endif<br />&nbsp;&nbsp; &nbsp;#else<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;#ifdef _DEBUG<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;#pragma comment(lib, "uafxcwd.lib")<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;#else<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;#pragma comment(lib, "uafxcw.lib")<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;#endif<br />&nbsp;&nbsp; &nbsp;#endif<br />#else<br />&nbsp;&nbsp; &nbsp;#ifndef _UNICODE<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;#ifdef _DEBUG<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;#pragma comment(lib, "mfc71d.lib")<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;#pragma comment(lib, "mfcs71d.lib")<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;#else<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;#pragma comment(lib, "mfc71.lib")<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;#pragma comment(lib, "mfcs71.lib")<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;#endif<br />&nbsp;&nbsp; &nbsp;#else<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;#ifdef _DEBUG<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;#pragma comment(lib, "mfc71ud.lib")<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;#pragma comment(lib, "mfcs71ud.lib")<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;#else<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;#pragma comment(lib, "mfc71u.lib")<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;#pragma comment(lib, "mfcs71u.lib")<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;#endif<br />&nbsp;&nbsp; &nbsp;#endif<br />#endif<br /><br />#ifdef _DLL<br />&nbsp;&nbsp; &nbsp;#if !defined(_AFX_NO_DEBUG_CRT) &amp;&amp; defined(_DEBUG)<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;#pragma comment(lib, "msvcrtd.lib")<br />&nbsp;&nbsp; &nbsp;#else<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;#pragma comment(lib, "msvcrt.lib")<br />&nbsp;&nbsp; &nbsp;#endif<br />#else<br />#ifdef _MT<br />&nbsp;&nbsp; &nbsp;#if !defined(_AFX_NO_DEBUG_CRT) &amp;&amp; defined(_DEBUG)<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;#pragma comment(lib, "libcmtd.lib")<br />&nbsp;&nbsp; &nbsp;#else<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;#pragma comment(lib, "libcmt.lib")<br />&nbsp;&nbsp; &nbsp;#endif<br />#else<br />&nbsp;&nbsp; &nbsp;#if !defined(_AFX_NO_DEBUG_CRT) &amp;&amp; defined(_DEBUG)<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;#pragma comment(lib, "libcd.lib")<br />&nbsp;&nbsp; &nbsp;#else<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;#pragma comment(lib, "libc.lib")<br />&nbsp;&nbsp; &nbsp;#endif<br />#endif<br />#endif<br /><br />#pragma comment(lib, "kernel32.lib")<br />#pragma comment(lib, "user32.lib")<br />#pragma comment(lib, "gdi32.lib")<br />#pragma comment(lib, "msimg32.lib")<br />#pragma comment(lib, "comdlg32.lib")<br />#pragma comment(lib, "winspool.lib")<br />#pragma comment(lib, "advapi32.lib")<br />#pragma comment(lib, "shell32.lib")<br />#pragma comment(lib, "comctl32.lib")<br />#pragma comment(lib, "shlwapi.lib")<br /><br />// force inclusion of NOLIB.OBJ for /disallowlib directives<br />#pragma comment(linker, "/include:__afxForceEXCLUDE")<br /><br />// force inclusion of DLLMODUL.OBJ for _USRDLL<br />#ifdef _USRDLL<br />#pragma comment(linker, "/include:__afxForceUSRDLL")<br />#endif<br /><br />// force inclusion of STDAFX.OBJ for precompiled types<br />#ifdef _AFXDLL<br />#pragma comment(linker, "/include:__afxForceSTDAFX")<br />#endif<br /><br />#endif //!_AFX_NOFORCE_LIBS<br /><br />