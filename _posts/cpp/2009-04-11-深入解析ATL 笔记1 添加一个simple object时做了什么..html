<p>在图书馆拿到这本不错的书，英文名为&#8220;ATL Internals&#8221;，第二版，用的是VC2005和ATL8。作者都是很牛的，决定好好看一下，补充一下ATL, COM的知识。一边看一遍记笔记，。。恩。。 </p><p>首先新建一个ATL dll 工程，添加一个ATL Simple Object, 设置用default，然后用winmerge看看多了什么东西 .<br /></p><p>添加的文件：</p><p>&nbsp;</p><p>SimpleObj2.cpp</p><p>SimpleObj2.h</p><p>SimpleObj2.rgs<br /><br /> </p><p>修改的文件：</p><p>atlDemo.idl<br />atlDemo.rc<br />atlDemo.vcproj<br />resource.h<br /></p><p><br /></p><p>先看看修改的文件，主要是idl<br /></p><div class="cnblogs_code"><!--<br /><br />Code highlighting produced by Actipro CodeHighlighter (freeware)<br />http://www.CodeHighlighter.com/<br /><br />--><span style="color: #008080;">&nbsp;1</span><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /><span style="color: #000000;">[<br /></span><span style="color: #008080;">&nbsp;2</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">object</span><span style="color: #000000;">,<br /></span><span style="color: #008080;">&nbsp;3</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;uuid(66B9309A-</span><span style="color: #800080;">2907</span><span style="color: #000000;">-44CD-8DE9-0B5D774147DD),<br /></span><span style="color: #008080;">&nbsp;4</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;dual,<br /></span><span style="color: #008080;">&nbsp;5</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;nonextensible,<br /></span><span style="color: #008080;">&nbsp;6</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;helpstring(</span><span style="color: #800000;">"</span><span style="color: #800000;">ISimpleObj2&nbsp;Interface</span><span style="color: #800000;">"</span><span style="color: #000000;">),<br /></span><span style="color: #008080;">&nbsp;7</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;pointer_default(unique)<br /></span><span style="color: #008080;">&nbsp;8</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />]<br /></span><span style="color: #008080;">&nbsp;9</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />interface&nbsp;ISimpleObj2&nbsp;:&nbsp;IDispatch{<br /></span><span style="color: #008080;">10</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />};</span></div><p>&nbsp;</p><p>以及在library atlDemoLib下面添加的</p><p>&nbsp;</p><div><span style="color: #008080;">&nbsp;1</span><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /><span style="color: #000000;">[<br /></span><span style="color: #008080;">&nbsp;2</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uuid(24A41D8D-</span><span style="color: #800080;">5367</span><span style="color: #000000;">-4C6B-A7D3-3930361A7387),<br /></span><span style="color: #008080;">&nbsp;3</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;helpstring(</span><span style="color: #800000;">"</span><span style="color: #800000;">_ISimpleObj2Events&nbsp;Interface</span><span style="color: #800000;">"</span><span style="color: #000000;">)<br /></span><span style="color: #008080;">&nbsp;4</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;]<br /></span><span style="color: #008080;">&nbsp;5</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;dispinterface&nbsp;_ISimpleObj2Events<br /></span><span style="color: #008080;">&nbsp;6</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;{<br /></span><span style="color: #008080;">&nbsp;7</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #ff00ff;">properties:</span><span style="color: #000000;"><br /></span><span style="color: #008080;">&nbsp;8</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #ff00ff;">methods:</span><span style="color: #000000;"><br /></span><span style="color: #008080;">&nbsp;9</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;};<br /></span><span style="color: #008080;">10</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;[<br /></span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uuid(220C4A97-B240-</span><span style="color: #800080;">4443</span><span style="color: #000000;">-BEE9-73D15D66B92D),<br /></span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;helpstring(</span><span style="color: #800000;">"</span><span style="color: #800000;">SimpleObj2&nbsp;Class</span><span style="color: #800000;">"</span><span style="color: #000000;">)<br /></span><span style="color: #008080;">13</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;]<br /></span><span style="color: #008080;">14</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;coclass&nbsp;SimpleObj2<br /></span><span style="color: #008080;">15</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;{<br /></span><span style="color: #008080;">16</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[default]&nbsp;interface&nbsp;ISimpleObj2;<br /></span><span style="color: #008080;">17</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[default,&nbsp;source]&nbsp;dispinterface&nbsp;_ISimpleObj2Events;<br /></span> <p><span style="color: #008080;">18</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;};</span></p> <p>&nbsp;</p></div><p>&nbsp;多了的文件内容</p><p>_ISimpleObj2Events_CP.h：</p><div class="cnblogs_code"><!--<br /><br />Code highlighting produced by Actipro CodeHighlighter (freeware)<br />http://www.CodeHighlighter.com/<br /><br />--><span style="color: #008080;">1</span><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /><span style="color: #0000ff;">#pragma</span><span style="color: #000000;">&nbsp;once</span><span style="color: #000000;"><br /></span><span style="color: #008080;">2</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /><br /></span><span style="color: #008080;">3</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />template&nbsp;</span><span style="color: #000000;">&lt;</span><span style="color: #0000ff;">class</span><span style="color: #000000;">&nbsp;T</span><span style="color: #000000;">&gt;</span><span style="color: #000000;"><br /></span><span style="color: #008080;">4</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /></span><span style="color: #0000ff;">class</span><span style="color: #000000;">&nbsp;CProxy_ISimpleObj2Events&nbsp;:&nbsp;</span><span style="color: #0000ff;">public</span><span style="color: #000000;">&nbsp;IConnectionPointImpl</span><span style="color: #000000;">&lt;</span><span style="color: #000000;">T,&nbsp;</span><span style="color: #000000;">&amp;</span><span style="color: #000000;">__uuidof(&nbsp;_ISimpleObj2Events&nbsp;),&nbsp;CComDynamicUnkArray</span><span style="color: #000000;">&gt;</span><span style="color: #000000;"><br /></span><span style="color: #008080;">5</span><span style="color: #000000;"><img id="Codehighlighter1_151_220_Open_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_151_220_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_151_220_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_151_220_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_151_220_Closed_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_151_220_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_151_220_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_151_220_Open_Text').style.display='inline';" align="top"></span><span id="Codehighlighter1_151_220_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;"><img src="http://www.cnblogs.com/Images/dot.gif" alt="" /></span><span id="Codehighlighter1_151_220_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;">6</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//</span><span style="color: #008000;">Warning&nbsp;this&nbsp;class&nbsp;will&nbsp;&nbsp;be&nbsp;regenerated&nbsp;by&nbsp;the&nbsp;wizard.</span><span style="color: #008000;"><br /></span><span style="color: #008080;">7</span><span style="color: #008000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /></span><span style="color: #0000ff;">public</span><span style="color: #000000;">:<br /></span><span style="color: #008080;">8</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockEnd.gif" alt="" align="top" />}</span></span><span style="color: #000000;">;<br /></span><span style="color: #008080;">9</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /></span></div><p> </p><p>&nbsp;SimpleObj2.cpp：</p><div class="cnblogs_code"><!--<br /><br />Code highlighting produced by Actipro CodeHighlighter (freeware)<br />http://www.CodeHighlighter.com/<br /><br />--><span style="color: #008080;">1</span><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /><span style="color: #008000;">//</span><span style="color: #008000;">&nbsp;SimpleObj2.cpp&nbsp;:&nbsp;Implementation&nbsp;of&nbsp;CSimpleObj2</span><span style="color: #008000;"><br /></span><span style="color: #008080;">2</span><span style="color: #008000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /></span><span style="color: #000000;"><br /></span><span style="color: #008080;">3</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />#include&nbsp;</span><span style="color: #800000;">"</span><span style="color: #800000;">stdafx.h</span><span style="color: #800000;">"</span><span style="color: #000000;"><br /></span><span style="color: #008080;">4</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />#include&nbsp;</span><span style="color: #800000;">"</span><span style="color: #800000;">SimpleObj2.h</span><span style="color: #800000;">"</span><span style="color: #000000;"><br /></span><span style="color: #008080;">5</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /><br /></span><span style="color: #008080;">6</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /><br /></span><span style="color: #008080;">7</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /></span><span style="color: #008000;">//</span><span style="color: #008000;">&nbsp;CSimpleObj2</span><span style="color: #008000;"><br /></span><span style="color: #008080;">8</span><span style="color: #008000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /></span><span style="color: #000000;"><br /></span><span style="color: #008080;">9</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /></span></div><p>SimpleObj2.h</p><div class="cnblogs_code"><!--<br /><br />Code highlighting produced by Actipro CodeHighlighter (freeware)<br />http://www.CodeHighlighter.com/<br /><br />--><span style="color: #008080;">&nbsp;1</span><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /><span style="color: #008000;">//</span><span style="color: #008000;">&nbsp;SimpleObj2.h&nbsp;:&nbsp;Declaration&nbsp;of&nbsp;the&nbsp;CSimpleObj2</span><span style="color: #008000;"><br /></span><span style="color: #008080;">&nbsp;2</span><span style="color: #008000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /></span><span style="color: #000000;"><br /></span><span style="color: #008080;">&nbsp;3</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /></span><span style="color: #0000ff;">#pragma</span><span style="color: #000000;">&nbsp;once</span><span style="color: #000000;"><br /></span><span style="color: #008080;">&nbsp;4</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />#include&nbsp;</span><span style="color: #800000;">"</span><span style="color: #800000;">resource.h</span><span style="color: #800000;">"</span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//</span><span style="color: #008000;">&nbsp;main&nbsp;symbols</span><span style="color: #008000;"><br /></span><span style="color: #008080;">&nbsp;5</span><span style="color: #008000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /></span><span style="color: #000000;"><br /></span><span style="color: #008080;">&nbsp;6</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />#include&nbsp;</span><span style="color: #800000;">"</span><span style="color: #800000;">atlDemo_i.h</span><span style="color: #800000;">"</span><span style="color: #000000;"><br /></span><span style="color: #008080;">&nbsp;7</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />#include&nbsp;</span><span style="color: #800000;">"</span><span style="color: #800000;">_ISimpleObj2Events_CP.h</span><span style="color: #800000;">"</span><span style="color: #000000;"><br /></span><span style="color: #008080;">&nbsp;8</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /><br /></span><span style="color: #008080;">&nbsp;9</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /><br /></span><span style="color: #008080;">10</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /></span><span style="color: #0000ff;">#if</span><span style="color: #000000;">&nbsp;defined(_WIN32_WCE)&nbsp;&amp;&amp;&nbsp;!defined(_CE_DCOM)&nbsp;&amp;&amp;&nbsp;!defined(_CE_ALLOW_SINGLE_THREADED_OBJECTS_IN_MTA)</span><span style="color: #000000;"><br /></span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /></span><span style="color: #0000ff;">#error</span><span style="color: #000000;">&nbsp;"Single-threaded&nbsp;COM&nbsp;objects&nbsp;are&nbsp;not&nbsp;properly&nbsp;supported&nbsp;on&nbsp;Windows&nbsp;CE&nbsp;platform,&nbsp;such&nbsp;as&nbsp;the&nbsp;Windows&nbsp;Mobile&nbsp;platforms&nbsp;that&nbsp;do&nbsp;not&nbsp;include&nbsp;full&nbsp;DCOM&nbsp;support.&nbsp;Define&nbsp;_CE_ALLOW_SINGLE_THREADED_OBJECTS_IN_MTA&nbsp;to&nbsp;force&nbsp;ATL&nbsp;to&nbsp;support&nbsp;creating&nbsp;single-thread&nbsp;COM&nbsp;object's&nbsp;and&nbsp;allow&nbsp;use&nbsp;of&nbsp;it's&nbsp;single-threaded&nbsp;COM&nbsp;object&nbsp;implementations.&nbsp;The&nbsp;threading&nbsp;model&nbsp;in&nbsp;your&nbsp;rgs&nbsp;file&nbsp;was&nbsp;set&nbsp;to&nbsp;'Free'&nbsp;as&nbsp;that&nbsp;is&nbsp;the&nbsp;only&nbsp;threading&nbsp;model&nbsp;supported&nbsp;in&nbsp;non&nbsp;DCOM&nbsp;Windows&nbsp;CE&nbsp;platforms."</span><span style="color: #000000;"><br /></span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /></span><span style="color: #0000ff;">#endif</span><span style="color: #000000;"><br /></span><span style="color: #008080;">13</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /><br /></span><span style="color: #008080;">14</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /><br /></span><span style="color: #008080;">15</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /><br /></span><span style="color: #008080;">16</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /></span><span style="color: #008000;">//</span><span style="color: #008000;">&nbsp;CSimpleObj2</span><span style="color: #008000;"><br /></span><span style="color: #008080;">17</span><span style="color: #008000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /></span><span style="color: #000000;"><br /></span><span style="color: #008080;">18</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /></span><span style="color: #0000ff;">class</span><span style="color: #000000;">&nbsp;ATL_NO_VTABLE&nbsp;CSimpleObj2&nbsp;:<br /></span><span style="color: #008080;">19</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">public</span><span style="color: #000000;">&nbsp;CComObjectRootEx</span><span style="color: #000000;">&lt;</span><span style="color: #000000;">CComSingleThreadModel</span><span style="color: #000000;">&gt;</span><span style="color: #000000;">,<br /></span><span style="color: #008080;">20</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">public</span><span style="color: #000000;">&nbsp;CComCoClass</span><span style="color: #000000;">&lt;</span><span style="color: #000000;">CSimpleObj2,&nbsp;</span><span style="color: #000000;">&amp;</span><span style="color: #000000;">CLSID_SimpleObj2</span><span style="color: #000000;">&gt;</span><span style="color: #000000;">,<br /></span><span style="color: #008080;">21</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">public</span><span style="color: #000000;">&nbsp;IConnectionPointContainerImpl</span><span style="color: #000000;">&lt;</span><span style="color: #000000;">CSimpleObj2</span><span style="color: #000000;">&gt;</span><span style="color: #000000;">,<br /></span><span style="color: #008080;">22</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">public</span><span style="color: #000000;">&nbsp;CProxy_ISimpleObj2Events</span><span style="color: #000000;">&lt;</span><span style="color: #000000;">CSimpleObj2</span><span style="color: #000000;">&gt;</span><span style="color: #000000;">,<br /></span><span style="color: #008080;">23</span><span style="color: #000000;"><img id="Codehighlighter1_1074_1086_Open_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1074_1086_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_1074_1086_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_1074_1086_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_1074_1086_Closed_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1074_1086_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_1074_1086_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_1074_1086_Open_Text').style.display='inline';" align="top">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">public</span><span style="color: #000000;">&nbsp;IDispatchImpl</span><span style="color: #000000;">&lt;</span><span style="color: #000000;">ISimpleObj2,&nbsp;</span><span style="color: #000000;">&amp;</span><span style="color: #000000;">IID_ISimpleObj2,&nbsp;</span><span style="color: #000000;">&amp;</span><span style="color: #000000;">LIBID_atlDemoLib,&nbsp;</span><span id="Codehighlighter1_1074_1086_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;">/**/</span><span id="Codehighlighter1_1074_1086_Open_Text"><span style="color: #008000;">/*</span><span style="color: #008000;">wMajor&nbsp;=</span><span style="color: #008000;">*/</span></span><span style="color: #000000;">&nbsp;</span><span style="color: #800080;">1</span><span style="color: #000000;">,&nbsp;</span><span id="Codehighlighter1_1090_1102_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;">/**/</span><span id="Codehighlighter1_1090_1102_Open_Text"><span style="color: #008000;">/*</span><span style="color: #008000;">wMinor&nbsp;=</span><span style="color: #008000;">*/</span></span><span style="color: #000000;">&nbsp;</span><span style="color: #800080;">0</span><span style="color: #000000;">&gt;</span><span style="color: #000000;"><br /></span><span style="color: #008080;">24</span><span style="color: #000000;"><img id="Codehighlighter1_1106_1585_Open_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1106_1585_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_1106_1585_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_1106_1585_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_1106_1585_Closed_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1106_1585_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_1106_1585_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_1106_1585_Open_Text').style.display='inline';" align="top"></span><span id="Codehighlighter1_1106_1585_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;"><img src="http://www.cnblogs.com/Images/dot.gif" alt="" /></span><span id="Codehighlighter1_1106_1585_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;">25</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /></span><span style="color: #0000ff;">public</span><span style="color: #000000;">:<br /></span><span style="color: #008080;">26</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;CSimpleObj2()<br /></span><span style="color: #008080;">27</span><span style="color: #000000;"><img id="Codehighlighter1_1132_1136_Open_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1132_1136_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_1132_1136_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_1132_1136_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_1132_1136_Closed_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1132_1136_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_1132_1136_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_1132_1136_Open_Text').style.display='inline';" align="top">&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="Codehighlighter1_1132_1136_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;"><img src="http://www.cnblogs.com/Images/dot.gif" alt="" /></span><span id="Codehighlighter1_1132_1136_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;">28</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="color: #000000;"><br /></span><span style="color: #008080;">29</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /><br /></span><span style="color: #008080;">30</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" />DECLARE_REGISTRY_RESOURCEID(IDR_SIMPLEOBJ2)<br /></span><span style="color: #008080;">31</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /><br /></span><span style="color: #008080;">32</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /><br /></span><span style="color: #008080;">33</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" />BEGIN_COM_MAP(CSimpleObj2)<br /></span><span style="color: #008080;">34</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;COM_INTERFACE_ENTRY(ISimpleObj2)<br /></span><span style="color: #008080;">35</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;COM_INTERFACE_ENTRY(IDispatch)<br /></span><span style="color: #008080;">36</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;COM_INTERFACE_ENTRY(IConnectionPointContainer)<br /></span><span style="color: #008080;">37</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" />END_COM_MAP()<br /></span><span style="color: #008080;">38</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /><br /></span><span style="color: #008080;">39</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" />BEGIN_CONNECTION_POINT_MAP(CSimpleObj2)<br /></span><span style="color: #008080;">40</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;CONNECTION_POINT_ENTRY(__uuidof(_ISimpleObj2Events))<br /></span><span style="color: #008080;">41</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" />END_CONNECTION_POINT_MAP()<br /></span><span style="color: #008080;">42</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /><br /></span><span style="color: #008080;">43</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /><br /></span><span style="color: #008080;">44</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;DECLARE_PROTECT_FINAL_CONSTRUCT()<br /></span><span style="color: #008080;">45</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /><br /></span><span style="color: #008080;">46</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;HRESULT&nbsp;FinalConstruct()<br /></span><span style="color: #008080;">47</span><span style="color: #000000;"><img id="Codehighlighter1_1526_1545_Open_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1526_1545_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_1526_1545_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_1526_1545_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_1526_1545_Closed_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1526_1545_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_1526_1545_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_1526_1545_Open_Text').style.display='inline';" align="top">&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="Codehighlighter1_1526_1545_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;"><img src="http://www.cnblogs.com/Images/dot.gif" alt="" /></span><span id="Codehighlighter1_1526_1545_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;">48</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span style="color: #000000;">&nbsp;S_OK;<br /></span><span style="color: #008080;">49</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="color: #000000;"><br /></span><span style="color: #008080;">50</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /><br /></span><span style="color: #008080;">51</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">void</span><span style="color: #000000;">&nbsp;FinalRelease()<br /></span><span style="color: #008080;">52</span><span style="color: #000000;"><img id="Codehighlighter1_1569_1573_Open_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1569_1573_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_1569_1573_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_1569_1573_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_1569_1573_Closed_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1569_1573_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_1569_1573_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_1569_1573_Open_Text').style.display='inline';" align="top">&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="Codehighlighter1_1569_1573_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;"><img src="http://www.cnblogs.com/Images/dot.gif" alt="" /></span><span id="Codehighlighter1_1569_1573_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;">53</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="color: #000000;"><br /></span><span style="color: #008080;">54</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /><br /></span><span style="color: #008080;">55</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /></span><span style="color: #0000ff;">public</span><span style="color: #000000;">:<br /></span><span style="color: #008080;">56</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /><br /></span><span style="color: #008080;">57</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockEnd.gif" alt="" align="top" />}</span></span><span style="color: #000000;">;<br /></span><span style="color: #008080;">58</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /><br /></span><span style="color: #008080;">59</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />OBJECT_ENTRY_AUTO(__uuidof(SimpleObj2),&nbsp;CSimpleObj2)<br /></span><span style="color: #008080;">60</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /></span></div><p> </p><p>&nbsp;SimpleObj2.rgs</p><div class="cnblogs_code"><!--<br /><br />Code highlighting produced by Actipro CodeHighlighter (freeware)<br />http://www.CodeHighlighter.com/<br /><br />--><span style="color: #008080;">&nbsp;1</span><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /><span style="color: #000000;">HKCR<br /></span><span style="color: #008080;">&nbsp;2</span><span style="color: #000000;"><img id="Codehighlighter1_5_616_Open_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_5_616_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_5_616_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_5_616_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_5_616_Closed_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_5_616_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_5_616_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_5_616_Open_Text').style.display='inline';" align="top"></span><span id="Codehighlighter1_5_616_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;"><img src="http://www.cnblogs.com/Images/dot.gif" alt="" /></span><span id="Codehighlighter1_5_616_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;">&nbsp;3</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;atlDemo.SimpleObj2.</span><span style="color: #800080;">1</span><span style="color: #000000;">&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;s&nbsp;</span><span style="color: #800000;">'</span><span style="color: #800000;">SimpleObj2&nbsp;Class</span><span style="color: #800000;">'</span><span style="color: #000000;"><br /></span><span style="color: #008080;">&nbsp;4</span><span style="color: #000000;"><img id="Codehighlighter1_53_110_Open_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_53_110_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_53_110_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_53_110_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_53_110_Closed_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_53_110_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_53_110_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_53_110_Open_Text').style.display='inline';" align="top">&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="Codehighlighter1_53_110_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;"><img src="http://www.cnblogs.com/Images/dot.gif" alt="" /></span><span id="Codehighlighter1_53_110_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;">&nbsp;5</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLSID&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;s&nbsp;</span><span style="color: #800000;">'</span><span style="color: #800000;">{220C4A97-B240-4443-BEE9-73D15D66B92D}</span><span style="color: #800000;">'</span><span style="color: #000000;"><br /></span><span style="color: #008080;">&nbsp;6</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="color: #000000;"><br /></span><span style="color: #008080;">&nbsp;7</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;atlDemo.SimpleObj2&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;s&nbsp;</span><span style="color: #800000;">'</span><span style="color: #800000;">SimpleObj2&nbsp;Class</span><span style="color: #800000;">'</span><span style="color: #000000;"><br /></span><span style="color: #008080;">&nbsp;8</span><span style="color: #000000;"><img id="Codehighlighter1_155_248_Open_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_155_248_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_155_248_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_155_248_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_155_248_Closed_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_155_248_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_155_248_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_155_248_Open_Text').style.display='inline';" align="top">&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="Codehighlighter1_155_248_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;"><img src="http://www.cnblogs.com/Images/dot.gif" alt="" /></span><span id="Codehighlighter1_155_248_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;">&nbsp;9</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLSID&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;s&nbsp;</span><span style="color: #800000;">'</span><span style="color: #800000;">{220C4A97-B240-4443-BEE9-73D15D66B92D}</span><span style="color: #800000;">'</span><span style="color: #000000;"><br /></span><span style="color: #008080;">10</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CurVer&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;s&nbsp;</span><span style="color: #800000;">'</span><span style="color: #800000;">atlDemo.SimpleObj2.1</span><span style="color: #800000;">'</span><span style="color: #000000;"><br /></span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="color: #000000;"><br /></span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;NoRemove&nbsp;CLSID<br /></span><span style="color: #008080;">13</span><span style="color: #000000;"><img id="Codehighlighter1_266_614_Open_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_266_614_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_266_614_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_266_614_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_266_614_Closed_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_266_614_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_266_614_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_266_614_Open_Text').style.display='inline';" align="top">&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="Codehighlighter1_266_614_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;"><img src="http://www.cnblogs.com/Images/dot.gif" alt="" /></span><span id="Codehighlighter1_266_614_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;">14</span><span style="color: #000000;"><img id="Codehighlighter1_282_320_Open_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_282_320_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_282_320_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_282_320_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_282_320_Closed_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_282_320_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_282_320_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_282_320_Open_Text').style.display='inline';" align="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ForceRemove&nbsp;</span><span id="Codehighlighter1_282_320_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;"><img src="http://www.cnblogs.com/Images/dot.gif" alt="" /></span><span id="Codehighlighter1_282_320_Open_Text"><span style="color: #000000;">{220C4A97</span><span style="color: #000000;">-</span><span style="color: #000000;">B240</span><span style="color: #000000;">-</span><span style="color: #800080;">4443</span><span style="color: #000000;">-</span><span style="color: #000000;">BEE9</span><span style="color: #000000;">-</span><span style="color: #000000;">73D15D66B92D}</span></span><span style="color: #000000;">&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;s&nbsp;</span><span style="color: #800000;">'</span><span style="color: #800000;">SimpleObj2&nbsp;Class</span><span style="color: #800000;">'</span><span style="color: #000000;"><br /></span><span style="color: #008080;">15</span><span style="color: #000000;"><img id="Codehighlighter1_346_611_Open_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_346_611_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_346_611_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_346_611_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_346_611_Closed_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_346_611_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_346_611_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_346_611_Open_Text').style.display='inline';" align="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="Codehighlighter1_346_611_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;"><img src="http://www.cnblogs.com/Images/dot.gif" alt="" /></span><span id="Codehighlighter1_346_611_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;">16</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ProgID&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;s&nbsp;</span><span style="color: #800000;">'</span><span style="color: #800000;">atlDemo.SimpleObj2.1</span><span style="color: #800000;">'</span><span style="color: #000000;"><br /></span><span style="color: #008080;">17</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VersionIndependentProgID&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;s&nbsp;</span><span style="color: #800000;">'</span><span style="color: #800000;">atlDemo.SimpleObj2</span><span style="color: #800000;">'</span><span style="color: #000000;"><br /></span><span style="color: #008080;">18</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ForceRemove&nbsp;</span><span style="color: #800000;">'</span><span style="color: #800000;">Programmable</span><span style="color: #800000;">'</span><span style="color: #000000;"><br /></span><span style="color: #008080;">19</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InprocServer32&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;s&nbsp;</span><span style="color: #800000;">'</span><span style="color: #800000;">%MODULE%</span><span style="color: #800000;">'</span><span style="color: #000000;"><br /></span><span style="color: #008080;">20</span><span style="color: #000000;"><img id="Codehighlighter1_504_549_Open_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_504_549_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_504_549_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_504_549_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_504_549_Closed_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_504_549_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_504_549_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_504_549_Open_Text').style.display='inline';" align="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="Codehighlighter1_504_549_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;"><img src="http://www.cnblogs.com/Images/dot.gif" alt="" /></span><span id="Codehighlighter1_504_549_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;">21</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val&nbsp;ThreadingModel&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;s&nbsp;</span><span style="color: #800000;">'</span><span style="color: #800000;">Apartment</span><span style="color: #800000;">'</span><span style="color: #000000;"><br /></span><span style="color: #008080;">22</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="color: #000000;"><br /></span><span style="color: #008080;">23</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #800000;">'</span><span style="color: #800000;">TypeLib</span><span style="color: #800000;">'</span><span style="color: #000000;">&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;s&nbsp;</span><span style="color: #800000;">'</span><span style="color: #800000;">{CFE54601-E42B-4851-8A14-D259630A8648}</span><span style="color: #800000;">'</span><span style="color: #000000;"><br /></span><span style="color: #008080;">24</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="color: #000000;"><br /></span><span style="color: #008080;">25</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="color: #000000;"><br /></span><span style="color: #008080;">26</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockEnd.gif" alt="" align="top" />}</span></span><span style="color: #000000;"><br /></span><span style="color: #008080;">27</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /></span></div><p>&nbsp;</p><p>&nbsp;添加一个叫TestXXX地方法之后，多了这些东东</p><div class="cnblogs_code"><!--<br /><br />Code highlighting produced by Actipro CodeHighlighter (freeware)<br />http://www.CodeHighlighter.com/<br /><br />--><span style="color: #008080;">&nbsp;1</span><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /><span style="color: #000000;"><br /></span><span style="color: #008080;">&nbsp;2</span><span style="color: #000000;"><img id="Codehighlighter1_35_97_Open_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_35_97_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_35_97_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_35_97_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_35_97_Closed_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_35_97_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_35_97_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_35_97_Open_Text').style.display='inline';" align="top"></span><span style="color: #0000ff;">interface</span><span style="color: #000000;">&nbsp;IMySimpleObj&nbsp;:&nbsp;IDispatch</span><span id="Codehighlighter1_35_97_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;"><img src="http://www.cnblogs.com/Images/dot.gif" alt="" /></span><span id="Codehighlighter1_35_97_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;">&nbsp;3</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;[id(</span><span style="color: #800080;">1</span><span style="color: #000000;">),&nbsp;helpstring(</span><span style="color: #800000;">"</span><span style="color: #800000;">method&nbsp;Test</span><span style="color: #800000;">"</span><span style="color: #000000;">)]&nbsp;HRESULT&nbsp;TestXXX(</span><span style="color: #0000ff;">void</span><span style="color: #000000;">);<br /></span><span style="color: #008080;">&nbsp;4</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockEnd.gif" alt="" align="top" />}</span></span><span style="color: #000000;">;<br /></span><span style="color: #008080;">&nbsp;5</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /><br /></span><span style="color: #008080;">&nbsp;6</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /><br /></span><span style="color: #008080;">&nbsp;7</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />STDMETHODIMP&nbsp;CMySimpleObj::TestXXX(BSTR&nbsp;str)<br /></span><span style="color: #008080;">&nbsp;8</span><span style="color: #000000;"><img id="Codehighlighter1_146_208_Open_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_146_208_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_146_208_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_146_208_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_146_208_Closed_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_146_208_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_146_208_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_146_208_Open_Text').style.display='inline';" align="top"></span><span id="Codehighlighter1_146_208_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;"><img src="http://www.cnblogs.com/Images/dot.gif" alt="" /></span><span id="Codehighlighter1_146_208_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;">&nbsp;9</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//</span><span style="color: #008000;">&nbsp;TODO:&nbsp;Add&nbsp;your&nbsp;implementation&nbsp;code&nbsp;here</span><span style="color: #008000;"><br /></span><span style="color: #008080;">10</span><span style="color: #008000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" /></span><span style="color: #000000;"><br /></span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span style="color: #000000;">&nbsp;S_OK;<br /></span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockEnd.gif" alt="" align="top" />}</span></span><span style="color: #000000;"><br /></span><span style="color: #008080;">13</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /><br /></span><span style="color: #008080;">14</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /><br /></span><span style="color: #008080;">15</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /></span><span style="color: #0000ff;">class</span><span style="color: #000000;">&nbsp;ATL_NO_VTABLE&nbsp;CMySimpleObj&nbsp;:<br /></span><span style="color: #008080;">16</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">public</span><span style="color: #000000;">&nbsp;CComObjectRootEx</span><span style="color: #000000;">&lt;</span><span style="color: #000000;">CComSingleThreadModel</span><span style="color: #000000;">&gt;</span><span style="color: #000000;">,<br /></span><span style="color: #008080;">17</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">public</span><span style="color: #000000;">&nbsp;CComCoClass</span><span style="color: #000000;">&lt;</span><span style="color: #000000;">CMySimpleObj,&nbsp;</span><span style="color: #000000;">&amp;</span><span style="color: #000000;">CLSID_MySimpleObj</span><span style="color: #000000;">&gt;</span><span style="color: #000000;">,<br /></span><span style="color: #008080;">18</span><span style="color: #000000;"><img id="Codehighlighter1_424_436_Open_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_424_436_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_424_436_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_424_436_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_424_436_Closed_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_424_436_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_424_436_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_424_436_Open_Text').style.display='inline';" align="top">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">public</span><span style="color: #000000;">&nbsp;IDispatchImpl</span><span style="color: #000000;">&lt;</span><span style="color: #000000;">IMySimpleObj,&nbsp;</span><span style="color: #000000;">&amp;</span><span style="color: #000000;">IID_IMySimpleObj,&nbsp;</span><span style="color: #000000;">&amp;</span><span style="color: #000000;">LIBID_atlDemoLib,&nbsp;</span><span id="Codehighlighter1_424_436_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;">/**/</span><span id="Codehighlighter1_424_436_Open_Text"><span style="color: #008000;">/*</span><span style="color: #008000;">wMajor&nbsp;=</span><span style="color: #008000;">*/</span></span><span style="color: #000000;">&nbsp;</span><span style="color: #800080;">1</span><span style="color: #000000;">,&nbsp;</span><span id="Codehighlighter1_440_452_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;">/**/</span><span id="Codehighlighter1_440_452_Open_Text"><span style="color: #008000;">/*</span><span style="color: #008000;">wMinor&nbsp;=</span><span style="color: #008000;">*/</span></span><span style="color: #000000;">&nbsp;</span><span style="color: #800080;">0</span><span style="color: #000000;">&gt;</span><span style="color: #000000;"><br /></span><span style="color: #008080;">19</span><span style="color: #000000;"><img id="Codehighlighter1_456_488_Open_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_456_488_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_456_488_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_456_488_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_456_488_Closed_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_456_488_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_456_488_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_456_488_Open_Text').style.display='inline';" align="top"></span><span id="Codehighlighter1_456_488_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;"><img src="http://www.cnblogs.com/Images/dot.gif" alt="" /></span><span id="Codehighlighter1_456_488_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;">20</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockEnd.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;STDMETHOD(TestXXX)(BSTR&nbsp;str);</span></span></div><p>&nbsp;</p><p>&nbsp;添加一个叫MyProperty的属性后，多了这些</p><div class="cnblogs_code"><!--<br /><br />Code highlighting produced by Actipro CodeHighlighter (freeware)<br />http://www.CodeHighlighter.com/<br /><br />--><span style="color: #008080;">&nbsp;1</span><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" /><span style="color: #000000;"><br /></span><span style="color: #008080;">&nbsp;2</span><span style="color: #000000;"><img id="Codehighlighter1_35_228_Open_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_35_228_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_35_228_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_35_228_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_35_228_Closed_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_35_228_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_35_228_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_35_228_Open_Text').style.display='inline';" align="top"></span><span style="color: #0000ff;">interface</span><span style="color: #000000;">&nbsp;IMySimpleObj&nbsp;:&nbsp;IDispatch</span><span id="Codehighlighter1_35_228_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;"><img src="http://www.cnblogs.com/Images/dot.gif"  alt="" /></span><span id="Codehighlighter1_35_228_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;">&nbsp;3</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;[propget,&nbsp;id(</span><span style="color: #800080;">4</span><span style="color: #000000;">),&nbsp;helpstring(</span><span style="color: #800000;">"</span><span style="color: #800000;">property&nbsp;MyProperty</span><span style="color: #800000;">"</span><span style="color: #000000;">)]&nbsp;HRESULT&nbsp;MyProperty([</span><span style="color: #0000ff;">out</span><span style="color: #000000;">,&nbsp;retval]&nbsp;BSTR</span><span style="color: #000000;">*</span><span style="color: #000000;">&nbsp;pVal);<br /></span><span style="color: #008080;">&nbsp;4</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;[propput,&nbsp;id(</span><span style="color: #800080;">4</span><span style="color: #000000;">),&nbsp;helpstring(</span><span style="color: #800000;">"</span><span style="color: #800000;">property&nbsp;MyProperty</span><span style="color: #800000;">"</span><span style="color: #000000;">)]&nbsp;HRESULT&nbsp;MyProperty([</span><span style="color: #0000ff;">in</span><span style="color: #000000;">]&nbsp;BSTR&nbsp;newVal);<br /></span><span style="color: #008080;">&nbsp;5</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockEnd.gif" align="top"  alt="" />}</span></span><span style="color: #000000;">;<br /></span><span style="color: #008080;">&nbsp;6</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" /><br /></span><span style="color: #008080;">&nbsp;7</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" /><br /></span><span style="color: #008080;">&nbsp;8</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" />STDMETHODIMP&nbsp;CMySimpleObj::get_MyProperty(BSTR</span><span style="color: #000000;">*</span><span style="color: #000000;">&nbsp;pVal)<br /></span><span style="color: #008080;">&nbsp;9</span><span style="color: #000000;"><img id="Codehighlighter1_286_348_Open_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_286_348_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_286_348_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_286_348_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_286_348_Closed_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_286_348_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_286_348_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_286_348_Open_Text').style.display='inline';" align="top"></span><span id="Codehighlighter1_286_348_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;"><img src="http://www.cnblogs.com/Images/dot.gif"  alt="" /></span><span id="Codehighlighter1_286_348_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;">10</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//</span><span style="color: #008000;">&nbsp;TODO:&nbsp;Add&nbsp;your&nbsp;implementation&nbsp;code&nbsp;here</span><span style="color: #008000;"><br /></span><span style="color: #008080;">11</span><span style="color: #008000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" /></span><span style="color: #000000;"><br /></span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span style="color: #000000;">&nbsp;S_OK;<br /></span><span style="color: #008080;">13</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockEnd.gif" align="top"  alt="" />}</span></span><span style="color: #000000;"><br /></span><span style="color: #008080;">14</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" /><br /></span><span style="color: #008080;">15</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" />STDMETHODIMP&nbsp;CMySimpleObj::put_MyProperty(BSTR&nbsp;newVal)<br /></span><span style="color: #008080;">16</span><span style="color: #000000;"><img id="Codehighlighter1_405_467_Open_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_405_467_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_405_467_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_405_467_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_405_467_Closed_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_405_467_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_405_467_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_405_467_Open_Text').style.display='inline';" align="top"></span><span id="Codehighlighter1_405_467_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;"><img src="http://www.cnblogs.com/Images/dot.gif"  alt="" /></span><span id="Codehighlighter1_405_467_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;">17</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">//</span><span style="color: #008000;">&nbsp;TODO:&nbsp;Add&nbsp;your&nbsp;implementation&nbsp;code&nbsp;here</span><span style="color: #008000;"><br /></span><span style="color: #008080;">18</span><span style="color: #008000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" /></span><span style="color: #000000;"><br /></span><span style="color: #008080;">19</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span style="color: #000000;">&nbsp;S_OK;<br /></span><span style="color: #008080;">20</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockEnd.gif" align="top"  alt="" />}</span></span><span style="color: #000000;"><br /></span><span style="color: #008080;">21</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" /><br /></span><span style="color: #008080;">22</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top"  alt="" /><br /></span><span style="color: #008080;">23</span><span style="color: #000000;"><img id="Codehighlighter1_503_585_Open_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_503_585_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_503_585_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_503_585_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_503_585_Closed_Image" src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_503_585_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_503_585_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_503_585_Open_Text').style.display='inline';" align="top"></span><span style="color: #0000ff;">class</span><span style="color: #000000;">&nbsp;ATL_NO_VTABLE&nbsp;CMySimpleObj&nbsp;</span><span id="Codehighlighter1_503_585_Closed_Text" style="border: 1px solid #808080; background-color: #ffffff; display: none;"><img src="http://www.cnblogs.com/Images/dot.gif"  alt="" /></span><span id="Codehighlighter1_503_585_Open_Text"><span style="color: #000000;">{<br /></span><span style="color: #008080;">24</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;STDMETHOD(get_MyProperty)(BSTR</span><span style="color: #000000;">*</span><span style="color: #000000;">&nbsp;pVal);<br /></span><span style="color: #008080;">25</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockEnd.gif" align="top"  alt="" />&nbsp;&nbsp;&nbsp;&nbsp;STDMETHOD(put_MyProperty)(BSTR&nbsp;newVal);</span></span></div><p>&nbsp;</p><p> </p>