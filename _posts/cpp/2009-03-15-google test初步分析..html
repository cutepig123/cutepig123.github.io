现在常用的C++单元测试框架有 CppUnit，CxxTest,boost::test和google test。不像java/C#的测试框架，由于C++不支持reflection，所以，必须要做一些额外的工作，让框架知道相关内容的存在。CppUnit的做法是用宏进行注册。这种做法要求我们每添加一个测试，就要考虑用相应的宏进行注册，这种做法很繁琐，最大的问题在于由于疏忽而遗漏，这种靠人工保证的东西不可靠。在这点上，CxxTest 做得要好一些，有一个专门的脚本做这件事。通过这个脚本扫描这个自己编写的文件，生成一些新的文件，完成这个工作。从代码的表现力和可靠度来说，要好得多。唯一的问题是引入了一个脚本，而且这个脚本一般是由某些动态语言写成的（目前的CxxTest有Perl和Python的脚本），从而引入了对这种语言的依赖。而boost::test和google test 则是通过一些宏机制，来实现用户只需写一次就可以自动完成注册。<br>我大概分析了一下gtest的实现机制。由于里面用了很多宏，比较费解，因此首先用cl /P /C命令将之展开，我的测试程序如下<br><div class="cnblogs_code"><!--<br><br>Code highlighting produced by Actipro CodeHighlighter (freeware)<br>http://www.CodeHighlighter.com/<br><br>--><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"><span style="color: rgb(0, 0, 0);">#include&nbsp;</span><span style="color: rgb(0, 0, 0);">&lt;</span><span style="color: rgb(0, 0, 0);">gtest</span><span style="color: rgb(0, 0, 0);">/</span><span style="color: rgb(0, 0, 0);">gtest.h</span><span style="color: rgb(0, 0, 0);">&gt;</span><span style="color: rgb(0, 0, 0);"><br><img id="Codehighlighter1_55_77_Open_Image" src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_55_77_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_55_77_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_55_77_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_55_77_Closed_Image" src="https://www.cnblogs.com/images/OutliningIndicators/ContractedBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_55_77_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_55_77_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_55_77_Open_Text').style.display='inline';" align="top">TEST(FactorialTest,&nbsp;Negative)&nbsp;</span><span id="Codehighlighter1_55_77_Closed_Text" style="border: 1px solid rgb(128, 128, 128); background-color: rgb(255, 255, 255); display: none;"><img src="https://www.cnblogs.com/images/dot.gif"></span><span id="Codehighlighter1_55_77_Open_Text"><span style="color: rgb(0, 0, 0);">{<br><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;EXPECT_EQ(</span><span style="color: rgb(128, 0, 128);">1</span><span style="color: rgb(0, 0, 0);">,&nbsp;</span><span style="color: rgb(128, 0, 128);">1</span><span style="color: rgb(0, 0, 0);">);<br><img src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedBlockEnd.gif" align="top">}</span></span></div><br>宏展开完后主要部分如下<br><div class="cnblogs_code"><!--<br><br>Code highlighting produced by Actipro CodeHighlighter (freeware)<br>http://www.CodeHighlighter.com/<br><br>--><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"><span style="color: rgb(0, 0, 255);">class</span><span style="color: rgb(0, 0, 0);">&nbsp;FactorialTest_Negative_Test&nbsp;:&nbsp;</span><span style="color: rgb(0, 0, 255);">public</span><span style="color: rgb(0, 0, 0);">&nbsp;::testing::Test<br><img id="Codehighlighter1_59_322_Open_Image" src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_59_322_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_59_322_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_59_322_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_59_322_Closed_Image" src="https://www.cnblogs.com/images/OutliningIndicators/ContractedBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_59_322_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_59_322_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_59_322_Open_Text').style.display='inline';" align="top"></span><span id="Codehighlighter1_59_322_Closed_Text" style="border: 1px solid rgb(128, 128, 128); background-color: rgb(255, 255, 255); display: none;"><img src="https://www.cnblogs.com/images/dot.gif"></span><span id="Codehighlighter1_59_322_Open_Text"><span style="color: rgb(0, 0, 0);">{<br><img id="Codehighlighter1_103_105_Open_Image" src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_103_105_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_103_105_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_103_105_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_103_105_Closed_Image" src="https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_103_105_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_103_105_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_103_105_Open_Text').style.display='inline';" align="top">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0, 0, 255);">public</span><span style="color: rgb(0, 0, 0);">:&nbsp;FactorialTest_Negative_Test()&nbsp;</span><span id="Codehighlighter1_103_105_Closed_Text" style="border: 1px solid rgb(128, 128, 128); background-color: rgb(255, 255, 255); display: none;"><img src="https://www.cnblogs.com/images/dot.gif"></span><span id="Codehighlighter1_103_105_Open_Text"><span style="color: rgb(0, 0, 0);">{}</span></span><span style="color: rgb(0, 0, 0);"><br><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0, 0, 255);">private</span><span style="color: rgb(0, 0, 0);">:&nbsp;</span><span style="color: rgb(0, 0, 255);">virtual</span><span style="color: rgb(0, 0, 0);">&nbsp;</span><span style="color: rgb(0, 0, 255);">void</span><span style="color: rgb(0, 0, 0);">&nbsp;TestBody();<br><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0, 0, 255);">static</span><span style="color: rgb(0, 0, 0);">&nbsp;::testing::TestInfo</span><span style="color: rgb(0, 0, 0);">*</span><span style="color: rgb(0, 0, 0);">&nbsp;</span><span style="color: rgb(0, 0, 255);">const</span><span style="color: rgb(0, 0, 0);">&nbsp;test_info_;<br><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;FactorialTest_Negative_Test(</span><span style="color: rgb(0, 0, 255);">const</span><span style="color: rgb(0, 0, 0);">&nbsp;FactorialTest_Negative_Test&nbsp;</span><span style="color: rgb(0, 0, 0);">&amp;</span><span style="color: rgb(0, 0, 0);">);<br><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0, 0, 255);">void</span><span style="color: rgb(0, 0, 0);">&nbsp;</span><span style="color: rgb(0, 0, 255);">operator</span><span style="color: rgb(0, 0, 0);">=</span><span style="color: rgb(0, 0, 0);">(</span><span style="color: rgb(0, 0, 255);">const</span><span style="color: rgb(0, 0, 0);">&nbsp;FactorialTest_Negative_Test&nbsp;</span><span style="color: rgb(0, 0, 0);">&amp;</span><span style="color: rgb(0, 0, 0);">);<br><img src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedBlockEnd.gif" align="top">}</span></span><span style="color: rgb(0, 0, 0);">;<br><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"><br><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"></span><span style="color: rgb(0, 128, 0);">//</span><span style="color: rgb(0, 128, 0);">init&nbsp;test_info_</span><span style="color: rgb(0, 128, 0);"><br><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"></span><span style="color: rgb(0, 0, 0);">::testing::TestInfo</span><span style="color: rgb(0, 0, 0);">*</span><span style="color: rgb(0, 0, 0);">&nbsp;</span><span style="color: rgb(0, 0, 255);">const</span><span style="color: rgb(0, 0, 0);">&nbsp;FactorialTest_Negative_Test&nbsp;::test_info_&nbsp;</span><span style="color: rgb(0, 0, 0);">=</span><span style="color: rgb(0, 0, 0);">&nbsp;::testing::</span><span style="color: rgb(0, 0, 255);">internal</span><span style="color: rgb(0, 0, 0);">::MakeAndRegisterTestInfo(&nbsp;</span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(128, 0, 0);">FactorialTest</span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(0, 0, 0);">,&nbsp;</span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(128, 0, 0);">Negative</span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(0, 0, 0);">,&nbsp;</span><span style="color: rgb(128, 0, 0);">""</span><span style="color: rgb(0, 0, 0);">,&nbsp;</span><span style="color: rgb(128, 0, 0);">""</span><span style="color: rgb(0, 0, 0);">,&nbsp;(::testing::</span><span style="color: rgb(0, 0, 255);">internal</span><span style="color: rgb(0, 0, 0);">::GetTestTypeId()),&nbsp;::testing::Test::SetUpTestCase,&nbsp;::testing::Test::TearDownTestCase,&nbsp;</span><span style="color: rgb(0, 0, 255);">new</span><span style="color: rgb(0, 0, 0);">&nbsp;::testing::</span><span style="color: rgb(0, 0, 255);">internal</span><span style="color: rgb(0, 0, 0);">::TestFactoryImpl</span><span style="color: rgb(0, 0, 0);">&lt;</span><span style="color: rgb(0, 0, 0);">&nbsp;FactorialTest_Negative_Test</span><span style="color: rgb(0, 0, 0);">&gt;</span><span style="color: rgb(0, 0, 0);">);<br><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"><br><img id="Codehighlighter1_722_1179_Open_Image" src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_722_1179_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_722_1179_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_722_1179_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_722_1179_Closed_Image" src="https://www.cnblogs.com/images/OutliningIndicators/ContractedBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_722_1179_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_722_1179_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_722_1179_Open_Text').style.display='inline';" align="top"></span><span style="color: rgb(0, 0, 255);">void</span><span style="color: rgb(0, 0, 0);">&nbsp;FactorialTest_Negative_Test::TestBody()&nbsp;</span><span id="Codehighlighter1_722_1179_Closed_Text" style="border: 1px solid rgb(128, 128, 128); background-color: rgb(255, 255, 255); display: none;"><img src="https://www.cnblogs.com/images/dot.gif"></span><span id="Codehighlighter1_722_1179_Open_Text"><span style="color: rgb(0, 0, 0);">{<br><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;</span><span style="color: rgb(0, 128, 0);">//</span><span style="color: rgb(0, 128, 0);">&nbsp;This&nbsp;test&nbsp;is&nbsp;named&nbsp;"Negative",&nbsp;and&nbsp;belongs&nbsp;to&nbsp;the&nbsp;"FactorialTest"<br><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;</span><span style="color: rgb(0, 128, 0);">//</span><span style="color: rgb(0, 128, 0);">&nbsp;test&nbsp;case.</span><span style="color: rgb(0, 128, 0);"><br><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top"></span><span style="color: rgb(0, 0, 0);">&nbsp;&nbsp;</span><span style="color: rgb(0, 0, 255);">switch</span><span style="color: rgb(0, 0, 0);">&nbsp;(</span><span style="color: rgb(128, 0, 128);">0</span><span style="color: rgb(0, 0, 0);">)&nbsp;</span><span style="color: rgb(0, 0, 255);">case</span><span style="color: rgb(0, 0, 0);">&nbsp;</span><span style="color: rgb(128, 0, 128);">0</span><span style="color: rgb(0, 0, 0);">:&nbsp;</span><span style="color: rgb(0, 0, 255);">if</span><span style="color: rgb(0, 0, 0);">&nbsp;(</span><span style="color: rgb(0, 0, 255);">const</span><span style="color: rgb(0, 0, 0);">&nbsp;::testing::AssertionResult&nbsp;gtest_ar&nbsp;</span><span style="color: rgb(0, 0, 0);">=</span><span style="color: rgb(0, 0, 0);">&nbsp;(::testing::</span><span style="color: rgb(0, 0, 255);">internal</span><span style="color: rgb(0, 0, 0);">::&nbsp;EqHelper</span><span style="color: rgb(0, 0, 0);">&lt;</span><span style="color: rgb(0, 0, 0);">(</span><span style="color: rgb(0, 0, 255);">sizeof</span><span style="color: rgb(0, 0, 0);">(::testing::</span><span style="color: rgb(0, 0, 255);">internal</span><span style="color: rgb(0, 0, 0);">::IsNullLiteralHelper(</span><span style="color: rgb(128, 0, 128);">1</span><span style="color: rgb(0, 0, 0);">))&nbsp;</span><span style="color: rgb(0, 0, 0);">==</span><span style="color: rgb(0, 0, 0);">&nbsp;</span><span style="color: rgb(128, 0, 128);">1</span><span style="color: rgb(0, 0, 0);">)</span><span style="color: rgb(0, 0, 0);">&gt;</span><span style="color: rgb(0, 0, 0);">::Compare(</span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(128, 0, 0);">1</span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(0, 0, 0);">,&nbsp;</span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(128, 0, 0);">Factorial(-5)</span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(0, 0, 0);">,&nbsp;</span><span style="color: rgb(128, 0, 128);">1</span><span style="color: rgb(0, 0, 0);">,&nbsp;Factorial(</span><span style="color: rgb(0, 0, 0);">-</span><span style="color: rgb(128, 0, 128);">5</span><span style="color: rgb(0, 0, 0);">))))&nbsp;;&nbsp;</span><span style="color: rgb(0, 0, 255);">else</span><span style="color: rgb(0, 0, 0);">&nbsp;::testing::</span><span style="color: rgb(0, 0, 255);">internal</span><span style="color: rgb(0, 0, 0);">::AssertHelper(::testing::TPRT_NONFATAL_FAILURE,&nbsp;</span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(128, 0, 0);">sample1_unittest.cc</span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(0, 0, 0);">,&nbsp;</span><span style="color: rgb(128, 0, 128);">82</span><span style="color: rgb(0, 0, 0);">,&nbsp;gtest_ar.failure_message())&nbsp;</span><span style="color: rgb(0, 0, 0);">=</span><span style="color: rgb(0, 0, 0);">&nbsp;::testing::Message();<br><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top"><br><img src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedBlockEnd.gif" align="top">}</span></span></div><br><br>可以看出，gtest是利用static变量的初始化来实现函数注册的，主要函数为MakeAndRegisterTestInfo（），该函数定义在src\gtest.cc里面<br><div class="cnblogs_code"><!--<br><br>Code highlighting produced by Actipro CodeHighlighter (freeware)<br>http://www.CodeHighlighter.com/<br><br>--><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"><span style="color: rgb(0, 0, 0);">TestInfo</span><span style="color: rgb(0, 0, 0);">*</span><span style="color: rgb(0, 0, 0);">&nbsp;MakeAndRegisterTestInfo(<br><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0, 0, 255);">const</span><span style="color: rgb(0, 0, 0);">&nbsp;</span><span style="color: rgb(0, 0, 255);">char</span><span style="color: rgb(0, 0, 0);">*</span><span style="color: rgb(0, 0, 0);">&nbsp;test_case_name,&nbsp;</span><span style="color: rgb(0, 0, 255);">const</span><span style="color: rgb(0, 0, 0);">&nbsp;</span><span style="color: rgb(0, 0, 255);">char</span><span style="color: rgb(0, 0, 0);">*</span><span style="color: rgb(0, 0, 0);">&nbsp;name,<br><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0, 0, 255);">const</span><span style="color: rgb(0, 0, 0);">&nbsp;</span><span style="color: rgb(0, 0, 255);">char</span><span style="color: rgb(0, 0, 0);">*</span><span style="color: rgb(0, 0, 0);">&nbsp;test_case_comment,&nbsp;</span><span style="color: rgb(0, 0, 255);">const</span><span style="color: rgb(0, 0, 0);">&nbsp;</span><span style="color: rgb(0, 0, 255);">char</span><span style="color: rgb(0, 0, 0);">*</span><span style="color: rgb(0, 0, 0);">&nbsp;comment,<br><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;TypeId&nbsp;fixture_class_id,<br><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;SetUpTestCaseFunc&nbsp;set_up_tc,<br><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;TearDownTestCaseFunc&nbsp;tear_down_tc,<br><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;TestFactoryBase</span><span style="color: rgb(0, 0, 0);">*</span><span style="color: rgb(0, 0, 0);">&nbsp;factory)<br><img id="Codehighlighter1_272_523_Open_Image" src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_272_523_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_272_523_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_272_523_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_272_523_Closed_Image" src="https://www.cnblogs.com/images/OutliningIndicators/ContractedBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_272_523_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_272_523_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_272_523_Open_Text').style.display='inline';" align="top"></span><span id="Codehighlighter1_272_523_Closed_Text" style="border: 1px solid rgb(128, 128, 128); background-color: rgb(255, 255, 255); display: none;"><img src="https://www.cnblogs.com/images/dot.gif"></span><span id="Codehighlighter1_272_523_Open_Text"><span style="color: rgb(0, 0, 0);">{<br><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;TestInfo</span><span style="color: rgb(0, 0, 0);">*</span><span style="color: rgb(0, 0, 0);">&nbsp;</span><span style="color: rgb(0, 0, 255);">const</span><span style="color: rgb(0, 0, 0);">&nbsp;test_info&nbsp;</span><span style="color: rgb(0, 0, 0);">=</span><span style="color: rgb(0, 0, 0);"><br><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0, 0, 255);">new</span><span style="color: rgb(0, 0, 0);">&nbsp;TestInfo(test_case_name,&nbsp;name,&nbsp;test_case_comment,&nbsp;comment,<br><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fixture_class_id,&nbsp;factory);<br><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;GetUnitTestImpl()</span><span style="color: rgb(0, 0, 0);">-&gt;</span><span style="color: rgb(0, 0, 0);">AddTestInfo(set_up_tc,&nbsp;tear_down_tc,&nbsp;test_info);&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0, 128, 0);">//</span><span style="color: rgb(0, 128, 0);">关键是这一行</span><span style="color: rgb(0, 128, 0);"><br><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top"></span><span style="color: rgb(0, 0, 0);">&nbsp;&nbsp;</span><span style="color: rgb(0, 0, 255);">return</span><span style="color: rgb(0, 0, 0);">&nbsp;test_info;<br><img src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedBlockEnd.gif" align="top">}</span></span></div><br>果然不出所料，GetUnitTestImpl()-&gt;AddTestInfo（xx）这一句就是做注册，下面我仿照gtest自己写了一个简单的测试框架<br><div class="cnblogs_code"><!--<br><br>Code highlighting produced by Actipro CodeHighlighter (freeware)<br>http://www.CodeHighlighter.com/<br><br>--><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"><span style="color: rgb(0, 0, 0);">#include&nbsp;</span><span style="color: rgb(0, 0, 0);">&lt;</span><span style="color: rgb(0, 0, 255);">string</span><span style="color: rgb(0, 0, 0);">&gt;</span><span style="color: rgb(0, 0, 0);"><br><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top">#include&nbsp;</span><span style="color: rgb(0, 0, 0);">&lt;</span><span style="color: rgb(0, 0, 0);">vector</span><span style="color: rgb(0, 0, 0);">&gt;</span><span style="color: rgb(0, 0, 0);"><br><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top">#include&nbsp;</span><span style="color: rgb(0, 0, 0);">&lt;</span><span style="color: rgb(0, 0, 0);">iostream</span><span style="color: rgb(0, 0, 0);">&gt;</span><span style="color: rgb(0, 0, 0);"><br><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"></span><span style="color: rgb(0, 0, 255);">using</span><span style="color: rgb(0, 0, 0);">&nbsp;</span><span style="color: rgb(0, 0, 255);">namespace</span><span style="color: rgb(0, 0, 0);">&nbsp;std;<br><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"><br><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"></span><span style="color: rgb(0, 0, 255);">class</span><span style="color: rgb(0, 0, 0);">&nbsp;Test<br><img id="Codehighlighter1_89_137_Open_Image" src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_89_137_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_89_137_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_89_137_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_89_137_Closed_Image" src="https://www.cnblogs.com/images/OutliningIndicators/ContractedBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_89_137_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_89_137_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_89_137_Open_Text').style.display='inline';" align="top"></span><span id="Codehighlighter1_89_137_Closed_Text" style="border: 1px solid rgb(128, 128, 128); background-color: rgb(255, 255, 255); display: none;"><img src="https://www.cnblogs.com/images/dot.gif"></span><span id="Codehighlighter1_89_137_Open_Text"><span style="color: rgb(0, 0, 0);">{<br><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0, 0, 255);">public</span><span style="color: rgb(0, 0, 0);">:<br><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0, 0, 255);">virtual</span><span style="color: rgb(0, 0, 0);">&nbsp;</span><span style="color: rgb(0, 0, 255);">bool</span><span style="color: rgb(0, 0, 0);">&nbsp;testBody()&nbsp;</span><span style="color: rgb(0, 0, 0);">=</span><span style="color: rgb(0, 0, 0);">&nbsp;</span><span style="color: rgb(128, 0, 128);">0</span><span style="color: rgb(0, 0, 0);">;<br><img src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedBlockEnd.gif" align="top">}</span></span><span style="color: rgb(0, 0, 0);">;<br><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"><br><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"></span><span style="color: rgb(0, 0, 255);">class</span><span style="color: rgb(0, 0, 0);">&nbsp;TestInfo<br><img id="Codehighlighter1_155_549_Open_Image" src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_155_549_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_155_549_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_155_549_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_155_549_Closed_Image" src="https://www.cnblogs.com/images/OutliningIndicators/ContractedBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_155_549_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_155_549_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_155_549_Open_Text').style.display='inline';" align="top"></span><span id="Codehighlighter1_155_549_Closed_Text" style="border: 1px solid rgb(128, 128, 128); background-color: rgb(255, 255, 255); display: none;"><img src="https://www.cnblogs.com/images/dot.gif"></span><span id="Codehighlighter1_155_549_Open_Text"><span style="color: rgb(0, 0, 0);">{<br><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0, 0, 255);">public</span><span style="color: rgb(0, 0, 0);">:<br><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TestInfo(</span><span style="color: rgb(0, 0, 255);">const</span><span style="color: rgb(0, 0, 0);">&nbsp;</span><span style="color: rgb(0, 0, 255);">char</span><span style="color: rgb(0, 0, 0);">&nbsp;</span><span style="color: rgb(0, 0, 0);">*</span><span style="color: rgb(0, 0, 0);">fun,</span><span style="color: rgb(0, 0, 255);">const</span><span style="color: rgb(0, 0, 0);">&nbsp;</span><span style="color: rgb(0, 0, 255);">char</span><span style="color: rgb(0, 0, 0);">&nbsp;</span><span style="color: rgb(0, 0, 0);">*</span><span style="color: rgb(0, 0, 0);">file,</span><span style="color: rgb(0, 0, 255);">int</span><span style="color: rgb(0, 0, 0);">&nbsp;line,&nbsp;Test&nbsp;</span><span style="color: rgb(0, 0, 0);">*</span><span style="color: rgb(0, 0, 0);">&nbsp;pTest):<br><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;szFunction_(fun),szFile_(file),line_(line),test_(pTest)<br><img id="Codehighlighter1_316_327_Open_Image" src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_316_327_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_316_327_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_316_327_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_316_327_Closed_Image" src="https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_316_327_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_316_327_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_316_327_Open_Text').style.display='inline';" align="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="Codehighlighter1_316_327_Closed_Text" style="border: 1px solid rgb(128, 128, 128); background-color: rgb(255, 255, 255); display: none;"><img src="https://www.cnblogs.com/images/dot.gif"></span><span id="Codehighlighter1_316_327_Open_Text"><span style="color: rgb(0, 0, 0);">{<br><img src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="color: rgb(0, 0, 0);"><br><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0, 0, 255);">bool</span><span style="color: rgb(0, 0, 0);">&nbsp;RunTest()<br><img id="Codehighlighter1_368_417_Open_Image" src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_368_417_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_368_417_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_368_417_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_368_417_Closed_Image" src="https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_368_417_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_368_417_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_368_417_Open_Text').style.display='inline';" align="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="Codehighlighter1_368_417_Closed_Text" style="border: 1px solid rgb(128, 128, 128); background-color: rgb(255, 255, 255); display: none;"><img src="https://www.cnblogs.com/images/dot.gif"></span><span id="Codehighlighter1_368_417_Open_Text"><span style="color: rgb(0, 0, 0);">{<br><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0, 0, 255);">return</span><span style="color: rgb(0, 0, 0);">&nbsp;test_</span><span style="color: rgb(0, 0, 0);">-&gt;</span><span style="color: rgb(0, 0, 0);">testBody();<br><img src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="color: rgb(0, 0, 0);"><br><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0, 0, 255);">string</span><span style="color: rgb(0, 0, 0);">&nbsp;szFunction_;<br><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0, 0, 255);">string</span><span style="color: rgb(0, 0, 0);">&nbsp;szFile_;<br><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0, 0, 255);">int</span><span style="color: rgb(0, 0, 0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;line_;<br><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0, 0, 255);">private</span><span style="color: rgb(0, 0, 0);">:<br><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Test&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0, 0, 0);">*</span><span style="color: rgb(0, 0, 0);">test_;<br><img src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedBlockEnd.gif" align="top">}</span></span><span style="color: rgb(0, 0, 0);">;<br><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"><br><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top">typedef&nbsp;&nbsp;&nbsp;&nbsp;vector&nbsp;</span><span style="color: rgb(0, 0, 0);">&lt;</span><span style="color: rgb(0, 0, 0);">&nbsp;TestInfo&nbsp;</span><span style="color: rgb(0, 0, 0);">*&gt;</span><span style="color: rgb(0, 0, 0);">&nbsp;TestInfosType;<br><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top">TestInfosType&nbsp;testInfos;<br><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"><br><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top">TestInfo&nbsp;</span><span style="color: rgb(0, 0, 0);">*</span><span style="color: rgb(0, 0, 0);">&nbsp;MakeAndRegisterTestInfo(</span><span style="color: rgb(0, 0, 255);">const</span><span style="color: rgb(0, 0, 0);">&nbsp;</span><span style="color: rgb(0, 0, 255);">char</span><span style="color: rgb(0, 0, 0);">&nbsp;</span><span style="color: rgb(0, 0, 0);">*</span><span style="color: rgb(0, 0, 0);">fun,</span><span style="color: rgb(0, 0, 255);">const</span><span style="color: rgb(0, 0, 0);">&nbsp;</span><span style="color: rgb(0, 0, 255);">char</span><span style="color: rgb(0, 0, 0);">&nbsp;</span><span style="color: rgb(0, 0, 0);">*</span><span style="color: rgb(0, 0, 0);">file,</span><span style="color: rgb(0, 0, 255);">int</span><span style="color: rgb(0, 0, 0);">&nbsp;line,&nbsp;Test&nbsp;</span><span style="color: rgb(0, 0, 0);">*</span><span style="color: rgb(0, 0, 0);">&nbsp;pTest)<br><img id="Codehighlighter1_717_875_Open_Image" src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_717_875_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_717_875_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_717_875_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_717_875_Closed_Image" src="https://www.cnblogs.com/images/OutliningIndicators/ContractedBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_717_875_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_717_875_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_717_875_Open_Text').style.display='inline';" align="top"></span><span id="Codehighlighter1_717_875_Closed_Text" style="border: 1px solid rgb(128, 128, 128); background-color: rgb(255, 255, 255); display: none;"><img src="https://www.cnblogs.com/images/dot.gif"></span><span id="Codehighlighter1_717_875_Open_Text"><span style="color: rgb(0, 0, 0);">{<br><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0, 128, 0);">//</span><span style="color: rgb(0, 128, 0);">cout&nbsp;&lt;&lt;&nbsp;"MakeAndRegisterTestInfo..\n";</span><span style="color: rgb(0, 128, 0);"><br><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top"></span><span style="color: rgb(0, 0, 0);">&nbsp;&nbsp;&nbsp;&nbsp;TestInfo&nbsp;</span><span style="color: rgb(0, 0, 0);">*</span><span style="color: rgb(0, 0, 0);">&nbsp;pInfo&nbsp;</span><span style="color: rgb(0, 0, 0);">=</span><span style="color: rgb(0, 0, 0);">&nbsp;</span><span style="color: rgb(0, 0, 255);">new</span><span style="color: rgb(0, 0, 0);">&nbsp;TestInfo(fun,&nbsp;file,line,pTest);<br><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;testInfos.push_back(pInfo);<br><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0, 0, 255);">return</span><span style="color: rgb(0, 0, 0);">&nbsp;pInfo;<br><img src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedBlockEnd.gif" align="top">}</span></span><span style="color: rgb(0, 0, 0);"><br><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"><br><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"></span><span style="color: rgb(0, 0, 255);">#define</span><span style="color: rgb(0, 0, 0);">&nbsp;TEST(testName)&nbsp;&nbsp;&nbsp;&nbsp;\</span><span style="color: rgb(0, 0, 0);"><br><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"></span><span style="color: rgb(0, 0, 255);">class</span><span style="color: rgb(0, 0, 0);">&nbsp;TEST_##testName:&nbsp;</span><span style="color: rgb(0, 0, 255);">public</span><span style="color: rgb(0, 0, 0);">&nbsp;Test&nbsp;&nbsp;&nbsp;&nbsp;\<br><img id="Codehighlighter1_947_1065_Open_Image" src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_947_1065_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_947_1065_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_947_1065_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_947_1065_Closed_Image" src="https://www.cnblogs.com/images/OutliningIndicators/ContractedBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_947_1065_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_947_1065_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_947_1065_Open_Text').style.display='inline';" align="top"></span><span id="Codehighlighter1_947_1065_Closed_Text" style="border: 1px solid rgb(128, 128, 128); background-color: rgb(255, 255, 255); display: none;"><img src="https://www.cnblogs.com/images/dot.gif"></span><span id="Codehighlighter1_947_1065_Open_Text"><span style="color: rgb(0, 0, 0);">{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<br><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0, 0, 255);">public</span><span style="color: rgb(0, 0, 0);">:&nbsp;&nbsp;&nbsp;&nbsp;\<br><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0, 0, 255);">virtual</span><span style="color: rgb(0, 0, 0);">&nbsp;</span><span style="color: rgb(0, 0, 255);">bool</span><span style="color: rgb(0, 0, 0);">&nbsp;testBody();&nbsp;&nbsp;&nbsp;&nbsp;\<br><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0, 0, 255);">static</span><span style="color: rgb(0, 0, 0);">&nbsp;TestInfo&nbsp;</span><span style="color: rgb(0, 0, 0);">*</span><span style="color: rgb(0, 0, 0);">&nbsp;test_info_;&nbsp;&nbsp;&nbsp;&nbsp;\<br><img src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedBlockEnd.gif" align="top">}</span></span><span style="color: rgb(0, 0, 0);">;&nbsp;&nbsp;&nbsp;&nbsp;\<br><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top">TestInfo&nbsp;</span><span style="color: rgb(0, 0, 0);">*</span><span style="color: rgb(0, 0, 0);">&nbsp;TEST_##testName::test_info_&nbsp;</span><span style="color: rgb(0, 0, 0);">=</span><span style="color: rgb(0, 0, 0);">&nbsp;MakeAndRegisterTestInfo(#testName,__FILE__,__LINE__,</span><span style="color: rgb(0, 0, 255);">new</span><span style="color: rgb(0, 0, 0);">&nbsp;TEST_##testName);&nbsp;&nbsp;&nbsp;&nbsp;\<br><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"></span><span style="color: rgb(0, 0, 255);">bool</span><span style="color: rgb(0, 0, 0);">&nbsp;TEST_##testName::testBody()&nbsp;&nbsp;&nbsp;&nbsp;<br><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"><br><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"><br><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"></span><span style="color: rgb(0, 0, 255);">#define</span><span style="color: rgb(0, 0, 0);">&nbsp;TEST_ASSERT(x)&nbsp;&nbsp;{if(!(x))&nbsp;{cout&nbsp;&lt;&lt;&nbsp;"AssertFail:"&nbsp;&lt;&lt;&nbsp;#x&nbsp;&lt;&lt;&nbsp;"&nbsp;File:"&nbsp;&lt;&lt;&nbsp;test_info_-&gt;szFile_.c_str()&nbsp;&lt;&lt;&nbsp;"&nbsp;Line:"&nbsp;&lt;&lt;&nbsp;test_info_-&gt;line_&nbsp;&lt;&lt;&nbsp;"&nbsp;Function:"&nbsp;&lt;&lt;&nbsp;test_info_-&gt;szFunction_.c_str()&nbsp;&lt;&lt;&nbsp;endl;return&nbsp;false;}else&nbsp;cout&lt;&lt;"."&lt;&lt;endl;}</span><span style="color: rgb(0, 0, 0);"><br><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"><br><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"></span><span style="color: rgb(0, 0, 255);">#define</span><span style="color: rgb(0, 0, 0);">&nbsp;RUN_ALL_TEST()&nbsp;&nbsp;&nbsp;&nbsp;\</span><span style="color: rgb(0, 0, 0);"><br><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"></span><span style="color: rgb(0, 0, 255);">for</span><span style="color: rgb(0, 0, 0);">(TestInfosType::iterator&nbsp;it&nbsp;</span><span style="color: rgb(0, 0, 0);">=</span><span style="color: rgb(0, 0, 0);">&nbsp;testInfos.begin();&nbsp;&nbsp;&nbsp;&nbsp;\<br><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it&nbsp;</span><span style="color: rgb(0, 0, 0);">!=</span><span style="color: rgb(0, 0, 0);">&nbsp;testInfos.end();&nbsp;</span><span style="color: rgb(0, 0, 0);">++</span><span style="color: rgb(0, 0, 0);">it)&nbsp;&nbsp;&nbsp;&nbsp;\<br><img id="Codehighlighter1_1599_1670_Open_Image" src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1599_1670_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_1599_1670_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_1599_1670_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_1599_1670_Closed_Image" src="https://www.cnblogs.com/images/OutliningIndicators/ContractedBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1599_1670_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_1599_1670_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_1599_1670_Open_Text').style.display='inline';" align="top"></span><span id="Codehighlighter1_1599_1670_Closed_Text" style="border: 1px solid rgb(128, 128, 128); background-color: rgb(255, 255, 255); display: none;"><img src="https://www.cnblogs.com/images/dot.gif"></span><span id="Codehighlighter1_1599_1670_Open_Text"><span style="color: rgb(0, 0, 0);">{&nbsp;&nbsp;&nbsp;&nbsp;\<br><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;TestInfo&nbsp;</span><span style="color: rgb(0, 0, 0);">*</span><span style="color: rgb(0, 0, 0);">&nbsp;pInfo&nbsp;</span><span style="color: rgb(0, 0, 0);">=</span><span style="color: rgb(0, 0, 0);">&nbsp;</span><span style="color: rgb(0, 0, 0);">*</span><span style="color: rgb(0, 0, 0);">it;&nbsp;&nbsp;&nbsp;&nbsp;\<br><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;pInfo</span><span style="color: rgb(0, 0, 0);">-&gt;</span><span style="color: rgb(0, 0, 0);">RunTest();&nbsp;&nbsp;&nbsp;&nbsp;\<br><img src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedBlockEnd.gif" align="top">}</span></span><span style="color: rgb(0, 0, 0);">&nbsp;&nbsp;&nbsp;&nbsp;\</span></div><br><br>使用该测试框架的方法如下<br><br><div class="cnblogs_code"><!--<br><br>Code highlighting produced by Actipro CodeHighlighter (freeware)<br>http://www.CodeHighlighter.com/<br><br>--><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"><span style="color: rgb(0, 0, 0);">TEST(test1)<br><img id="Codehighlighter1_12_61_Open_Image" src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_12_61_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_12_61_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_12_61_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_12_61_Closed_Image" src="https://www.cnblogs.com/images/OutliningIndicators/ContractedBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_12_61_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_12_61_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_12_61_Open_Text').style.display='inline';" align="top"></span><span id="Codehighlighter1_12_61_Closed_Text" style="border: 1px solid rgb(128, 128, 128); background-color: rgb(255, 255, 255); display: none;"><img src="https://www.cnblogs.com/images/dot.gif"></span><span id="Codehighlighter1_12_61_Open_Text"><span style="color: rgb(0, 0, 0);">{<br><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;TEST_ASSERT(</span><span style="color: rgb(128, 0, 128);">2</span><span style="color: rgb(0, 0, 0);">==</span><span style="color: rgb(128, 0, 128);">2</span><span style="color: rgb(0, 0, 0);">);<br><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;TEST_ASSERT(</span><span style="color: rgb(128, 0, 128);">2</span><span style="color: rgb(0, 0, 0);">==</span><span style="color: rgb(128, 0, 128);">1</span><span style="color: rgb(0, 0, 0);">);<br><img src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedBlockEnd.gif" align="top">}</span></span><span style="color: rgb(0, 0, 0);"><br><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"><br><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top">TEST(test2)<br><img id="Codehighlighter1_75_124_Open_Image" src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_75_124_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_75_124_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_75_124_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_75_124_Closed_Image" src="https://www.cnblogs.com/images/OutliningIndicators/ContractedBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_75_124_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_75_124_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_75_124_Open_Text').style.display='inline';" align="top"></span><span id="Codehighlighter1_75_124_Closed_Text" style="border: 1px solid rgb(128, 128, 128); background-color: rgb(255, 255, 255); display: none;"><img src="https://www.cnblogs.com/images/dot.gif"></span><span id="Codehighlighter1_75_124_Open_Text"><span style="color: rgb(0, 0, 0);">{<br><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;TEST_ASSERT(</span><span style="color: rgb(128, 0, 128);">3</span><span style="color: rgb(0, 0, 0);">==</span><span style="color: rgb(128, 0, 128);">3</span><span style="color: rgb(0, 0, 0);">);<br><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;TEST_ASSERT(</span><span style="color: rgb(128, 0, 128);">2</span><span style="color: rgb(0, 0, 0);">==</span><span style="color: rgb(128, 0, 128);">3</span><span style="color: rgb(0, 0, 0);">);<br><img src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedBlockEnd.gif" align="top">}</span></span><span style="color: rgb(0, 0, 0);"><br><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"><br><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"><br><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"></span><span style="color: rgb(0, 0, 255);">void</span><span style="color: rgb(0, 0, 0);">&nbsp;main()<br><img id="Codehighlighter1_139_193_Open_Image" src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_139_193_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_139_193_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_139_193_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_139_193_Closed_Image" src="https://www.cnblogs.com/images/OutliningIndicators/ContractedBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_139_193_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_139_193_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_139_193_Open_Text').style.display='inline';" align="top"></span><span id="Codehighlighter1_139_193_Closed_Text" style="border: 1px solid rgb(128, 128, 128); background-color: rgb(255, 255, 255); display: none;"><img src="https://www.cnblogs.com/images/dot.gif"></span><span id="Codehighlighter1_139_193_Open_Text"><span style="color: rgb(0, 0, 0);">{<br><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;cout&nbsp;</span><span style="color: rgb(0, 0, 0);">&lt;&lt;</span><span style="color: rgb(0, 0, 0);">&nbsp;</span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(128, 0, 0);">start&nbsp;test..\n</span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(0, 0, 0);">;<br><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;RUN_ALL_TEST();<br><img src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedBlockEnd.gif" align="top">}</span></span></div><br><br>输出结果：<br><br>I:\VC2008\gtest-1.2.1&gt;mySimulate.exe<br>start test..<br>.<br>AssertFail:2==1 File:mySimulate.cpp Line:66 Function:test1<br>.<br>AssertFail:2==3 File:mySimulate.cpp Line:72 Function:test2<br><br>尚有点问题就是，现实的错误行号其实为函数第一行的行号。<br><br>