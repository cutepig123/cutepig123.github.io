<p>1. 进入\OpenCV\interfaces\swig\python目录，执行</p>
<p>python setup-for-win.py install</p>
<p>进行安装<br />
</p>
<p>2.安装成功后，会发现在Python26\Lib\site-packages下多了opencv这一目录，里面应该有这些文件</p>
<p>adaptors.py<br />
adaptors.pyc<br />
cn.bmp<br />
cn.bmp.jpg<br />
<span style="color: red;">cv.py</span><br />
cv.pyc<br />
<span style="color: red;">highgui.py</span><br />
highgui.pyc<br />
kalman.py<br />
kalman.pyc<br />
matlab_syntax.py<br />
matlab_syntax.pyc<br />
<span style="color: red;">_cv.pyd<br />
_highgui.pyd</span><br />
<span style="color: red;">__init__.py</span><br />
</p>
<p>__init__.pyc</p>
<p>&nbsp;其中最重要的是红色的文件 <br />
</p>
<p>&nbsp;</p>
<p>3.写一个测试程序</p>
<p>这个程序用来做autolighting的repeatibility测试。主要原理是：遍历目录下所有的bmp图像，对这些图像的固定一ROI内计算average和SD，并将统计结果生成html文件<br />
</p>
<div class="cnblogs_code"><!--<br />
<br />
Code highlighting produced by Actipro CodeHighlighter (freeware)<br />
http://www.CodeHighlighter.com/<br />
<br />
--><span style="color: #008080;">&nbsp;1</span><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /><span style="color: #0000ff;">import</span><span style="color: #000000;">&nbsp;copy<br />
</span><span style="color: #008080;">&nbsp;2</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /></span><span style="color: #0000ff;">import</span><span style="color: #000000;">&nbsp;os,sys<br />
</span><span style="color: #008080;">&nbsp;3</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /></span><span style="color: #0000ff;">import</span><span style="color: #000000;">&nbsp;opencv,&nbsp;highgui<br />
</span><span style="color: #008080;">&nbsp;4</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /><br />
</span><span style="color: #008080;">&nbsp;5</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /></span><span style="color: #0000ff;">class</span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;ROI:<br />
</span><span style="color: #008080;">&nbsp;6</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">def</span><span style="color: #000000;">&nbsp;</span><span style="color: #800080;">__init__</span><span style="color: #000000;">(self,&nbsp;x,y,w,h):<br />
</span><span style="color: #008080;">&nbsp;7</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.x&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;x<br />
</span><span style="color: #008080;">&nbsp;8</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.y&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;y<br />
</span><span style="color: #008080;">&nbsp;9</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.w&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;w<br />
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.h&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;h<br />
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /></span><span style="color: #0000ff;">def</span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;ComputeSDAndAvg(fileName,&nbsp;x,y,w,h):<br />
</span><span style="color: #008080;">13</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;img&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;opencv.highgui.cvLoadImage(fileName,&nbsp;0)<br />
</span><span style="color: #008080;">14</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;sumImg&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;opencv.cv.cvGetSubRect(img,&nbsp;opencv.cv.cvRect(x,y,w,h)&nbsp;)<br />
</span><span style="color: #008080;">15</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;avg&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;opencv.cv.cvAvg(sumImg)<br />
</span><span style="color: #008080;">16</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;mean&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;opencv.cv.cvScalar(0)&nbsp;<br />
</span><span style="color: #008080;">17</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;std_dev&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;opencv.cv.cvScalar(0)&nbsp;<br />
</span><span style="color: #008080;">18</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;opencv.cv.cvAvgSdv(sumImg,&nbsp;mean,&nbsp;std_dev)<br />
</span><span style="color: #008080;">19</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span><span style="color: #008080;">20</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">#</span><span style="color: #008000;">Modify&nbsp;image</span><span style="color: #008000;"><br />
</span><span style="color: #008080;">21</span><span style="color: #008000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /></span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;img&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;opencv.highgui.cvLoadImage(fileName,&nbsp;</span><span style="color: #000000;">1</span><span style="color: #000000;">)<br />
</span><span style="color: #008080;">22</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;opencv.cv.cvRectangle(img,&nbsp;opencv.cv.cvPoint(x,y),opencv.cv.cvPoint(x</span><span style="color: #000000;">+</span><span style="color: #000000;">w,y</span><span style="color: #000000;">+</span><span style="color: #000000;">h),opencv.cv.cvScalar(0,0,</span><span style="color: #000000;">255</span><span style="color: #000000;">))<br />
</span><span style="color: #008080;">23</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;fileNameOut&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;fileName&nbsp;</span><span style="color: #000000;">+</span><span style="color: #000000;">&nbsp;</span><span style="color: #800000;">'</span><span style="color: #800000;">.jpg</span><span style="color: #800000;">'</span><span style="color: #000000;"><br />
</span><span style="color: #008080;">24</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;opencv.highgui.cvSaveImage(fileNameOut,&nbsp;img)<br />
</span><span style="color: #008080;">25</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">#</span><span style="color: #008000;">return&nbsp;[fileNameOut,&nbsp;avg[0]&nbsp;]</span><span style="color: #008000;"><br />
</span><span style="color: #008080;">26</span><span style="color: #008000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /></span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">return</span><span style="color: #000000;">&nbsp;[fileNameOut,&nbsp;avg[0]&nbsp;,&nbsp;mean[0],&nbsp;std_dev[0]]&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">#</span><span style="color: #008000;">&nbsp;Note:&nbsp;avg&nbsp;==&nbsp;mean</span><span style="color: #008000;"><br />
</span><span style="color: #008080;">27</span><span style="color: #008000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /></span><span style="color: #000000;"><br />
</span><span style="color: #008080;">28</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /></span><span style="color: #0000ff;">def</span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;PrintHtml(result,fileName):<br />
</span><span style="color: #008080;">29</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;fp&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;open(fileName,&nbsp;</span><span style="color: #800000;">"</span><span style="color: #800000;">w</span><span style="color: #800000;">"</span><span style="color: #000000;">)<br />
</span><span style="color: #008080;">30</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span><span style="color: #008080;">31</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;fp.write(&nbsp;</span><span style="color: #800000;">'</span><span style="color: #800000;">&lt;font&nbsp;color=red&gt;===Image&nbsp;compare&nbsp;tool&nbsp;report===&lt;/font&gt;&lt;br&gt;\n</span><span style="color: #800000;">'</span><span style="color: #000000;">&nbsp;)<br />
</span><span style="color: #008080;">32</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">#</span><span style="color: #008000;">compute&nbsp;Min-Max&nbsp;avg</span><span style="color: #008000;"><br />
</span><span style="color: #008080;">33</span><span style="color: #008000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /></span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;a</span><span style="color: #000000;">=</span><span style="color: #000000;">copy.deepcopy(result)<br />
</span><span style="color: #008080;">34</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;a.sort(</span><span style="color: #0000ff;">lambda</span><span style="color: #000000;">&nbsp;x,y:&nbsp;int(x[</span><span style="color: #000000;">1</span><span style="color: #000000;">]</span><span style="color: #000000;">-</span><span style="color: #000000;">y[</span><span style="color: #000000;">1</span><span style="color: #000000;">]))<br />
</span><span style="color: #008080;">35</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;fp.write(&nbsp;</span><span style="color: #800000;">'</span><span style="color: #800000;">avg&nbsp;MIN&nbsp;%f&nbsp;MAX&nbsp;%f&nbsp;DIFF&nbsp;%f&nbsp;&lt;br&gt;\n</span><span style="color: #800000;">'</span><span style="color: #000000;">&nbsp;</span><span style="color: #000000;">%</span><span style="color: #000000;">(a[0][</span><span style="color: #000000;">1</span><span style="color: #000000;">],&nbsp;a[</span><span style="color: #000000;">-</span><span style="color: #000000;">1</span><span style="color: #000000;">][</span><span style="color: #000000;">1</span><span style="color: #000000;">],&nbsp;</span><span style="color: #000000;">-</span><span style="color: #000000;">a[0][</span><span style="color: #000000;">1</span><span style="color: #000000;">]&nbsp;</span><span style="color: #000000;">+</span><span style="color: #000000;">&nbsp;a[</span><span style="color: #000000;">-</span><span style="color: #000000;">1</span><span style="color: #000000;">][</span><span style="color: #000000;">1</span><span style="color: #000000;">])&nbsp;)<br />
</span><span style="color: #008080;">36</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span><span style="color: #008080;">37</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">#</span><span style="color: #008000;">print&nbsp;table</span><span style="color: #008000;"><br />
</span><span style="color: #008080;">38</span><span style="color: #008000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /></span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;fp.write(&nbsp;</span><span style="color: #800000;">'</span><span style="color: #800000;">&lt;table&nbsp;border=1&gt;\n</span><span style="color: #800000;">'</span><span style="color: #000000;">&nbsp;)<br />
</span><span style="color: #008080;">39</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;fp.write(&nbsp;</span><span style="color: #800000;">'</span><span style="color: #800000;">&lt;tr&gt;&lt;td&gt;Image&lt;/td&gt;&lt;td&gt;Avg&lt;/td&gt;&lt;td&gt;SD&lt;/td&gt;&lt;/tr&gt;\n</span><span style="color: #800000;">'</span><span style="color: #000000;">&nbsp;)<br />
</span><span style="color: #008080;">40</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">for</span><span style="color: #000000;">&nbsp;res&nbsp;</span><span style="color: #0000ff;">in</span><span style="color: #000000;">&nbsp;result:<br />
</span><span style="color: #008080;">41</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fp.write(&nbsp;</span><span style="color: #800000;">'</span><span style="color: #800000;">&lt;tr&gt;&lt;td&gt;&nbsp;&lt;img&nbsp;&nbsp;width=400&nbsp;height=400&nbsp;src=%s&nbsp;&gt;&nbsp;&lt;/td&gt;&lt;td&gt;%f,%f&lt;/td&gt;&lt;td&gt;%f&lt;/td&gt;&lt;/tr&gt;\n</span><span style="color: #800000;">'</span><span style="color: #000000;">&nbsp;</span><span style="color: #000000;">%</span><span style="color: #000000;">(res[0],&nbsp;res[</span><span style="color: #000000;">1</span><span style="color: #000000;">],&nbsp;res[</span><span style="color: #000000;">2</span><span style="color: #000000;">],&nbsp;res[</span><span style="color: #000000;">3</span><span style="color: #000000;">])&nbsp;)<br />
</span><span style="color: #008080;">42</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;fp.write(&nbsp;</span><span style="color: #800000;">'</span><span style="color: #800000;">&lt;/table&gt;\n</span><span style="color: #800000;">'</span><span style="color: #000000;">&nbsp;)<br />
</span><span style="color: #008080;">43</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;fp.close()<br />
</span><span style="color: #008080;">44</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span><span style="color: #008080;">45</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />top&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;r</span><span style="color: #800000;">'</span><span style="color: #800000;">D:\Python26\Lib\site-packages\opencv</span><span style="color: #800000;">'</span><span style="color: #000000;"><br />
</span><span style="color: #008080;">46</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />result&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;[]<br />
</span><span style="color: #008080;">47</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />xywh</span><span style="color: #000000;">=</span><span style="color: #000000;">[</span><span style="color: #000000;">1</span><span style="color: #000000;">,</span><span style="color: #000000;">1</span><span style="color: #000000;">,</span><span style="color: #000000;">10</span><span style="color: #000000;">,</span><span style="color: #000000;">10</span><span style="color: #000000;">]<br />
</span><span style="color: #008080;">48</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /></span><span style="color: #0000ff;">if</span><span style="color: #000000;">&nbsp;len(sys.argv)</span><span style="color: #000000;">==</span><span style="color: #000000;">5</span><span style="color: #000000;">:<br />
</span><span style="color: #008080;">49</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;xywh&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;[&nbsp;int(sys.argv[</span><span style="color: #000000;">1</span><span style="color: #000000;">]),&nbsp;int(sys.argv[</span><span style="color: #000000;">2</span><span style="color: #000000;">]),&nbsp;int(sys.argv[</span><span style="color: #000000;">3</span><span style="color: #000000;">]),&nbsp;int(sys.argv[</span><span style="color: #000000;">4</span><span style="color: #000000;">])]<br />
</span><span style="color: #008080;">50</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /></span><span style="color: #0000ff;">else</span><span style="color: #000000;">:<br />
</span><span style="color: #008080;">51</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">print</span><span style="color: #000000;">&nbsp;</span><span style="color: #800000;">"</span><span style="color: #800000;">Using&nbsp;default&nbsp;ROI</span><span style="color: #800000;">"</span><span style="color: #000000;"><br />
</span><span style="color: #008080;">52</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /><br />
</span><span style="color: #008080;">53</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /></span><span style="color: #0000ff;">for</span><span style="color: #000000;">&nbsp;root,&nbsp;dirs,&nbsp;files&nbsp;</span><span style="color: #0000ff;">in</span><span style="color: #000000;">&nbsp;os.walk(top,&nbsp;topdown</span><span style="color: #000000;">=</span><span style="color: #000000;">True):&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span><span style="color: #008080;">54</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /><br />
</span><span style="color: #008080;">55</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">for</span><span style="color: #000000;">&nbsp;name&nbsp;</span><span style="color: #0000ff;">in</span><span style="color: #000000;">&nbsp;files:&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span><span style="color: #008080;">56</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span style="color: #000000;">&nbsp;name.lower().endswith(</span><span style="color: #800000;">'</span><span style="color: #800000;">.bmp</span><span style="color: #800000;">'</span><span style="color: #000000;">):<br />
</span><span style="color: #008080;">57</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fullPath&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;os.path.join(root,&nbsp;name)<br />
</span><span style="color: #008080;">58</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">if</span><span style="color: #000000;">&nbsp;len(fullPath)</span><span style="color: #000000;">&gt;</span><span style="color: #000000;">20</span><span style="color: #000000;">:<br />
</span><span style="color: #008080;">59</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">print</span><span style="color: #000000;">&nbsp;fullPath[:</span><span style="color: #000000;">10</span><span style="color: #000000;">]&nbsp;</span><span style="color: #000000;">+</span><span style="color: #000000;">&nbsp;</span><span style="color: #800000;">'</span><span style="color: #800000;"><img src="http://www.cnblogs.com/Images/dot.gif" alt="" /></span><span style="color: #800000;">'</span><span style="color: #000000;">&nbsp;</span><span style="color: #000000;">+</span><span style="color: #000000;">fullPath[</span><span style="color: #000000;">-</span><span style="color: #000000;">10</span><span style="color: #000000;">:]<br />
</span><span style="color: #008080;">60</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">else</span><span style="color: #000000;">:<br />
</span><span style="color: #008080;">61</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">print</span><span style="color: #000000;">&nbsp;fullPath<br />
</span><span style="color: #008080;">62</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[fileNameOut,&nbsp;avg,&nbsp;mean,&nbsp;std_dev&nbsp;]</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;ComputeSDAndAvg(fullPath,&nbsp;xywh[0],&nbsp;xywh[</span><span style="color: #000000;">1</span><span style="color: #000000;">],&nbsp;xywh[</span><span style="color: #000000;">2</span><span style="color: #000000;">],&nbsp;xywh[</span><span style="color: #000000;">3</span><span style="color: #000000;">])<br />
</span><span style="color: #008080;">63</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result.append([fileNameOut,&nbsp;avg,&nbsp;mean,&nbsp;std_dev&nbsp;])<br />
</span><span style="color: #008080;">64</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span><span style="color: #008080;">65</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">for</span><span style="color: #000000;">&nbsp;name&nbsp;</span><span style="color: #0000ff;">in</span><span style="color: #000000;">&nbsp;dirs:&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span><span style="color: #008080;">66</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">#</span><span style="color: #008000;">os.rmdir(os.path.join(root,&nbsp;name))</span><span style="color: #008000;"><br />
</span><span style="color: #008080;">67</span><span style="color: #008000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /></span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000ff;">pass</span><span style="color: #000000;"><br />
</span><span style="color: #008080;">68</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />htmlFile&nbsp;</span><span style="color: #000000;">=</span><span style="color: #000000;">&nbsp;os.path.join(top,&nbsp;</span><span style="color: #800000;">'</span><span style="color: #800000;">result.html</span><span style="color: #800000;">'</span><span style="color: #000000;">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</span><span style="color: #008080;">69</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" /></span><span style="color: #0000ff;">print</span><span style="color: #000000;">&nbsp;htmlFile<br />
</span><span style="color: #008080;">70</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />PrintHtml(result,&nbsp;htmlFile)<br />
</span><span style="color: #008080;">71</span><span style="color: #000000;"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt="" align="top" />os.system(</span><span style="color: #800000;">'</span><span style="color: #800000;">explorer.exe&nbsp;"%s"</span><span style="color: #800000;">'</span><span style="color: #000000;">&nbsp;</span><span style="color: #000000;">%</span><span style="color: #000000;">htmlFile)</span></div>
<p>&nbsp;</p>
<p> <br />
</p>